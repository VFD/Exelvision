100 ! ********* KIM MUSICAL ***********
110 ! ******* VERSION EXL 100 *********
120 ! **** D.NIELSEN ET P.SOFRIN ******
130 CALL INIT
140 L=50
150 JEU=0
160 DIM N(?),CO*(7),NOM*(7),NT*(7),D(7)
170 FOR 1=1 TO 7
180 READ N(I)iCO$(I)iNOM$(I)
190 NEXT I
200 DATA 199,1RC,DO,176,1BC,RE,158,1bC,MI,149,1RC,FA
210 DATA 133,1RC,SOL,118,1BC,LA,105,1WC,SI
220 !PRESENTATION
230 CLS "BCC"
240 CALL COLOR("OBYLH"):LOCATE (4,8):PRINT "KKIIMM MMUUSSIICCAALL"
250 LOCATE <5,8):PRINT "KKIIMM MMUUSSIICCAALL"
260 CALL COLOR("0BC"):LOCATE <10,8):PRINT "TU VAS D'ABORD ENTENDRE LA GAMME"
270 PRINT:PRINT "ENSUITE TU ENTENDRAS UN MORCEAU DE 6":PRINT
280 PRINT "NOTES,PUIS LE MEME MORCEAU MAIS AVEC UNE":PRINT
290 PRINT "NOTE EN MOINS."
300 CALL COLOR<"ObC"):PRINT:PRINT "A TOI DE RETROUVER CETTE NOTE"
310 PRINT "ET DE TAPER SON NOM."
320 LOCATE (21,5):PRINT "... APPUIE UNE TOUCHE ..."
330 RANDOMIZE:CALL KEY1(A,B):IF B=0 THEN 330
340 CALL GAMME(CO$(),NOM$(),N())
350 CLS:PRINT "MAINTENANT,APPUIE UNE TOUCHE":PRINT "POUR COMMENCER A JOUER."
360 CALL KEY1(A,B):IF B=0 THEN 360
370 CLS:CALL PORTEE
380 C=0:M=I
390 FOR 1=1 TO 6
400 Y=INTRND(7)
410 LOCATE (17-Y,I*4+1):CALL COLOR(CO$(Y)):PRINT "A":CALL COLOR("0BC")
420 IF JEU<3 THEN LOCATE (18,I*4+1):PRINT NOM$(Y)
430 CALL PLAY(N(Y),L)
440 NT$(I)=NOM$(Y):D(I)=Y
450 NEXT I
460 PAUSE 10
470 !NOUVELLE MUSIQUE
480 F=INTRND(5)
490 CLS:LOCATE (1,1):PRINT "VOICI LA NOUVELLE MUSIQUE AVEC 5 NOTES"
500 CALL PORTEE
510 FOR I=1 TO 6
520 IF I=F THEN 560
530 LOCATE (17-D(I),I*4+1):CALL COLOR(CO$(D(I))):PRINT "A":CALL COLOR("0BC")
540 IF JEU<3 THEN LOCATE (18,I*4+1):PRINT NT$(I)
550 CALL PLAY(N(D(I)),L)
560 NEXT I
570 !REPONSE
580 LOCATE (20,1):INPUT "QUELLE EST LA NOTE EN MOINS ?";REP$
590 CALL CONVER(REP$,NO):IF NO<>0 THEN CALL PLAY(NO,L)
600 IF REP$=NT$(F)THEN 710
610 IF C=1 THEN 660
620 CALL COLOR("0BC"):LOCATE (20,1)
630 PRINT "NON,CE N'EST PAS CELA.ECOUTE UNE":PRINT "DEUXIEME FOIS."
640 PAUSE 10
650 C=1:GOTO 490
660 !AFFICHAGE BONNE REPONSE
670 LOCATE (19,i):PRINT RPT$(" ",40);"NON,C'EST ENCORE FAUX.
680 PRINT "LA BONNE REPONSE ETAIT ";:CALL COLOR("0bC"):PRINT NT$(F)
690 CALL PLAY(N(D(F)),L)
700 GOTO 740
710 !GAGNE
720 LOCATE (19,1):PRINT RPT$(" ",80>;
730 LOCATE (20,1):PRINT "C'EST EXACT."
740 PAUSE 10
750 JEU=JEU+1
760 IF JEU<3 THEN 370
770 IF JEU=5 THEN 810
780 PRINT "MAINTENANT TU VAS JOUER SANS LIRE LE NOMDES NOTES."
790 PAUSE 10
800 GOTO 370
810 CLS"CBB"
820 CALL COLOR("ORBHL"):FOR 1=6 TO 7:LOCATE (1,12)
830 PRINT "AAUU RREEVVOOIIRR":NEXT
840 END
850 !SOUS PROGRAMMES DIVERS
860 SUB INIT
870 CALL POKE(50688,165,8,6,10):CALL POKE(49156,198,0)
880 CALL CHAR(65,"01010101011F6181827C")
890 CALL CHAR(66,"00000000000000FF0000")
900 CALL POKE(50850,162,5,45,162,136,45,10):CALL EXEC(50850)
910 SUBEND
920 SUB PLAY(NOTE,DUREE)
930 CALL POKE(258,NOTE,129):PAUSE DUREE/50:CALL POKE (259,45)
940 SUBEND
950 SUB GAMME(CO$(),NOM$(),N())
960 CLS
970 CALL PORTEE
980 CALL COLOR("0BC")
990 LOCATE (20,1):PRINT "VOICI LA GAMME"
1000 FOR I=1 TO 7
1010 LOCATE (17-I,4*I+1):CALL COLOR(CO*(I)):PRINT "A":CALL COLORO'OBC")
1020 LOCATE (18,I*4+1):PRINT NOMt(I)
1030 CALL PLAY(N(I),40)
1040 NEXT I
1050 PAUSE 8
1060 SUBEND
1070 SUB PORTEE
1080 CALL COLORC'IBC")
1090 FOR 1=6 TO 14 STEP 2
1100 LOCATE <I,1):PRINT RPT*("B",40);
1110 NEXT I
1120 SUBEND
1130 SUB CON VER (NOTE*,PE RI)
1140 PERI=0:K=POS("DO.RE.MI.FA.SOLLA.SI.",SEG$(NOTE$&".",1,3),1)
1150 IF K=0 THEN PERI=0:SUBEXIT
1160 PERI=VAL(SEG$("199176158149133118105",K,3))
1170 SUBEND