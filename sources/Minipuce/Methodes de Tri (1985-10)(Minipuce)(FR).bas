10 !-------------------------------- 
20 !      METHODE DE TRI
30 !-------------------------------- 
40 ! LE SOUS-PROGRAMME A PARTIR DE
50 ! L' INSTRUCTION 3210, PERMET DE
60 ! METTRE EN ORDRE CROISSANT SOIT :
70 !
80 ! 1. DES NOMBRES ENTRES AU CLAVIER
90 !    POUR CETTE OPTION METTRE
100 !    CODE=0 SUR L.A LIGNE 1030 
110 ! 
120 ! 2. LES NOMBRES D'UNE TABLE UTILISEE 
130 !    DANS VOTRE PROGRAMME. 
140 !    POUR CETTE OPTION METTRE 
150 !    CODE=1 SUR LA LIGNE 1030 
160 !    M(X) = TABLE QUE VOUS VOULEZ 
170 !           TRIER. 
180 !    NBRE = NOMBRE DE POSTES DE LA 
190 !           TABLE M(X) . 
200 ! 
210 ! A PARTIR DE 3 METHODES DE TRIS 
220 ! DIFFENTES. LA METHODE CHOISIE EST 
230 ! PRECISEE PAR TYPE EN CAS 
240 ! D'UTILISATION PAR PROGRAMME. 
250 ! 
1000 DIM M(50)
1010 DATA -34.775,-6,8.154,13.2,13.02,27
1020 FOR X=1 TO 6:READ TsM(X)=T:NEXT X
1030 CODE=0:NBRE=6:TYPE=3
1040 CALL TRINUM(CODE,TYPE,NBRE,M())
1050 FOR X=1 TO 6:PRINT M(X):NEXT X
1060 END
3210 SUB TRINUM(CODE,TYPE,NBRE,M())
3220 Z=NBRE
3230 IF CODE=1 THEN GOTO 3600
3240 CALL HROFF
3250 CLS "bYW":CALL COLOR("0bYHL")
3260 CALL HRON("b",11,1)
3270 LOCATE (3,13):PRINT "TTRRII"
3280 LOCATE (4,13):PRINT "TTRRII"
3290 LOCATE (6,7):PRINT "NNUUMMEERR11QQUUEE"
3300 LOCATE (7,7):PRINT "NNUUMMEERR11QQUUEE"
3310 LOCATE (8,7):PRINT "******************"
3320 LOCATE (9,7):PRINT "******************"
3330 CALL COLOR("0bY")
3340 LOCATE (13,3)
3350 PRINT "CHOISISSEZ VOTRE METHODE DE TRI :"
3360 LOCATE (15,7):PRINT "1. BULLE (CLASSIQUE)"
3370 LOCATE (16,7):PRINT "2. BULLE (VARIANTE)"
3380 LOCATE (17,7):PRINT "3. SHELL-METZNER"
3390 LOCATE (21,3):INPUT "Votre choix ? ";X$
3400 IF X$<"1"OR X$>"3"THEN GOTO 3390
3410 TYPE=VAL(X$)
3420 CLS:LOCATE (13,1)
3430 INPUT "COMBIEN DE NOMBRES A CLASSER ";X$
3440 IF X$="0"OR NOT NUMERIC(X$)THEN GOTO 3420
3450 CLS:X=VAL(X$):PRINT X;"NOMBRES A CLASSER :"
3460 PRINT "       ENTREZ LES NOMBRES LES"
3470 PRINT "       UNS APRES LES AUTRES.";
3480 LOCATE (21,6):PRINT "Appuyer sur une touche "
3490 A$=KEY$
3500 CLS
3510 LOCATE (13,1)
3520 FOR I=1 TO X
3530 PRINT " NOMBRE ";I;"=";
3540 INPUT " ";W$
3550 IF NOT NUMERIC(W$)THEN GOTO 3530 ELSE M(I)=VAL(W$)
3560 NEXT I
3570 Z=I-1
3580 CLS:LOCATE (14,3)
3590 PRINT "UN INSTANT, SVP..."
3600 ON TYPE GOSUB 3630,3720,3810
3610 GOTO 3940
3620 !
3630 ! METHODE BULLE (CLASSIQUE)
3640 !
3650 FOR I=1 TO Z-l
3660 FOR J=I+1 TO Z
3670 IF M(I)>M(J)THEN TAMP=M(I):M(I)=M(J):M(J)=TAMP
3680 NEXT J
3690 NEXT I
3700 RETURN
3710 !
3720 ! METHODE BULLE (VARIANTE)
3730 !
3740 SW=0
3750 FOR I=1 TO Z-l
3760 IF M(I)>M(I+1)THEN TAMP=M(I):M(I)=M(1+1):M(I +1)=TAMP:SW=1
3770 NEXT I
3780 IF SW=1 THEN SW=0:GOTO 3750
3790 RETURN
3800 !
3810 ! METHODE SHELL-METZNER
3820 !
3830 W=Z
3840 W=INT(W/2)
3850 IF W=0 THEN RETURN
3860 L=Z-W
3870 FOR I=1 TO L
3880 N=I
3890 Y=N+W
3900 IF M (NX=M (Y) THEN GOTO 3920
3910 TAMP=M(N):M(N)=M(Y):M(Y)=TAMP:N=N-W:IF N>0 THEN GOTO 3890
3920 NEXT I
3930 GOTO 3840
3940 IF CODE=1 THEN SUBEXIT
3950 CLS
3960 LOCATE (14,3)
3970 PRINT "Appuyer pour avoir les nombres classes"
3980 PRINT "        les uns derriere les autres."
3990 A$=KEY$
4000 CLS
4010 LOCATE (14,1)
4020 FOR I=1 TO Z
4030 PRINT "   ";M(I)
4040 A$=KEY$
4050 NEXT I
4060 LOCATE (14,3)
4070 CLS:PRINT "QUE VOULEZ VOUS FAIRE ?"
4080 PRINT "    1. RELIRE"
4090 PRINT "    2. AUTRE TRI"
4100 PRINT "    3. FIN DE TRAVAIL"
4110 LOCATE (21,5)s INPUT "Votre choix ? " j Y
4120 IF Y<1 OR Y>3 THEN GOTO 4070
4130 CLS
4140 ON Y GOTO 4020,3240,4150
4150 CALL HROFF
4160 LOCATE (10,10)
4170 PRINT "AU REVOIR ..."
4180 PAUSE 2:CLS "BCC":END
4190 SUBEND
