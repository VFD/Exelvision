100 ! --------------------------------
110 !            LOTO
120 ! --------------------------------
130 CALL COLOR("0WR")
140 CLS "WRb"
150 LOCATE (3,4):PRINT "Mercredi...20H25"
160 DIM JOU(9,20)
170 LOCATE (10,16)
180 CALL COLOR("0WHLI")
190 PRINT "LLOOTTOO"
200 LOCATE (11,16)
210 PRINT "LLOOTTOO"
220 CALL COLOR("0WR")
230 LOCATE (20,2):PRINT "Appuyer sur une touche pour jouer"
240 A$=KEY$:RANDOMIZE
250 IF A$=""THEN GOTO 240
260 CLS:LOCATE (5,2):PRINT "Nombre de joueurs (1 a 9) "
270 NB$=KEY$:RANDOMIZE
280 IF NB$=""THEN GOTO 270
290 IF NB$<"0"OR NB$>"9"THEN GOTO 270
300 NB=VAL(NB$)
310 IF NB=0 THEN GOTO 270
320 CLS:CALL COLOR("0WB")
330 LOCATE (1,10):PRINT "ENTREZ VOTRE JEU "
340 CALL COLOR("0bY")
350 LOCATE (2,1):PRINT "6 chiffres de 1 a 49 "
360 LOCATE (3,1):PRINT "separes par un BLANC."
370 FOR I=1 TO NB
380 GAIN(I)=0
390 NEXT I
400 LOCATE (5,1)
410 FOR I=1 TO NB
420 CALL COLOR("0bY")
430 LOCATE ((I-1)+5,1):PRINT "J ";I;" : ";
440 CALL COLOR("0WR")
450 LOCATE ((I-1)+5,8):INPUT "  ";JEU$
460 GOSUB 510
470 IF RC<>0 THEN GOSUB 750:GOTO 460
480 NEXT I
490 GOTO 810
500 !
510 ! *** VERIFICATION ***
520 !
530 IND=1 :RC=0:JE$=""
540 FOR K=1 TO 20
550 CH$=SEG$(JEU$,K,1)
560 IF CH$<>""THEN CH=ASC(CH$) ELSE CH=32
570 IF CH<>32 THEN GOTO 590
580 IF JE$<>""THEN GOTO 610 ELSE GOTO 650
590 IF CH<48 AND CH>57 THEN RC=4:RETURN
600 JE$=JE$&CH$:GOTO 650
610 IF LEN(JE$)>2 THEN RC=8:RETURN
620 IF VAL(JE$)<1 OR VAL(JE$)>49 THEN RC=12:RETURN
630 JOU(I,IND)=VAL(JE$):JE$=""
640 IND=IND+1
650 NEXT K
660 GOSUB 680
670 RETURN
680 FOR M=1 TO 5
690 FOR N=M+1 TO 6
700 IF JOU(I,M)=JOU(I,N)THEN RC=16:RETURN
710 NEXT N
720 NEXT M
730 RETURN
740 !
750 ! *** REPETE ***
760 !
770 LOCATE (22,1):PRINT "JOUEUR ";I;"Anomalie ";"REDONNEZ":LOCATE ((I-1)+5,8)
780 INPUT " ";JEU$
790 LOCATE (22,1):PRINT "                           "
800 RETURN
810 LOCATE (21,1)
820 CALL COLOR("0bG")
830 PRINT "Amis du LOTO commen√ßons le tirage "
840 LOCATE (22,1)
850 PRINT "Appuyez sur touche ENTREE"
860 FOR L=1 TO 7
870 C$=KEY$:RANDOMIZE
880 IF C$=""THEN GOTO 870
890 IF L<>1 THEN GOTO 920
900 CALL COLOR("0RR")
910 LOCATE (22,1):PRINT "                             ":LOCATE (22,1)
920 A=INTRND(100)
930 B=INTRND(100)
940 C=INTRND(100)
950 Z=A+B+C
960 TIR=Z-(INT(Z/49)*49)
970 TIR=TIR+1
980 FOR N=1 TO L-1
990 IF TI(N)=TIR THEN GOTO 920
1000 NEXT N
1010 TI(N)=TIR
1020 IF L=7 THEN CALL COLOR("0WB") ELSE CALL COLOR("0MW")
1030 PRINT TIR;" ";
1040 NEXT L
1050 FOR I=1 TO NB
1060 BON(I)=0
1070 FOR J=1 TO 6
1080 FOR K=1 TO 6
1090 IF JOU(I,J)=TI(K)THEN BON(I)=BON(I)+1: GOTO 1110
1100 NEXT K
1110 NEXT J
1120 NEXT I
1130 CALL COLOR("0bW")
1140 FOR I=1 TO NB
1150 LOCATE ((5+(I-1)),27)
1160 PRINT BON(I)
1170 IF B0N(I)<3 THEN GOTO 1230
1180 ON (BON(I)-2)GOTO 1190,1200,1210,1220
1190 GAIN(I)=GAIN(I)+9:GOTO 1230
1200 GAIN(I)=GAIN(I)+90:GOTO 1230
1210 GAIN(I)=GAIN(I)+9000:GOSUB 1340:GOTO 1230
1220 GAIN(I)=GAIN(I)+4.E+06:GOTO 1230
1230 GN$=STR$(GAIN(I))
1240 LOCATE ((5+(I-1)),(29+(9-LEN(GN$))))
1250 PRINT GAIN(I)
1260 NEXT I
1270 LOCATE (18,20): PRINT "On continue ? (O/N)"
1280 I$=KEY$:RANDOMI ZE
1290 IF I$=""THEN GOTO 1280
1300 IF SEG$(I$,1,1)="O"THEN GOTO 1310 ELSE CLS "BCC": END
1310 CALL COLOR("0RR")
1320 LOCATE (18,20): PRINT "                  "
1330 GOTO 320
1340 FOR M=1 TO 6
1350 IF JOU(I,M)=TI(7)THEN GAIN(I)=GAIN(I)+30000
1360 NEXT M
1370 RETURN






