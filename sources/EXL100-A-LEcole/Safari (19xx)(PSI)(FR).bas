100 !*********** SAFARI **************
110 !******* VERSION EXL 100 *********
120 !**** D.NIELSEN - 1985 ***********
130 CALL INIT:CLS "BCC":CALL COLOR("0bHL")
140 LOCATE (6,14):PRINT "SSAAFFAARRII":LOCATE (7,14):PRINT "SSAAFFAARRII"
150 CALL COLOR ("0BC")
160 LOCATE (10,6):PRINT "COURSE DE VITESSE AVEC UN LION":PRINT:PRINT
170 PRINT "seule ta rapidite a trouver les reponses"
180 PRINT "aux operations proposees peut te sauver."
190 PRINT
200 CALL COLOR ("0GB"):LOCATE (22,5):PRINT "Appuie une touche pour continuer"
210 CALL KEY1(A,B):IF A=0 OR B<>1 THEN 210
220 CLS
230 P=19:H=1
240 CALL COLOR ("1RC"):GOSUB 970
250 CALL COLOR ("0BC"):PRINT "Tu es sorti de ta voiture pour"
260 PRINT "photographier un lion endormi.":PRINT "Il vient de se reveiller."
270 PRINT "Tu vas devoir repondre aux","operations proposees."
280 PRINT "Si tu reponds bien,tu avances","vers ta voiture."
290 PRINT "Si tu te trompes,le lion","vient vers toi pour te manger."
300 CALL COLOR ("0RB"):LOCATE (18,15):PRINT "ATTENTION:"
310 PRINT "A chaque operation,le temps de reponse":LOCATE (20:15)
320 PRINT "diminue."
330 CALL COLOR ("0BW"):PRINT:PRINT "APPUIE UNE TOUCHE POUR COMMENCER";
340 CALL KEY1(A,B):IF A=0 OR B<>1 THEN 340
350 CALL COLOR ("0BC"):CLS "BCC"
360 !***** JEU ******
370 LOCATE (5,1):PRINT "NIVEAU DE JEU"
380 PRINT:PRINT " TRES FACILE ..... 1"
390 PRINT:PRINT "      FACILE ..... 2"
400 PRINT:PRINT " PLUS DIFFICILE .. 3"
410 PRINT
420 PRINT "Ton choix .......";:ACCEPT VALIDATE ("123")SIZE(1)NULL(1),CH
430 PRINT
440 PRINT "Quel est ton prenom ?";
450 ACCEPT VALIDATE(ALPHA)SIZE(15),N$
460 T=LEN(N$):FOR I=1 TO T
470 RANDOMIZE:NEXT I
480 S=38
490 V=0
500 CALL COLOR ("1RC"):CLS:GOSUB 1120
510 GOSUB 1390
520 IF M=P-2 THEN GOSUB 1300
530 IF P=37 THEN GOSUB 1180
540 V=V+t
550 CALL COLOR("0")
560 ON CH GOTO 570,600,630
570 A=INT(9*RND)
580 B=INTRND(9-A)
590 GOTO 660
600 A=INT(19*RND)
610 B=INTRND(19-A)
620 GOTO 660
630 A=INT(39*RND)
640 B=INTRND(39-A)
650 GOTO 660
660 CALL COLOR("0RLH"):LOCATE (20,5):CALL DBL(A,Z$):PRINT Z$;"++";
670 CALL DBL(B,Z$):PRINT Z$;"==";
680 LOCATE (21,5):CALL DBL(A,Z$):PRINT Z$;"++";
690 CALL DBL(B,Z$):PRINT Z$;"==";
700 GOTO 1430
710 CALL COLOR("ORLH"):LOCATE (20,20):CALL DBL(REP,Z$):PRINT Z$
720 LOCATE (21,20):PRINT Z$
730 LOCATE (20,25):PRINT "FFAAUUXX  !!"
740 LOCATE (21,25):PRINT "FFAAUUXX  !!"
750 CALL COLOR("ORBF"):LOCATE (22,20):PRINT "ATTENTION AU LION !";
760 CALL COLOR("ObC")
770 M=M+2
780 IF M>10 THEN 850
790 FOR I=1 TO 5
800 CALL PLAY("SILASOFAMIREDOLAMIDOLA",.4,5-I)
810 NEXT
820 CALL PLAY("LA",10,3)
830 PAUSE 5
840 GOTO 500
850 FOR I=1 TO 10
860 CALL PLAY("SOSODO",5,I):NEXT I
880 GOTO 500
890 CALL COLOR("0bLH"):LOCATE (20,20):CALL DBL(REP,Z$):PRINT Z$
900 LOCATE (21,20):PRINT 2$
910 LOCATE (20,25):PRINT "OOUUFF  !!"
920 LOCATE (21,25):PRINT "OOUUFF  !!"
930 P=P+2:S=S-2
940 CALL PLAY("SILASOFAMIREDOLAMIDOLA",5,2)
950 PAUSE 5
960 GOTO 500
970 RESTORE 970:FOR I=33 TO 43:READ A$:CALL CHAR(I,A$):NEXT
980 DATA 0000000003070F1F1F1F,00000000000000000000,000000C0E0F0F8FCFEFF
990 DATA 070F1F3F6FCF8F8F8783,FFFFFFFFFFFFFFFBF8F0,FFFFFFFFFFFFFF070703
1000 DATA FFFEFCE0F0FCFEE0E0C0,01010100000000000000,E0E0E0C0C0C000000000
1010 DATA 03030301010100000000,C0C0C080808000000000
1020 FOR I=44 TO 47:READ A$:CALL CHAR(I,A$):NEXT
1030 FOR I=58 TO 61:READ A$:CALL CHAR(I,A$):NEXT
1040 DATA 0000000000000000FFFF,000003060C183060E0FF,0000FF381010101010FF
1050 DATA 0000F4606060607C7EFF,FFFFFFFF1F0703010000,FFFFFFFFF0E0C0800000
1060 DATA FFFFFFFF1F0703010000,FFFFFFFFF0E0C0800000
1070 FOR I=62 TO 63:READ A$:CALL CHAR(I,A$):NEXT:FOR I=91 TO 95:READ A$
1080 CALL CHAR(1,A$):NEXT
1090 DATA 00000103070F0703017F,000080C0E0F0E0C080FE,7F676767670707070C0C
1100 DATA 00000000000000000000
1110 DATA FEE6E6E6E6E0E0E03030,0C0C0C0C7C7C00000000,303030303E3E00000000
1120 LOCATE (5,M):PRINT "  !#":LOCATE (6,M):PRINT "$%&'":LOCATE (7,M)
1130 PRINT "()*+"
1140 LOCATE (6,35):PRINT ",-./":LOCATE (7,35):PRINT ":;<="
1150 IF P=38 OR M=P-2 THEN RETURN
1160 LOCATE (5,P):PRINT ">?":LOCATE (6,P):PRINT ""ยง":LOCATE (7,P):PRINT "^_"
1170 RETURN
1180 !GAGNE
1190 FOR I=10 TO 21:LOCATE (I,1):PRINT RPT$(" ",40);:NEXT
1200 CALL COLOR ("0RLH"):LOCATE (15,1):FOR I=1 TO LEN(N$)
1210 PRINT RPT$(SEG$(N$,I,1),2);:NEXT
1220 LOCATE (16,1):FOR I=1 TO LEN(N$)
1230 PRINT RPT$(SEG$(N$,I,1),2);:NEXT
1240 LOCATE (17,7):PRINT "CC''  eesstt  ggaaggnnee  !!"
1250 LOCATE (18,7):PRINT "CC''  eesstt  ggaaggnnee  !!"
1260 CALL COLOR ("0R"):LOCATE (20,11)
1270 PRINT "En";V;"operations."
1280 GOSUB 1580:CALL HROFF:END
1290 PAUSE 5
1300 !PERDU
1310 FOR I=10 TO 21:LOCATE (1,1):PRINT RPT$(" ",40);:NEXT
1320 CALL COLOR ("0RLH"):FOR K=15 TO 16:LOCATE (K,5):FOR I=1 TO LEN(N$)
1330 PRINT RPT$(SEG$(N$,I,1),2);:NEXT:NEXT
1331 LOCATE (18,5):PRINT "AAuu  rreevvooiirr"
1335 LOCATE (19,5):PRINT "AAuu  rreevvooiirr  "
1340 CALL COLOR ("0B"):PRINT:PRINT
1350 PRINT "Tu as perdu,le lion t'a mange(e)"
1360 CALL PLAY("FAMIFAMIFAREMIDOREREFAFASOFAMIREDOMIFAMIRERERERE",3,1)
1370 GOSUB 1580:CALL HROFF:END
1380 PAUSE 5
1390 !CHRONO
1400 LOCATE (15,1):PRINT CHR$(9);RPT$(CHR$(4),S);CHR$(6)
1410 PRINT CHR$(3);:LOCATE (16,S+2):PRINT CHR$(3)
1420 PRINT CHR$(8);RPT$(CHR$(4),S);CHR$(7):RETURN
1430 !JEU
1440 R=A+B:CALL COLOR ("OI")
1450 LOCATE (16,2):FOR I=1 TO S
1460 PRINT " ";
1470 CALL KEY1(Z,Y):IF Y<>0 AND (Z>47 AND Z<58) THEN REP$=CHR$(Z):GOTO 1510
1480 CALL PLAY("DODODO",2,1)
1490 NEXT I
1500 GOTO 750
1510 IF R>9 THEN 1530
1520 REP=VAL(REP$):IF REP=R THEN 890 ELSE 710
1530 DZ=VAL(REP$)
1540 RP$=KEY$:IF RP$<"0" OR RP$>"9" THEN 1540
1550 UNIT=VAL(RP$)
1560 REP=DZ*10+UNIT
1570 IF REP=R THEN 890 ELSE 710
1580 END
1600 SUB INIT
1610 CALL POKE(50850,162,5,45,162,136,45,10):CALL EXEC(50850)
1620 CALL POKE(50688,165,8,6,10):CALL POKE(49156,198,0)
1630 SUBEND
1640 SUB PLAY(NO$,L,D)
1650 FOR I=1 TO LEN(NO$) STEP 2
1660 K=POS("DO.RE.MI.FA.SO.LA.SI.",SEG$(NO$,I,2),1)
1670 P=VAL(SEG$("199176158149133118105",K,3))
1680 CALL POKE(258,P,D+128):PAUSE L/50
1690 NEXT:CALL POKE(259,0):SUBEND
1700 SUB DBL(A,Z$)
1710 K$=STR$(A):Z$=""
1720 FOR I=1 TO LEN(K$)
1730 Z$=Z$&RPT$(SEG$(K$,I,1),2)
1740 NEXT I
1750 SUBEND
