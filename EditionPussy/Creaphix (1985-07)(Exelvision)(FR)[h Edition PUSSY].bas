1 !     C.A.  EXELVISION  7/85
2 !            CREAPHIX
3 E$=CHR$(17):EE$=CHR$(16):A$=CHR$(2)
4 GRAD:CALL HROFF:CLS "MBb":CALL COLOR("0WBHLF")
5 CALL POKE(50420,162,5,45,162,136,45,10):CALL EXEC(50420)
6 N$="CCRREEAAPPHHIIXX":LOCATE (9,13):PRINT N$:LOCATE (10,13):PRINT N$
7 N$="DESSIN ASSISTE PAR EXL 100"
8 CALL COLOR("0WH"):LOCATE (13,8):PRINT N$:LOCATE (14,8):PRINT N$
9 CALL COLOR("0Y"):LOCATE (17,10):PRINT "BACKUP BY PUSSY  1990"
10 ON BREAK ERROR:ON ERROR 157
11 D$(0)="B":D$(1)="R":D$(2)="G":D$(3)="Y":D$(4)="
12 D$(7)="W":X=150:Y=100:C$="B":E=1:S=-1:K$(1)="I":F=0
13 H$(1)=" 1:NOIR":H$(2)="2:ROUGE ":H$(3)=" 3:VERT":H$(4)="4:JAUNE "
14 H$(5)=" 5:BLEU":H$(6)="6:MAGENTA":H$(7)=" 7:CYAN":H$(8)="8:BLANC"
15 L$(1)="9:CARRE":L$(2)="0:CERCLE":L$(3)="#:TRIANG.":L$(4)="*:PLEIN"
16 EFFAC$=RPT$(" ",75)
17 CALL COLOR("0GB"):LOCATE (21,4):PRINT "Voulez vous lire le mode d'emploi 
?"
18 PRINT:PRINT,"(1):OUI","(2):NON":PAUSE .5
19 CALL KEY1(O,P):IF O=255 THEN 19 ELSE IF O=50 THEN 60
20 CALL COLOR("0GB"):PRINT EFFAC$
21 PRINT "Vous choisissez,dans le MENU,les figures"
22 PRINT " qui vous conviennent dans la couleur de votre choix.":PRINT
23 PRINT " * pour d"&E$&"placer le CURSEUR                ou tracer des 
LIGNES:"
24 PRINT:PRINT " Il faut agir sur les touches fl"&E$&"ch"&E$&"es,"
25 PRINT " les coordonn"&E$&"es du point s'affichent"
26 PRINT " automatiquement:X=  Y= ."
27 PRINT:PRINT " * pour tracer un QUADRILATERE:"
28 PRINT:PRINT " Il faut valider un sommet "&A$&" l'aide de "
29 PRINT " la touche : 9 ,puis valider le s
30 PRINT " oppos"&E$&" a l'aide de la barre d'espace."
31 PRINT:PRINT:PRINT:GOSUB 71
32 PRINT EFFAC$:CALL COLOR("0GB"):PRINT:PRINT " * pour tracer un CERCLE:"
33 PRINT:PRINT " Il faut valider le centre "&A$&" l'aide de"
34 PRINT " la touche: 0 ,puis valider un point"
35 PRINT " de la circonf"&E$&"rence "&A$&" l'aide de la      barre 
d'espace."
36 PRINT:PRINT " * pour tracer un TRIANGLE:"
37 PRINT:PRINT " Il faut valider un sommet "&A$&" l'aide"
38 PRINT " de la touche : # ,puis valider les"
39 PRINT " 2 autres sommets "&A$&" l'aide de la barre   d'espace."
40 PRINT:PRINT " * pour REMPLIR une figure:"
41 PRINT:PRINT " Il faut taper la touche : * ,avant de"
42 PRINT " valider le dernier point.Un autre appui"
43 PRINT " annulera l'option."
44 GOSUB 71:CALL COLOR("0GB"):PRINT EFFAC$
45 PRINT " Vous pouvez sauvegarder ou charger un   "&E$&"cran";
46 PRINT " d'une cassette, dans ce cas,"
47 PRINT:PRINT " *Pour SAUVEGARDER un "&E$&"cran:"
48 PRINT " Appuyez sur la touche (S)."
49 PRINT:PRINT " *Pour RECHARGER cet "&E$&"cran dans l'EXEL:"
50 PRINT " Appuyez sur la touche (L)."
51 PRINT:PRINT " Si vous poss"&E$&"dez une imprimante"
52 PRINT " EXL 80, vous pouvez IMPRIMER votre"
53 PRINT " dessin suivant 2 options:"
54 PRINT "  en taille normale":PRINT "  ou en double taille"
55 PRINT " Pour cela appuyez sur la touche (C)."
56 PRINT:PRINT " Dans ce cas,il vous faudra charger un"
57 PRINT " fichier de la bande magn"&E$&"tique"
58 PRINT " qui suit le programme principal."
59 PRINT:GOSUB 71
60 CLS:PRINT "Voulez vous faire de la copie d'"&E$&"cran ?"
61 PRINT EFFAC$:PRINT " Si c'est le cas:"
62 PRINT " -Appuyez sur la touche (ESC),"
63 PRINT "  et appuyez sur la touche lecture de"
64 PRINT "  votre magn"&E$&"tophone."
65 PRINT:PRINT " -Dans le cas contraire appuyez sur"
66 PRINT "  une touche autre que (ESC).":PRINT RPT$(" ",250):PAUSE .5
67 CALL KEY1(O,P):IF O=255 THEN 67
68 IF O<>27 THEN 74 ELSE CALL POKE(49189,72,82,67,79)
69 CALL COLOR("0W"):LOCATE (22,10):PRINT "CHARGEMENT EN COURS"
70 CALL POKE(50430,114,3,32,6,241,5,10):CALL EXEC(50430):GOTO 74
71 CALL COLOR("0RF"):LOCATE (1,2):PRINT "POUR CONTINUER APPUYEZ SUR UNE 
TOUCHE"
72 PAUSE .5:CALL COLOR("0GB")
73 CALL KEY1(O,P):IF O=255 THEN 73 ELSE LOCATE (22,1):RETURN
74 CLS "GBB":CALL COLOR("0G"):LOCATE (20,1):FOR I=1 TO 8:PRINT H$(I),:NEXT
75 LOCATE (9,4):PRINT "Choisissez la couleur du fond "
76 PRINT TAB(4);A$&" l'aide des codes ci-dessous":PAUSE .5
77 CALL KEY1(O,P):IF O=255 THEN 77
78 IF NUMERIC(CHR$(O))THEN D=VAL(CHR$(O)) ELSE 74
79 CLS:CALL COLOR("0MBL"):CALL HRON(D$(D-1),2,17)
80 LOCATE (1,12):PRINT "CCRREEAAPPHHIIXX"
81 LOCATE (20,1):FOR I=1 TO 8:CALL COLOR("0G"&K$(I)):PRINT H$(I),:NEXT
82 LOCATE (22,1):FOR I=1 TO 4:CALL COLOR("0C"&M$(I)):PRINT L$(I),:NEXT
83 CALL COLOR("0W")
84 CALL PLOT("W",X,Y):CALL PLOT("B",X,Y):CALL PLOT(C$,X,Y)
85 LOCATE (19,1):PRINT "X=";X," Y=";Y,"X1=";X1," Y1=";Y1
86 CALL KEY1(A,B):IF A=255 THEN 84
87 IF A=67 THEN 140 ELSE IF A=83 THEN 146 ELSE IF A=76 THEN 152
88 IF A>127 AND A<132 THEN A=A-127:ON A GOSUB 10
89 IF A<58 THEN 92
90 A=-1*(A=79)-2*(A=72)-3*(A=60)-4*(A=69 OR A=84):IF A<1 OR A>4 THEN 84
91 ON A GOSUB 107,108,109,110:GOTO 84
92 IF A<57 AND A>48 THEN 102
93 IF A=57 THEN E=3:S=-1:F=0:X1=X:Y1=Y:GOTO 99
94 IF A=48 THEN E=5:S=-1:F=0:X1=X:Y1=Y:GOTO 99
95 IF A=35 THEN E=7:S=-1:F=1:X1=X:Y1=Y:GOTO 99
96 IF A=42 THEN S=-1*S:E=E+S:GOTO 99
97 IF A=32 AND F=1 THEN F=0:X2=X:Y2=Y:PAUSE .5:GOTO 84
98 IF A=32 AND F=0 THEN ON E GOTO 84,84,121,131,111,124,134,136
99 FOR I=1 TO 4:M$(I)="":NEXT
100 Q=INT((E-1)/2):M$(Q)="I":IF E=(2*Q)+1 THEN 82 ELSE M$(4)="I":GOTO 82
101 GOTO 84
102 A=A-49:C$=D$(A):FOR I=1 TO 8:K$(I)="":NEXT:K$(1+A)="I":GOTO 81
103 Y=Y-1:IF Y>-1 THEN RETURN ELSE Y=0:RETURN
104 X=X+1:IF X<320 THEN RETURN ELSE X=319:RETURN
105 Y=Y+1:IF Y<170 THEN RETURN ELSE Y=169:RETURN
106 X=X-1:IF X>-1 THEN RETURN ELSE X=0:RETURN
107 GOSUB 103:GOSUB 104:RETURN
108 GOSUB 105:GOSUB 104:RETURN
109 GOSUB 105:GOSUB 106:RETURN
110 GOSUB 103:GOSUB 106:RETURN
111 R=SQR((X-X1)*(X-X1)+(Y-Y1)*(Y-Y1)):X=X1+R:Y=Y1:X
112 IF X2>319 THEN X2=319 ELSE IF X2<0 THEN X2=0
113 IF Y2>169 THEN Y2=169 ELSE IF Y2<0 THEN Y2=0
114 FOR I=10 TO 200 STEP 10:U=R*COS(I):V=R*SIN(I):U1=X1+U:V1=Y1+V:V2=Y1-V
115 IF X>319 THEN X=319 ELSE IF X<0 THEN X=0
116 IF Y>169 THEN Y=169 ELSE IF Y<0 THEN Y=0
117 IF U1>319 THEN U1=319 ELSE IF U1<0 THEN U1=0
118 IF V1>169 THEN V1=169 ELSE IF V2<0 THEN V2=0
119 CALL LINE(C$,X,Y,U1,V1):CALL 
LINE(C$,X2,Y2,U1,V2):X2=U1:Y2=V2:X=X2:Y=V1:NEXT
120 E=1:X=INT(X):Y=INT(Y):M$(2)="":GOTO 82
121 CALL LINE(C$,X,Y,X1,Y):CALL LINE(C$,X1,Y,X1,Y1):CALL LINE(C$,X1,Y1,X,Y1)
122 CALL LINE(C$,X,Y1,X,Y)
123 E=1:M$(1)="":GOTO 82
124 R=SQR((X-X1)*(X-X1)+(Y-Y1)*(Y-Y1))
125 FOR I=0 TO 200:U=X1+R*COS(I):V=R*SIN(I):V1=Y1+V:V2=Y1-V
126 IF U<0 THEN U=0 ELSE IF U>319 THEN U=319
127 IF V1>169 THEN V1=169 ELSE IF V2<0 THEN V2=0
128 !
129 CALL LINE(C$,U,V1,U,V2):NEXT
130 E=1:S=-1:M$(2)="":M$(4)="":GOTO 82
131 IF X1>X THEN X4=X1:X3=X ELSE X4=X:X3=X1
132 FOR I=X3 TO X4:CALL LINE(C$,I,Y1,I,Y):NEXT
133 E=1:S=-1:M$(1)="":M$(4)
133 E=1:S=-1:M$(1)="":M$(4)
135 E=1:M$(3)="":GOTO 82
136 DI=SQR((Y2-Y1)*(Y2-Y1)+(X2-X1)*(X2-X1)):IF DI=0 THEN 139
137 U=(X1-X2)/DI:V=(Y1-Y2)/DI
138 FOR I=0 TO DI STEP .2:O=X2+I*U:P=Y2+I*V:CALL LINE(C$,X,Y,O,P):NEXT
139 E=1:F=1:S=-1:M$(3)="":M$(4)="":GOTO 82
140 CLS:LOCATE (21,11):PRINT "TAILLE D'IMPRESSION"
141 LOCATE (22,8):PRINT "(1):SIMPLE ou (2):DOUBLE":PAUSE .5
142 CALL KEY1(O,P):IF O<49 OR O>50 THEN 142 ELSE O=O-48
143 CLS:LOCATE (22,10):PRINT "IMPRESSION EN COURS"
144 CO=2^(D-1):CALL POKE(51198,O,CO)
145 CALL EXEC(50453):GOTO 81
146 CALL 
POKE(50385,138,194,170,182,138,194,169,152,1,28,138,194,172,182,138)
147 CALL 
POKE(50400,194,171,90,3,43,0,152,1,30,114,4,32,114,120,31,6,241,5,10)
148 CLS:LOCATE (22,2):PRINT "MAGNETOPHONE EN ECRITURE?,TAPEZ (ECS)"
149 CALL KEY1(O,P):IF O<>27 THEN 149
150 LOCATE (22,11):CLS:PRINT "SAUVEGARDE EN COURS"
151 CALL EXEC(50385):GOTO 81
152 CALL POKE(50385,114,120,31,114,15,32,6,241,5,10)
153 LOCATE (22,2):CLS:PRINT "MAGNOTOPHONE EN LECTURE?,TAPEZ (ESC)"
154 CALL KEY1(O,P):IF O<>27 THEN 154
155 LOCATE (22,13):CLS:PRINT "LECTURE EN COURS"
156 CALL EXEC(50385):GOTO 81
157 CLS "GBB":CALL COLOR("0G"):END
