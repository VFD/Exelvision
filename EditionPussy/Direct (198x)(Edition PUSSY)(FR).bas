10 !------------------------------------
20 !              DIRECT                   !     (Utilitaire pour EXL1OO)
30 !------------------------------------
40 ON BREAK NEXT
50 CALL CHAR(1,"FFFFFFFFFFFFFFFFFFFF")
60 CALL CHAR(2,"00000000000000000000")
70 EF1$="                    "
80 E$=CHR$(17):F$=CHR$(16):C$=CHR$(12)
90 CLS "WRB":CALL HRON("B",4,10)
100 CALL COLOR("0BW")
110 LOCATE (2,36):PRINT " ESC "
115 CALL COLOR("0BY")
120 LOCATE (3,36):PRINT "  ";CHR$(14);"  "
130 LOCATE (1,36):PRINT "  ^  "
140 CALL COLOR("0BR")
150 LOCATE (1,24):PRINT "Pour retour:"
160 LOCATE (3,25):PRINT "Pour suite:"
170 LOCATE (2,22):PRINT "Pour sommaire:"
180 LOCATE (15,21):PRINT "(Utilitaire)":FOR I=1 TO 3
190 LOCATE (I,1):PRINT RPT$(C$,21)
200 NEXT I
205 CALL COLOR("0WRHL")
210 LOCATE (14,9):PRINT "DDiirreecctt"
220 LOCATE (15,9):PRINT "DDiirreecctt"
230 CALL KEY1(A,B):IF A=255 THEN 230
240 IF A=128 THEN GOTO 205
250 IF A=130 OR A=27 THEN GOTO 270
260 GOTO 230
270 CLS:CALL COLOR("0BRL")
280 LOCATE (2,3):PRINT "SSOOMMMMAAIIRREE"
290 CALL COLOR("0BR"):LOCATE (14,1)
300 PRINT " _1 Pr"&E$&"sentation."
310 PRINT " _2 Sommaire."
320 PRINT " _3 Calculette."
330 PRINT " _4 Plan."
340 PRINT " _5 Sons."
350 PRINT " _6 KEY1(A,B)."
360 PRINT " _7 Line."
370 PRINT " _8 Dessin."
380 PRINT " _9 Fin."
390 LOCATE (18,20):PRINT "============="
400 LOCATE (17,20):PRINT "Page d"&E$&"sir"&E$&"e:";
410 ACCEPT VALIDATE("123456789")SIZE(1),PAGE
420 CLS:ON PAGE GOTO 205,270,430,660,860,1000,1150,1460,2180
430 CALL COLOR("0BR"):LOCATE (14,1)
440 PRINT "C=COS  S=SIN  T=TAN  A=ATN  ^,+,*,/,-"
450 PRINT "_____  _____  _____  _____  _ _ _ _ _"
452 CALL COLOR("0BRL"):LOCATE (2,3)
455 PRINT "  CCAALLCCUULLEE"
458 CALL COLOR("0BR")
460 LOCATE (17,3):PRINT "_:";
470 ACCEPT VALIDATE("1234567890.")SIZE(9),A
480 ACCEPT VALIDATE("*+-_/^ATSC")SIZE(1),C$
490 ACCEPT VALIDATE("1234567890.")SIZE(9),B
500 IF C$="*"THEN PRINT A;C$;B;"=";A*B;"                                  "
510 IF C$="-"OR C$="_"THEN PRINT A;C$;B;"=";A-B;"                              "
520 IF C$="+"THEN PRINT A;C$;B;"=";A+B;"                                      "
530 IF C$="/"THEN PRINT A;C$;B;"=";A/B;"                                      "
540 IF C$="^"THEN PRINT A;C$;B;"=";A^B;"                                      "
550 IF C$="A"THEN PRINT A;C$;"=";ATN(A);"                                      "
560 IF C$="C"THEN PRINT A;C$;"=";COS(A);"                                      "
570 IF C$="S"THEN PRINT A;C$;"=";SIN(A);"                                      "
580 IF C$="T"THEN PRINT A;C$;"=";TAN(A);"                                      "
590 LOCATE (17,25):PRINT "ENCORE:"
600 NO$=KEY$:IF NO$="O"THEN GOTO 460
610 CALL KEY1(A,B):IF A=255 THEN 610
620 IF A=27 THEN GOTO 270
630 IF A=128 THEN GOTO 270
640 IF A=130 THEN GOTO 660
650 GOTO 610
660 CLS:CALL COLOR("0BRL")
670 LOCATE (2,3):PRINT "    PPLLAANN    "
680 CALL COLOR("0BR"):X=160:Y=11:U$="W"
690 LOCATE (14,4):PRINT "X=";X
700 LOCATE (14,30):PRINT "Y=";Y
705 LOCATE (16,1):PRINT "FIN=TAB        COULEUR:ESPACE/ENTREE"
710 CALL PLOT("W",X,Y):CALL PLOT(U$,X,Y)
720 CALL KEY1(A,B)
730 IF A=9 THEN GOTO 810
740 IF A=32 THEN U$="W"
750 IF A=13 THEN U$="B"
752 IF A=69 THEN X=X-1:Y=Y-1
754 IF A=60 THEN X=X-1:Y=Y+1
756 IF A=72 THEN X=X+1:Y=Y+1
758 IF A=79 THEN X=X+1:Y=Y-1
760 IF A=129 THEN X=X+1
770 IF A=131 THEN X=X-1
780 IF A=130 THEN Y=Y+1
790 IF A=128 THEN Y=Y-1
792 LOCATE (14,6):PRINT X
794 IF X<0 THEN X=0
795 IF Y>99 THEN Y=99
796 LOCATE (14,32):PRINT Y
798 IF X>319 THEN X=319
799 IF Y<0 THEN Y=0
800 GOTO 710
810 LOCATE (22,10):PRINT "EFFACEMENT SVP"
812 FOR I=1 TO 320:CALL LINE("B",I-1,0,I-1,99):NEXT I
815 LOCATE (22,10):PRINT "                 "
819 CALL KEY1(A,B):IF A=255 THEN 819
820 IF A=27 THEN GOTO 270
830 IF A=128 THEN CLS:GOTO 430
840 IF A=130 THEN GOTO 860
850 GOTO 810
860 CLS:CALL COLOR("0BRL")
870 LOCATE (2,3):PRINT "    SSOONNSS    "
880 CALL COLOR("0BR")
890 LOCATE (14,5):PRINT "Entrez les param"&F$&"tres:"
900 LOCATE (17,1):PRINT "CALL SPEECH("" ,                                   "")"
910 LOCATE (17,14):ACCEPT BEEP VALIDATE("LRA")SIZE(1);X$
915 IF X$=""THEN GOTO 910
920 LOCATE (17,16):ACCEPT BEEP VALIDATE("1234567890ABCDEF")SIZE(35);SN$
930 SON$=RPT$(SN$,5):CALL SPEECH(X$&","&SON$)
940 LOCATE (22,10):PRINT "ENCORE:"
950 PAUSE$=KEY$:CALL SPEECH("A,"):IF PAUSE$="O"THEN GOTO 900
960 CALL KEY1(A,B):IF A=255 THEN 960
970 IF A=130 THEN GOTO 1000
980 IF A=128 THEN GOTO 660
990 IF A=27 THEN GOTO 270
995 GOTO 960
1000 CLS:CALL COLOR("0BRL")
1010 LOCATE (2,3):PRINT "    KKEEYY$$    ":CALL COLOR("0BR")
1020 LOCATE (14,3):PRINT "_Pour finir tapez F comme fin."
1030 LOCATE (16,1):PRINT " KEY1:               KEY2:              "
1040 CALL KEY1(K1,KE2)
1050 IF K1=70 THEN GOTO 1100
1060 LOCATE (18,1):PRINT K1,KE1
1070 CALL KEY2(K2,KE2)
1080 LOCATE (18,22):PRINT K2,KE2
1090 GOTO 1040
1100 CALL KEY1(A,B):IF A=255 THEN 1100
1110 IF A=27 THEN GOTO 270
1120 IF A=128 THEN GOTO 860
1130 IF A=130 THEN GOTO 1150
1140 GOTO 1100
1150 CLS:CALL COLOR("0BRL")
1160 LOCATE (2,3):PRINT "LLIINNEEPPLLOOTT":CALL COLOR("0BR")
1170 LOCATE (14,3):PRINT "_Entrez vos donn"&CHR$(17)&"e:"
1180 LOCATE (16,10):PRINT "CALL LINE OU CALL PLOT(*/#):"
1190 PAUSE$=KEY$:IF PAUSE$="#"THEN GOTO 1330
1200 LOCATE (16,10):PRINT "CALL LINE("" "",   ,   ,   ,   )"
1210 LOCATE (16,21):ACCEPT BEEP VALIDATE("WBYbCGMR")SIZE(1);CC$
1215 IF CC$=""THEN GOTO 1210
1220 LOCATE (16,24):ACCEPT BEEP VALIDATE(DIGIT)SIZE(3);C1
1225 IF C1>319 OR C1<0 THEN GOTO 1220
1230 LOCATE (16,28):ACCEPT BEEP VALIDATE(DIGIT)SIZE(3);C2
1240 IF C2>99 OR C2<0 THEN GOTO 1230
1250 LOCATE (16,32):ACCEPT BEEP VALIDATE(DIGIT)SIZE(3);C3
1260 IF C3>319 OR C3<0 THEN GOTO 1250
1270 LOCATE (16,36):ACCEPT BEEP VALIDATE(DIGIT)SIZE(3);C4
1280 IF C4>99 OR C4<0 THEN GOTO 1270
1290 CALL LINE(CC$,C1,C2,C3,C4)
1300 LOCATE (18,10):PRINT "ENCORE:"
1310 PAUSE$=KEY$:CALL LINE("B",C1,C2,C3,C4):IF PAUSE$="O"THEN CLS:GOTO 1180
1320 GOTO 1410
1330 LOCATE (16,10):PRINT "CALL PLOT("" "",   ,   )       "
1340 LOCATE (16,21):ACCEPT BEEP VALIDATE("WBYCGbMR")SIZE(1);CC$
1345 IF CC$=""THEN GOTO 1340
1350 LOCATE (16,24):ACCEPT BEEP VALIDATE(DIGIT)SIZE(3);C1
1360 IF C1<0 OR C1>319 THEN GOTO 1350
1370 LOCATE (16,28):ACCEPT BEEP VALIDATE(DIGIT)SIZE(3);C2
1380 IF C2<0 OR C2>99 THEN GOTO 1370
1390 CALL PLOT(CC$,C1,C2):LOCATE (18,10):PRINT "ENCORE:"
1400 PAUSE$=KEY$:CALL PLOT("B",C1,C2):IF PAUSE$="O"THEN CLS:GOTO 1180
1410 CALL KEY1(A,B):IF A=255 THEN 1410
1420 IF A=27 THEN GOTO 270
1430 IF A=128 THEN GOTO 1000
1440 IF A=130 THEN GOTO 1460
1450 GOTO 1410
1460 CLS:CALL COLOR("0BRL")
1470 LOCATE (2,3):PRINT "  DDEESSSSIINN  "
1480 CALL COLOR("0BR"):LOCATE (14,1)
1490 PRINT " _1 Ch"&CHR$(17)&"ma."
1500 PRINT " _2 Bonhomme."
1510 PRINT " _3 Rond."
1520 PRINT " _4 Sinuso"&CHR$(26)&"de."
1525 PRINT " _5 Fin."
1530 LOCATE (16,20):PRINT "Menu:";
1540 ACCEPT VALIDATE("12345")SIZE(1),ME
1550 IF ME=5 THEN GOTO 2140
1560 CLS:ON ME GOSUB 1570,1720,2020,2050
1565 CLS:GOTO 1480
1570 LOCATE (14,12)
1580 PRINT "Moulin "&CHR$(2)&" dynamo."
1590 PRINT TAB(12)"================"
1600 LOCATE (18,2):PRINT RPT$(CHR$(4),10)
1610 LOCATE (21,2):PRINT RPT$(CHR$(4),10)
1620 LOCATE (18,1):PRINT CHR$(9)
1630 PRINT CHR$(12);CHR$(12)
1640 PRINT CHR$(12);CHR$(12)
1650 PRINT CHR$(8)
1660 LOCATE (18,11):PRINT CHR$(12);CHR$(12);CHR$(12)
1670 LOCATE (19,11):PRINT CHR$(12);CHR$(12);CHR$(12);CHR$(4);CHR$(23)
1680 LOCATE (20,11):PRINT CHR$(12);CHR$(12);CHR$(12)
1690 LOCATE (21,12):PRINT TAB(12)CHR$(7)
1700 LOCATE (22,1):PRINT "^^Ampoule ^^^Dinamo"
1710 PAUSE:RETURN
1720 LOCATE (14,15):PRINT "Bonhomme."
1740 CALL COLOR("0BR")
1750 LOCATE (15,18):PRINT "-----"
1760 PRINT TAB(17)"? * * ?"
1770 PRINT TAB(18)"! + !"
1780 PRINT TAB(19)"!-!"
1790 PRINT TAB(13)"/----/   \----\"
1800 PRINT TAB(13)"! !         ! !"
1810 PRINT TAB(13)"! !    *    ! !"
1820 PRINT TAB(13)"! !         ! !"
1830 PAUSE 9
1840 PRINT TAB(13)"! !    *    ! !"
1850 PRINT TAB(13)"! !         ! !"
1860 PRINT TAB(13)"! !    *    ! !"
1870 PRINT TAB(13)"! !         ! !"
1880 PRINT TAB(13)" # ----!---- #"
1890 PRINT TAB(13)"  !    !    !"
1900 PRINT TAB(13)"  !    !    !"
1910 PRINT TAB(13)"  !    !    !"
1920 PRINT TAB(13)"  !    !    !"
1930 PAUSE 9
1940 PRINT TAB(13)"  !    !    !"
1950 PRINT TAB(13)"  !    !    !"
1960 PRINT TAB(13)"  !    !    !"
1970 PRINT TAB(13)"  !    !    !"
1980 PRINT TAB(13)"/------!------\"
1990 PRINT TAB(13)"!      !      !"
2000 PRINT TAB(13)"\_____/ \_____/"
2010 PAUSE:RETURN
2020 DEG:FOR I=1 TO 360
2030 CALL PLOT("W",150+50*COS(I),149+50*SIN(I))
2040 NEXT I:RAD:PAUSE$=KEY$:LOCATE (17,4):PRINT "EFFACEMENT SVP"
2042 FOR I=1 TO 101
2044 CALL LINE("B",99+I,0,99+I,99)
2046 NEXT I:CLS:RETURN
2050 LOCATE (16,10):PRINT "LINE OU PLOT?(L/P)":DEG:E$=KEY$:IF E$="P"THEN 2080
2060 FOR I=0 TO 319:J=I*4:CALL LINE("R",I,50-49*SIN(J))
2070 NEXT I:GOTO 2100
2080 FOR I=0 TO 319:J=I*4
2085 CALL PLOT("R",I,50-49*SIN(J))
2090 NEXT I
2100 E$=KEY$:LOCATE (18,10):PRINT "EFFACEMENT SVP"
2110 FOR I=1 TO 320
2120 CALL LINE("B",I-1,1,I-1,99)
2130 NEXT I:CLS:RETURN
2140 CALL KEY1(A,B):IF A=255 THEN 2140
2150 IF A=27 THEN GOTO 270
2160 IF A=130 THEN END
2170 IF A=128 THEN 1150
2175 GOTO 2140
2180 END
