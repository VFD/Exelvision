1 DIM P(6),C1$(8),C2$(8)
2 DATA W,B,B,W,W,B,B,W,W,B,B,W,W,B,B,W
3 !------------------------------------!  !           ECHECS-DAMES             !
5 ! (Auteur W.FILLON)   Edition PUSSY  !  !------------------------------------!
6 CLS "BGY":CALL POKE(50500,162,5,45,162,136,45,10):CALL EXEC(50500)
7 FOR I=1 TO 8:READ C1$(I),C2$(I):NEXT I
8 DATA 0000010307070F0F0707,000080C0E0E0F0F0E0E0,030F0F03070F0F1F1F00
10 DATA C0F0F0C0E0F0F0F8F800,0001070F0F0703070F1F,0080E0F0F0E0C0E0F0F8
12 DATA 1F0F0703070F0F1F1F00,F8F0E0C0E0F0F0F8F800,00000001031E0F1D0001
14 DATA 000000C0E0E0F0F0F0F0,03030707070F0F1F1F00,E0E0C0C0E0F0F0F8F800
16 DATA 00000044EE447F7F3F3F,00000044EE44FEFEFCFC,03030303070F0F1F1F00
18 DATA C0C0C0C0E0F0F0F8F800,0000005555557F7F3F3F,000000545454FEFEFCFC
20 DATA 03030303070F0F1F1F00,C0C0C0C0E0F0F0F8F800,000000001B1F0F0F0F0F
22 DATA 0000000068F8F0F0F0F0,0F0F0F0F0F0F0F1F1F00,F0F0F0F0F0F0F0F8F800
24 FOR I=1 TO 24:READ P$:CALL CHAR(I,P$):NEXT I
25 DATA 0,4,8,12,16,20:FOR I=1 TO 6:READ P(I):NEXT I
26 FOR J=2 TO 16 STEP 4:FOR I=2 TO 16 STEP 4:CALL COLOR("0GW")
28 LOCATE (J,I):PRINT "  ";:CALL COLOR("0GB"):PRINT "  ":CALL COLOR("0GW")
30 LOCATE (J+1,I):PRINT "  ";:CALL COLOR("0GB"):PRINT "  "
32 LOCATE (J+2,I):PRINT "  ";:CALL COLOR("0GW"):PRINT "  ":CALL COLOR("0GB")
34 LOCATE (J+3,I):PRINT "  ";:CALL COLOR("0GW"):PRINT "  ":NEXT I:NEXT J
38 CALL COLOR("0BGHL"):LOCATE (7,22):PRINT "EECCHHEECCSS":PRINT
40 LOCATE (11,22):PRINT "--DDAAMMEESS"
42 CALL COLOR("0WGHL"):PRINT
44 LOCATE (8,22):PRINT "EECCHHEECCSS":PRINT
46 LOCATE (12,22):PRINT "--DDAAMMEESS"
48 CALL COLOR("0BG"):LOCATE (16,19)
50 PRINT "AUTEUR: WALTER FILLON"
52 CALL COLOR("0RGL"):LOCATE (21,4)
54 PRINT "EEddiittiioonn  PPUUSSSSYY  8888"
56 PAUSE 5:FOR I=7 TO 16:PAUSE 0
58 LOCATE (I,19):PRINT "                     "
60 NEXT I:LOCATE (21,4):PRINT "                                "
62 LOCATE (4,20):PRINT "MMEENNUU:"
64 CALL COLOR("0BG"):LOCATE (7,20)
66 PRINT " [1] ECHECS":LOCATE (9,20)
68 PRINT " [2] DAMES"
69 FGH$=KEY$
70 IF FGH$="1"THEN GOTO 76
72 IF FGH$="2"THEN GOTO 268
74 GOTO 69
76 FOR I=4 TO 9:LOCATE (I,20):PRINT "           ":NEXT I:CALL COLOR("1YW")
78 LOCATE (2,2):PRINT CHR$(21)&CHR$(22)
80 LOCATE (2,6):PRINT CHR$(5)&CHR$(6)
82 LOCATE (2,10):PRINT CHR$(13)&CHR$(14)
84 LOCATE (2,14):PRINT CHR$(9)&CHR$(10)
86 LOCATE (3,2):PRINT CHR$(23)&CHR$(24)
88 LOCATE (3,6):PRINT CHR$(7)&CHR$(8)
90 LOCATE (3,10):PRINT CHR$(15)&CHR$(16)
92 LOCATE (3,14):PRINT CHR$(11)&CHR$(12)
94 FOR I=4 TO 18 STEP 4
96 LOCATE (4,I):PRINT CHR$(1)&CHR$(2)
98 LOCATE (5,I):PRINT CHR$(3)&CHR$(4)
100 NEXT I:CALL COLOR("1YB")
102 LOCATE (2,4):PRINT CHR$(9)&CHR$(10)
104 LOCATE (2,8):PRINT CHR$(17)&CHR$(18)
106 LOCATE (2,12):PRINT CHR$(5)&CHR$(6)
108 LOCATE (2,16):PRINT CHR$(21)&CHR$(22):FOR I=2 TO 16 STEP 4
110 LOCATE (4,I):PRINT CHR$(1)&CHR$(2)
112 LOCATE (5,I):PRINT CHR$(3)&CHR$(4):NEXT I
114 LOCATE (3,4):PRINT CHR$(11)&CHR$(12)
116 LOCATE (3,8):PRINT CHR$(19)&CHR$(20)
118 LOCATE (3,12):PRINT CHR$(7)&CHR$(8)
120 LOCATE (3,16):PRINT CHR$(23)&CHR$(24):CALL COLOR("1GB")
122 LOCATE (16,2):PRINT CHR$(21)&CHR$(22)
124 LOCATE (17,2):PRINT CHR$(23)&CHR$(24)
126 LOCATE (16,6):PRINT CHR$(5)&CHR$(6)
128 LOCATE (17,6):PRINT CHR$(7)&CHR$(8)
130 LOCATE (16,10):PRINT CHR$(13)&CHR$(14)
132 LOCATE (17,10):PRINT CHR$(15)&CHR$(16)
134 LOCATE (16,14):PRINT CHR$(9)&CHR$(10)
136 LOCATE (17,14):PRINT CHR$(11)&CHR$(12)
138 FOR I=4 TO 16 STEP 4
140 LOCATE (14,I):PRINT CHR$(1)&CHR$(2)
142 LOCATE (15,I):PRINT CHR$(3)&CHR$(4)
144 NEXT I:CALL COLOR("1GW")
146 LOCATE (16,4):PRINT CHR$(9)&CHR$(10)
148 LOCATE (17,4):PRINT CHR$(11)&CHR$(12)
150 LOCATE (16,8):PRINT CHR$(17)&CHR$(18)
152 LOCATE (17,8):PRINT CHR$(19)&CHR$(20)
154 LOCATE (16,12):PRINT CHR$(5)&CHR$(6)
156 LOCATE (17,12):PRINT CHR$(7)&CHR$(8)
158 LOCATE (16,16):PRINT CHR$(21)&CHR$(22)
160 LOCATE (17,16):PRINT CHR$(23)&CHR$(24)
162 FOR I=2 TO 16 STEP 4
164 LOCATE (14,I):PRINT CHR$(1)&CHR$(2)
166 LOCATE (15,I):PRINT CHR$(3)&CHR$(4)
168 NEXT I:CALL COLOR("0BG"):FOR I=1 TO 8
170 LOCATE (1,I*2):PRINT STR$(I)
172 LOCATE (I*2,1):PRINT STR$(I):NEXT I
174 CALL COLOR("0BG"):LOCATE (1,19)
176 PRINT "DONNE COMPLEMENTAIRE:"
178 LOCATE (2,19):PRINT "---------------------"
180 LOCATE (4,20):PRINT "A=AUTRE PARTIE"
182 LOCATE (5,20):PRINT "Z=FIN"
184 LOCATE (6,20):PRINT "S=SOMMAIRE"
186 LOCATE (7,20):PRINT "P=Pion"
188 LOCATE (8,20):PRINT "R=Roi"
190 LOCATE (9,20):PRINT "D=Dame"
192 LOCATE (10,20):PRINT "F=Fou"
194 LOCATE (11,20):PRINT "T=Tour"
196 LOCATE (12,20):PRINT "C=Cavalier"
198 LOCATE (14,19):PRINT "EMPLACEMENT DU PION:"
199 LOCATE (15,19):PRINT "--------------------"
200 LOCATE (16,20):PRINT "H:Ligne horizontale"
202 LOCATE (17,20):PRINT "V:Ligne verticale"
204 LOCATE (19,2)
206 PRINT "DONNE COMPLEMENTAIRE:";:ACCEPT VALIDATE("AZSPRDFTC")SIZE(1),DC$
207 IF DC$=""THEN GOTO 204
208 IF DC$="A"OR DC$="S"THEN RUN
210 IF DC$="Z"THEN END
212 PRINT " COULEUR DU PION(J/V):";:ACCEPT VALIDATE("JV")SIZE(1),C$
213 IF C$=""THEN GOTO 204
214 PRINT " EMPLACEMENT DU PION:H ";:ACCEPT VALIDATE("123456783")SIZE(1),H1
216 LOCATE (21,26):PRINT "V ";:ACCEPT VALIDATE("12345678")SIZE(1),V1
218 PRINT " EFFACEMENT DU PION:H ";:ACCEPT VALIDATE("12345678")SIZE(1),H2
220 LOCATE (22,25):PRINT "L ";:ACCEPT VALIDATE("12345678")SIZE(1),V2
222 IF C$="J"THEN C$="Y"
223 IF C$="V"THEN C$="G"
224 FOR I=1 TO 8:FOR U=1 TO 8 STEP 2
226 IF H1=I AND V1=U THEN C$="1"&C$&C1$(I)
228 IF H1=I AND V1=U+1 THEN C$="1"&C$&C2$(I)
230 IF H2=I AND V2=U THEN CC$="1"&C1$(I)&C1$(I)
232 IF H2=I AND V2=U+1 THEN CC$="1"&C2$(I)&C2$(I)
234 NEXT U:NEXT I:H1=H1*2:V1=V1*2:H2=H2*2:V2=V2*2
236 IF DC$="P"THEN DC=1
238 IF DC$="F"THEN DC=5
240 IF DC$="C"THEN DC=9
242 IF DC$="R"THEN DC=13
244 IF DC$="D"THEN DC=17
246 IF DC$="T"THEN DC=21
248 CALL COLOR(C$)
250 LOCATE (H1,V1):PRINT CHR$(DC)&CHR$(DC+1)
254 LOCATE (H1+1,V1):PRINT CHR$(DC+2)&CHR$(DC+3)
258 CALL COLOR(CC$)
260 LOCATE (H2,V2):PRINT "  "
262 LOCATE (H2+1,V2):PRINT "  ":CALL COLOR("0BG")
264 FOR I=1 TO 4:LOCATE (18+I,2):PRINT "                           ":NEXT I
266 GOTO 204
268 CALL COLOR("1YB"):FOR I=4 TO 16 STEP 4
270 LOCATE (2,I):PRINT CHR$(1)&CHR$(2)
272 LOCATE (3,I):PRINT CHR$(3)&CHR$(4)
274 LOCATE (6,I):PRINT CHR$(1)&CHR$(2)
276 LOCATE (7,I):PRINT CHR$(3)&CHR$(4)
278 NEXT I:FOR I=2 TO 16 STEP 4
280 LOCATE (4,I):PRINT CHR$(1)&CHR$(2)
282 LOCATE (5,I):PRINT CHR$(3)&CHR$(4)
284 NEXT I:CALL COLOR("0BG"):FOR I=1 TO 8
286 LOCATE (I*2,1):PRINT STR$(I)
288 LOCATE (1,I*2):PRINT STR$(I):NEXT I
290 FOR I=1 TO 7:LOCATE (2+I,19):PRINT "            "
292 NEXT I:CALL COLOR("1GB")
294 FOR I=4 TO 16 STEP 4
296 LOCATE (14,I):PRINT CHR$(1)&CHR$(2)
298 LOCATE (15,I):PRINT CHR$(3)&CHR$(4)
300 NEXT I:FOR I=2 TO 16 STEP 4
302 LOCATE (12,I):PRINT CHR$(1)&CHR$(2)
304 LOCATE (13,I):PRINT CHR$(3)&CHR$(4)
306 LOCATE (16,I):PRINT CHR$(1)&CHR$(2)
308 LOCATE (17,I):PRINT CHR$(3)&CHR$(4)
310 NEXT I:CALL COLOR("0BG"):LOCATE (3,19)
312 PRINT "DONNE COMPLEMENTAIRE:":LOCATE (4,19)
314 PRINT "---------------------":LOCATE (6,20)
316 PRINT "A=AUTRE PARTIE":LOCATE (7,20)
318 PRINT "Z=FIN":LOCATE (8,20)
320 PRINT "S=SOMMAIRE":LOCATE (9,20)
322 PRINT "D=DAME":LOCATE (11,19)
324 PRINT "EMPLACEMENT DU PION:":LOCATE (12,19)
326 PRINT "--------------------":LOCATE (14,20)
328 PRINT "H=Ligne horizontale":LOCATE (15,20)
330 PRINT "L=Ligne verticale"
331 LOCATE (19,2):PRINT "DONNE COMPLEMENTAIRE:";
332 ACCEPT VALIDATE("AZSD")SIZE(1),DC$
333 IF DC$="S"OR DC$="A"THEN RUN
334 IF DC$="Z"THEN END
336 PRINT " COULEUR DU PION(J/V):";
338 ACCEPT VALIDATE("JV")SIZE(1),C$
340 IF C$=""THEN GOTO 331
341 IF C$="J"THEN C$="Y"
342 IF C$="V"THEN C$="G"
344 PRINT " EMPLACEMENT DU PION:H ";
346 ACCEPT VALIDATE("12345678")SIZE(1),H1
348 LOCATE (21,26):PRINT "L ";:ACCEPT VALIDATE("12345678")SIZE(1),V1
350 PRINT " EFFACEMENT DU PION:H ";
352 ACCEPT VALIDATE("12345678")SIZE(1),H2:LOCATE (22,25)
354 PRINT "L ";:ACCEPT VALIDATE("12345678")SIZE(1),V2
356 V1=V1*2:H1=H1*2:H2=H2*2:V2=V2*2
357 IF (H1=H2-4 OR H1=H2+4)AND (V1=V2-4 OR V1=V2+4)THEN GOTO 378
358 CALL COLOR("1"&C$&"B"):IF DC$="D"THEN GOTO 374
360 LOCATE (H1,V1):PRINT CHR$(1)&CHR$(2)
362 LOCATE (H1+1,V1):PRINT CHR$(3)&CHR$(4)
364 CALL COLOR("1BB")
366 LOCATE (H2,V2):PRINT "  "
368 LOCATE (H2+1,V2):PRINT "  "
370 CALL COLOR("0BG"):FOR I=1 TO 4
372 LOCATE (18+I,2):PRINT "                           ":NEXT I:GOTO 331
374 LOCATE (H1,V1):PRINT CHR$(17)&CHR$(18)
376 LOCATE (H1+1,V1):PRINT CHR$(19)&CHR$(20):GOTO 364
378 CALL COLOR("0BB"):A$="  "
380 IF H1=H2-4 AND V1=V2-4 THEN LOCATE (H2-2,V2-2):PRINT A$:LOCATE (H2-2+1,V2-2)
382 IF H1=H2-4 AND V1=V2+4 THEN LOCATE (H2-2,V2+2):PRINT A$:LOCATE (H2-2+1,V2+2)
384 IF H1=H2+4 AND V1=V2+4 THEN LOCATE (H2+2,V2+2):PRINT A$:LOCATE (H2+2+1,V2+2)
386 IF H1=H2+4 AND V1=V2-4 THEN LOCATE (H2+2,V2-2):PRINT A$:LOCATE (H2+2+1,V2-2)
388 PRINT A$:GOTO 358
