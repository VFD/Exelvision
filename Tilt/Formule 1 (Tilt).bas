1 !       ********************
2 !       *   FORMULE 1      *
3 !       *   POUR EXL 100   *
4 !       *   CHAGNY JEAN.   *
5 !       ********************
6 !
7 !       ****DECLARATIONS****
8 !
9 MT$="0E68D2CD031EF040043CE0010F78C00216B040042C60010F5840031AD08006FE"
10 EX$="0BA02163031B18008D1E139840073A108100F0901E81080480478F0844200205"
11 EX$=EX$&"70CEBD02110840704E118840043CE0010F78C00316B080052C200109488002"
12 EX$=EX$&"14A0000528"
13 CALL POKE(50920,162,5,45,162,136,45,10):CALL EXEC(50920)
14 FU=73:D=18
15 DIM Z$(6),P$(9),M$(6),C$(6)
16 C$(1)="C":C$(2)="R":C$(3)="M":C$(4)="Y":C$(5)="G":C$(6)="b"
17 MO$="C72030C7031EF040043CE0010F78C00216B040042C60010F5840031AD08006FE"
18 VO$=" "&CHR$(120)&CHR$(121)&CHR$(122)&CHR$(123)&" "
19 VP$=" "&CHR$(124)&CHR$(121)&CHR$(122)&CHR$(125)&" "
20 CHOC=0
21 RANDOMIZE
22 X=20
23 !
24 !      ***GRAPHISMES****
25 !
26 CALL CHAR(92,"FFFFFFFFFFFFFFFFFFFF")
27 CALL CHAR(33,"FEFCFCF8F0E0C0C08000")
28 CALL CHAR(34,"7F3F3F1F0F0703030100")
29 CALL CHAR(35,"00000000010000000000")
30 CALL CHAR(36,"00000000800000000000")
31 CALL CHAR(37,"00000000030300000000")
32 CALL CHAR(38,"00000000C0C000000000")
33 CALL CHAR(39,"0000001F191F1B000000")
34 CALL CHAR(40,"000000F898F8D8000000")
35 CALL CHAR(41,"00000300030303030303")
36 CALL CHAR(42,"0000FF04C9D2FFDFC7C0")
37 CALL CHAR(43,"0000FF20934BFFFBE303")
38 CALL CHAR(44,"0000C000C0C0C0C0C0C0")
39 CALL CHAR(50,"FFFFFFFFFF0000000000")
40 CALL CHAR(51,"00006666000066660000")
41 CALL CHAR(52,"0F0F0000000000000000")
42 CALL CHAR(53,"03000000000000000000")
43 CALL CHAR(61,"FFFFFF00000000000000")
44 CALL CHAR(62,"FFFFFFFFFF0000000000")
45 CALL CHAR(100,"00080808080808080000")
46 CALL CHAR(101,"18181818181800001818")
47 CALL CHAR(102,"18181818180000003838")
48 CALL CHAR(103,"38383838380000007878")
49 CALL CHAR(104,"78787878787878000000")
50 CALL CHAR(105,"00F8F8F8F8F8F8F8F8F8")
51 CALL CHAR(106,"000000003C0000000000")
52 CALL CHAR(107,"E01C0300000000031CE0")
53 CALL CHAR(108,"0738C000000000C03807")
54 CALL CHAR(120,"FF007CFEFEFEFEFEFE7C")
55 CALL CHAR(121,"FF0811254EFFFF3F0F00")
56 CALL CHAR(122,"FF1088A472FFFFFCF000")
57 CALL CHAR(123,"FF003E7F7F7F7F7F7F3E")
58 CALL CHAR(124,"FF007C828282FE82827C")
59 CALL CHAR(125,"FF003E4141417F41413E")
60 TG$=CHR$(33):TD$=CHR$(34)
61 Z$(1)="  "&CHR$(37)&CHR$(38)&"  "
62 Z$(2)="  "&CHR$(39)&CHR$(40)&"  "
63 Z$(3)="  "&CHR$(41)&CHR$(42)&CHR$(43)&CHR$(44)&"  "
64 Z$(4)="  "&CHR$(41)&CHR$(42)&CHR$(43)&CHR$(44)&"  "
65 Z$(5)="  "&CHR$(120)&CHR$(121)&CHR$(122)&CHR$(123)&"  "
66 Z$(6)="  "&CHR$(120)&CHR$(121)&CHR$(122)&CHR$(123)&"  "
67 P$(1)=CHR$(53)
68 P$(2)=CHR$(52)
69 P$(3)=CHR$(50)
70 P$(4)=CHR$(51)&CHR$(51)
71 P$(5)="COCACOLA"
72 P$(6)="TILTjeux"
73 P$(7)="AUTOMOTO"
74 P$(8)="PIOTPNEU"
75 P$(9)="exel 100"
76 M$(1)=CHR$(100)
77 M$(2)=CHR$(101)
78 M$(3)=CHR$(102)
79 M$(4)=CHR$(103)
80 M$(5)=CHR$(104)
81 M$(6)=CHR$(105)
82 !
83 !      ****PRESENTATION****
84 !
85 CLS "WBB"
86 CALL HRON("b",17,4):CALL POKE(50920,162,5,45,162,136,45,10):CALL EXEC(50920)
87 FOR I=1 TO 5
88 CALL COLOR("0BB"):LOCATE (I,1):PRINT RPT$(" ",40)
89 NEXT I
90 CALL COLOR("0YBHL"):LOCATE (3,12):PRINT "FFOORRMMUULLEE  11"
91 LOCATE (4,12):PRINT "FFOORRMMUULLEE  11"
92 CALL COLOR("1RB"):LOCATE (4,2):PRINT VP$:LOCATE (4,33):PRINT VP$
93 FOR I=6 TO 10
94 CALL COLOR("0CC"):LOCATE (I,1):PRINT RPT$(" ",40)
95 NEXT I
96 FOR I=11 TO 16
97 IF DEPART=1 AND I=6 THEN GOTO 101
98 CALL COLOR("0GG"):LOCATE (I,1):PRINT RPT$(" ",40)
99 CALL COLOR("1GB"):LOCATE (I,20-(I-7)):PRINT TG$&RPT$(" ",(I-7)*2)&TD$
100 CALL COLOR("1WB"):LOCATE (I,20):PRINT M$(I-10)
101 NEXT I
102 IF DEPART=0 THEN GOSUB 220:GOTO 96
103 CALL COLOR("0bb"):LOCATE (21,1):PRINT RPT$(" ",40)
104 CALL COLOR("0WB"):LOCATE (21,4):PRINT "FUEL"
105 LOCATE (21,14):PRINT "TIME"
106 LOCATE (21,24):PRINT "BOUM"
107 LOCATE (21,34):PRINT "RACE"
108 CALL COLOR("0bb"):LOCATE (22,2):PRINT RPT$(" ",38)
109 GOSUB 170
110 CALL SPEECH("L,"&MT$):H=INTRND(6):CO=INTRND(6):GOSUB 202
111 !
112 !     ****JEUX****
113 !
114 IND=INT(RND*3)-1:D=18
115 FOR I=12 TO 16:D=D+IND:CALL SPEECH("L,"&MT$)
116 CALL COLOR("1WB"):LOCATE (16,12):PRINT RPT$(" ",8)&M$(6)&RPT$(" ",9)
117 CALL KEY1(A,B):IF B=0 THEN 120
118 X=X-((A=129 AND X<24)*4)+((A=131 AND X>12)*4)
119 Q=Q-((A=32 AND Q<.6)*.1)+((A=130 AND Q>0)*.1)
120 LOCATE (16,X):PRINT VP$:LOCATE (16,X):PRINT VO$
121 IF H=3 THEN GOSUB 145:GOTO 128
122 IF H=4 THEN GOSUB 145:GOTO 128
123 CALL COLOR("1"&C$(CO)&"B")
124 LOCATE (I,D):PRINT Z$(I-10):LOCATE (I-1,D):PRINT RPT$(" ",6)
125 IF I<>16 THEN 127
126 IF D+4>=X AND D-4<X THEN GOSUB 134 ELSE GOSUB 183
127 CALL COLOR("1WB"):LOCATE (I-1,20):PRINT M$(I-11)
128 NEXT I
129 GOTO 110
130 !
131 !     ****EXPLOSION BOLIDE****
132 !
133 CALL COLOR("1RY")
134 LOCATE (16,12):PRINT CHR$(106)&RPT$(CHR$(107),4)
135 LOCATE (16,25):PRINT RPT$(CHR$(108),4)&CHR$(106)
136 CALL COLOR("1YRL")
137 LOCATE (16,17):PRINT "BBOOUUMM"
138 CALL SPEECH("L,"&EX$)
139 CHOC=CHOC+1:GOSUB 189
140 IF CHOC>2 THEN CLS "WWW":PAUSE 1:CLS "RRR":CLS "WWW":RUN
141 RETURN
142 !
143 !     ****PAYSAGE****
144 !
145 IF I=16 THEN GOSUB 155:GOTO 151
146 IF I=15 THEN CALL COLOR("1WG"):GOSUB 164:GOTO 151
147 IF I=14 THEN CALL COLOR("1WG"):GOSUB 166:GOTO 151
148 IF I=13 THEN CALL COLOR("1WG"):GOSUB 168:GOTO 151
149 CALL COLOR("1WG")
150 LOCATE (11,20-(I-7)):PRINT P$(I-11)
151 RETURN
152 !
153 !     ****COMPTEURS****
154 !
155 HA=INTRND(5)
156 CALL COLOR("0GG"):LOCATE (11,24-(I-7)):PRINT " "
157 CALL COLOR("0"&C$(INTRND(6))&"W")
158 LOCATE (11,20-(I-7)):PRINT SEG$(P$(I+HA-12),1,4)
159 LOCATE (12,20-(I-7)):PRINT SEG$(P$(I+HA-12),5,4)
160 PAUSE .1:CALL COLOR("0GG")
161 LOCATE (11,20-(I-7)):PRINT "    "
162 LOCATE (12,20-(I-7)):PRINT "    "
163 RETURN
164 CALL COLOR("1RW"):LOCATE (11,22-(I-7)):PRINT P$(I-11)
165 RETURN
166 CALL COLOR("1WG"):LOCATE (11,22-(I-7)):PRINT P$(I-11)
167 RETURN
168 CALL COLOR("1WG"):LOCATE (11,21-(I-7)):PRINT P$(I-11)
169 RETURN
170 FOR I=169 TO 193
171 CALL LINE("B",8,I,72,I)
172 CALL LINE("B",88,I,144,I)
173 CALL LINE("B",168,I,232,I)
174 CALL LINE("B",248,I,304,I)
175 NEXT I
176 FOR I=171 TO 191
177 CALL LINE("M",8,I,72,I)
178 NEXT I
179 RETURN
180 !
181 !     ****PROGRESSION COURSE RACE****
182 !
183 RAC=RAC+(.4+Q):RACE=INT(RAC):IF RACE>56 THEN 209
184 CALL LINE("Y",248+RACE,171,248+RACE,191)
185 FU=FU-(.1+Q):FUE=INT(FU):IF FUE<9 THEN CLS "YYY":CLS "WWW":PAUSE 1:RUN
186 CALL LINE("B",FUE,171,FUE,191)
187 RETURN
188 !
189 !     ****CHOCS****
190 !
191 FOR J=169 TO 171+(CHOC*7)
192 CALL LINE("R",170,J,230,J)
193 NEXT J
194 FOR K=169 TO 193
195 CALL LINE("B",248,K,304,K)
196 NEXT K
197 RAC=0:Q=0
198 RETURN
199 !
200 !     ****TEMPS****
201 !
202 T=T+.3
203 CALL LINE("G",90,193-T,142,193-T)
204 IF T>25 THEN CLS "WWW":PAUSE 1:CLS "RRR":PAUSE 1:CLS "YYY":PAUSE 1:RUN
205 RETURN
206 !
207 !     ****PERDU****
208 !
209 CALL HROFF
210 CALL POKE(50920,162,5,45,162,136,45,10):CALL EXEC(50920)
211 CLS "BbR":CLS "BbY":PAUSE .5:CLS "BbB":CLS "BbM":PAUSE .5:CLS "BbW"
212 CALL COLOR("1WRLH"):LOCATE (11,8):PRINT "CCHHAAMMPPIIOONN"
213 LOCATE (12,8):PRINT "CCHHAAMMPPIIOONN"
214 CALL COLOR("0RW"):LOCATE (22,30):PRINT "PRESS KEY"
215 CALL KEY1(A,B):IF B=0 THEN 215
216 RUN
217 !
218 !     ****AFFICHAGE DEPART****
219 !
220 CALL COLOR("1WB"):LOCATE (16,20):PRINT VO$
221 CALL SPEECH("L,"&MT$)
222 LOCATE (11,17):PRINT RPT$(CHR$(61),8):DEPART=1:PAUSE .3
223 LOCATE (11,17):PRINT RPT$(CHR$(62),8):CALL COLOR("0BW"):PAUSE .2
224 LOCATE (11,17):PRINT RPT$(CHR$(32),8):PAUSE .1
225 LOCATE (11,16):PRINT RPT$(CHR$(32),10):PAUSE .05
226 LOCATE (12,16):PRINT RPT$(CHR$(32),10)
227 CALL SPEECH("L,"&MT$)
228 LOCATE (11,14):PRINT RPT$(CHR$(32),14)
229 LOCATE (12,14):PRINT RPT$(CHR$(32),14)
230 CALL SPEECH("L,"&MT$)
231 LOCATE (13,14):PRINT RPT$(CHR$(32),14)
232 CALL COLOR("0BWL"):LOCATE (12,15):PRINT "DDEEPPAARRTT"
233 CALL SPEECH("L,"&MT$)
234 CALL COLOR("0BW"):LOCATE (11,13):PRINT RPT$(CHR$(32),16)
235 LOCATE (12,13):PRINT RPT$(CHR$(32),16)
236 CALL SPEECH("L,"&MT$)
237 LOCATE (13,13):PRINT RPT$(CHR$(32),16)
238 CALL SPEECH("L,"&MT$)
239 LOCATE (14,13):PRINT RPT$(CHR$(32),16)
240 LOCATE (15,13):PRINT " ":LOCATE (15,28):PRINT " "
241 LOCATE (16,13):PRINT " ":LOCATE (16,28):PRINT " "
242 CALL COLOR("0BWLH"):LOCATE (12,15):PRINT "DDEEPPAARRTT"
243 CALL SPEECH("L,"&MT$)
244 LOCATE (13,15):PRINT "DDEEPPAARRTT"
245 CALL COLOR("0BY"):LOCATE (22,31):PRINT "PRESS KEY"
246 CALL COLOR("1WB"):LOCATE (16,20):PRINT VO$
247 CALL SPEECH("L,"&MT$):PAUSE .4
248 LOCATE (16,20):PRINT VP$
249 CALL KEY1(A,B):IF B=0 THEN 246
250 CALL COLOR("1WB"):LOCATE (16,2):PRINT VO$
251 RETURN
252 !
253 !     ********************
254 !     * FIN DU PROGRAMME *
255 !     ********************
