1 !*********************************
2 !*      LE CORBEAU ET            *
3 !*      LE RENARD                *
4 !*      -c- TILT/CHANY jean      *
5 !*********************************
6 !
7 !*********************************
8 !*      DECLARATION              *
9 !*********************************
10 GOSUB 350:GOSUB 203:GOSUB 280
11 GOSUB 243:CALL INIT
12 DIM C$(7),F$(7),J$(4),R$(5),V(3),S(3),P$(4)
13 V(1)=32:S(1)=-6:P$(1)=CHR$(84)&RPT$(" ",6)
14 V(2)=35:S(2)=-3:P$(2)=CHR$(84)&RPT$(" ",3)
15 V(3)=32:S(3)=-6:P$(3)=CHR$(83)&RPT$(" ",6)
16 SC=0:VIE=6:T1$=CHR$(101)&CHR$(102)&CHR$(103)&CHR$(104)
17 R$(0)="          ":B$=RPT$(" ",8)
18 T2$=CHR$(109)&CHR$(110)&CHR$(111)&CHR$(112)
19 T3$=CHR$(115)&CHR$(113)&CHR$(114)&CHR$(116)
20 T4$=CHR$(117)&CHR$(118)&CHR$(119)&CHR$(120)
21 R$(1)="       "&CHR$(41)&CHR$(69)&" "
22 T5$=CHR$(105)&CHR$(106)&CHR$(107)&CHR$(108)
23 R$(2)="    "&CHR$(37)&CHR$(38)&" "&CHR$(40)&CHR$(46)&CHR$(66)&" "
24 R$(3)=" "&CHR$(33)&CHR$(34)&CHR$(35)&CHR$(36)&CHR$(89)&CHR$(39)&CHR$(89)&" "
25 R$(3)=R$(3)&" "
26 R$(4)="   "&CHR$(43)&CHR$(42)&"  "&CHR$(44)&CHR$(45)&" "
27 R$(5)="    "&CHR$(44)&CHR$(45)&CHR$(43)&CHR$(42)&"  "
28 !**********************************
29 !*         JEU 1er TABLEAU        *
30 !**********************************
31 RL0=18:RL1=19:RL2=20:RL3=21:RL4=22:RC=3
32 !Pour un acces plus simple au tableau 2 modifier line 33 la valeur de SC
33 SC=SC+(100*HV):HV=INTRND(3):IF SC>2000 THEN 60
34 CALL COLOR("0WB"):LOCATE (5,5):PRINT "SCORE:"
35 CALL COLOR("0WB"):LOCATE (6,5):PRINT USING"######";SC
36 CALL COLOR("0BB"):LOCATE (7,5):PRINT "      "
37 CALL COLOR("0WB"):LOCATE (8,5):PRINT "VIES: ";
38 LOCATE (9,5):CALL COLOR("0BB"):PRINT "      "
39 LOCATE (9,5):CALL COLOR("1RB"):PRINT RPT$(CHR$(126),VIE)
40 FOR I=V(HV)TO 3 STEP S(HV):CALL POKE(258,210,135)
41 RC=-RC+5
42 CALL COLOR("1RY"):LOCATE (RL0,RC):PRINT R$(0)
43 LOCATE (RL1,RC):PRINT R$(1)
44 LOCATE (RL2,RC):PRINT R$(2)
45 LOCATE (RL3,RC):PRINT R$(3)
46 LOCATE (RL4,RC):PRINT R$(5)
47 LOCATE (RL4,RC):PRINT R$(4)
48 RL0=18:RL1=19:RL2=20:RL3=21:RL4=22
49 CALL POKE(259,45)
50 LOCATE (22,RC+2):PRINT B$
51 IF N=2 THEN A,N=0:GOTO 53
52 CALL KEY1(A,B)
53 IF A=32 THEN RL0=RL0-1:RL1=RL1-1:RL2=RL2-1:RL3=RL3-1:RL4=RL4-1: ELSE 56
54 N=N+1:CALL POKE(258,60,132):PAUSE .1:CALL POKE(258,75,132)
55 CALL POKE(259,45)
56 CALL COLOR("1BY"):LOCATE (22,I):PRINT P$(HV)
57 IF RL1=19 AND I<RC+6 THEN GOSUB 256
58 NEXT I
59 GOTO 33
60 !**********************************
61 !*        PAYSAGE 1               *
62 !**********************************
63 FOR I=1 TO 12:CALL COLOR("0CC"):LOCATE (I,2):PRINT RPT$(" ",38):NEXT I
64 FOR I=13 TO 17:CALL COLOR("0GG"):LOCATE (I,2):PRINT RPT$(" ",38):NEXT I
65 FOR I=18 TO 22:CALL COLOR("0YY"):LOCATE (I,2):PRINT RPT$(" ",38):NEXT I
66 FOR I=11 TO 22:CALL COLOR("0BB"):LOCATE (I,34):PRINT RPT$(" ",6):NEXT I
67 FOR I=6 TO 11:CALL COLOR("0GG"):LOCATE (I,29):PRINT RPT$(" ",11):NEXT I
68 CALL COLOR("1GC"):LOCATE (1,34):PRINT CHR$(78):CALL COLOR("0GG")
69 LOCATE (1,35):PRINT RPT$(" ",5):LOCATE (2,33):PRINT CHR$(78)
70 CALL COLOR("1GG"):LOCATE (2,34):PRINT RPT$(CHR$(78),6)
71 CALL COLOR("1GC"):LOCATE (3,32):PRINT CHR$(78)
72 CALL COLOR("1GG"):LOCATE (3,33):PRINT RPT$(CHR$(78),7)
73 LOCATE (4,32):PRINT RPT$(CHR$(78),8)
74 LOCATE (5,31):PRINT RPT$(CHR$(78),9)
75 FOR I=4 TO 10:CALL COLOR("0BB"):LOCATE (I,3):PRINT RPT$(" ",10):NEXT I
76 CALL COLOR("1RB"):LOCATE (4,4):PRINT RPT$(CHR$(82),8)
77 LOCATE (10,4):PRINT RPT$(CHR$(82),8)
78 LOCATE (7,4):PRINT RPT$(CHR$(82),8)
79 !**********************************
80 !*        PAYSAGE 2               *
81 !**********************************
82 DATA 4,12,6,1,0,1
83 DATA 4,3,9,1,0,1
84 DATA 4,31,78,2,6,3
85 DATA 2,33,76,2,6,3
86 DATA 5,3,81,1,0,3
87 DATA 5,12,81,1,0,3
88 DATA 5,30,76,2,6,3
89 DATA 6,3,81,1,0,3
90 DATA 6,12,81,1,0,3
91 DATA 6,29,76,2,6,3
92 DATA 7,3,25,1,0,1
93 DATA 7,12,23,1,0,1
94 DATA 7,24,52,0,6,3
95 DATA 7,25,47,0,6,3
96 DATA 7,26,50,0,6,3
97 DATA 7,28,76,2,6,3
98 DATA 8,3,81,1,0,3
99 DATA 8,12,81,1,0,3
100 DATA 8,24,48,3,6,3
101 DATA 8,25,49,0,3,3
102 DATA 8,26,51,0,6,3
103 DATA 8,28,76,2,6,3
104 DATA 8,28,76,2,6,3
105 DATA 9,3,81,1,0,3
106 DATA 9,12,81,1,0,3
107 DATA 9,23,62,0,6,3
108 DATA 9,25,53,0,6,3
109 DATA 9,26,54,0,6,3
110 DATA 9,27,37,0,6,3
111 DATA 9,28,76,2,6,3
112 DATA 9,30,40,0,2,3
113 DATA 12,39,40,0,2,3
114 DATA 10,3,8,1,0,1
115 DATA 10,12,7,1,0,1
116 DATA 10,26,32,0,0,3
117 DATA 10,24,56,0,6,3
118 DATA 10,25,55,0,3,3
119 DATA 10,27,37,6,0,3
120 DATA 10,28,32,0,0,3
121 DATA 10,29,39,0,6,3
122 DATA 10,30,36,0,6,3
123 DATA 10,31,58,2,0,3
124 DATA 11,36,40,0,2,3
125 DATA 11,26,57,0,2,3
126 DATA 11,29,32,6,6,3
127 DATA 11,30,76,2,6,3
128 DATA 11,31,59,0,2,3
129 DATA 11,32,32,0,0,3
130 DATA 11,33,58,2,0,3
131 DATA 11,35,41,0,2,3
132 DATA 12,37,41,0,2,3
133 DATA 13,38,41,0,2,3
134 DATA 12,31,76,2,6,3
135 DATA 12,32,59,0,2,3
136 DATA 12,33,32,0,0,3
137 DATA 12,38,59,0,2,3
138 DATA 13,02,70,0,2,3
139 DATA 13,03,71,0,2,3
140 DATA 13,04,70,0,2,3
141 DATA 13,05,71,0,2,3
142 DATA 13,06,70,0,2,3
143 DATA 13,07,71,0,2,3
144 DATA 13,08,70,0,2,3
145 DATA 13,09,71,0,2,3
146 DATA 13,10,70,0,2,3
147 DATA 13,11,71,0,2,3
148 DATA 13,12,71,0,2,3
149 DATA 13,33,59,0,2,3
150 DATA 14,12,65,0,2,3
151 DATA 15,11,65,0,2,3
152 DATA 16,10,65,0,2,3
153 DATA 17,2,67,0,2,3
154 DATA 17,3,68,0,2,3
155 DATA 17,4,67,0,2,3
156 DATA 17,5,68,0,2,3
157 DATA 17,6,67,0,2,3
158 DATA 17,7,68,0,2,3
159 DATA 17,8,67,0,2,3
160 DATA 17,9,65,0,2,3
161 DATA 17,35,63,0,5,3
162 DATA 18,16,41,1,3,3
163 DATA 18,17,69,1,3,3
164 DATA 19,13,37,1,3,3
165 DATA 19,14,38,1,3,3
166 DATA 19,16,40,1,3,3
167 DATA 19,17,46,1,3,3
168 DATA 19,18,61,0,3,3
169 DATA 20,10,33,7,3,3
170 DATA 20,11,34,7,1,3
171 DATA 20,12,35,7,3,3
172 DATA 20,13,36,1,2,3
173 DATA 20,14,32,1,1,1
174 DATA 20,15,39,1,3,3
175 DATA 20,16,32,1,1,1
176 DATA 20,33,52,0,3,3
177 DATA 21,12,43,1,3,3
178 DATA 21,13,42,1,3,3
179 DATA 21,16,44,1,3,3
180 DATA 21,17,45,1,3,3
181 DATA 21,32,51,3,0,3
182 DATA 21,33,36,0,2,3
183 DATA 22,31,51,3,0,3
184 DATA 22,33,57,0,6,3
185 DATA 22,36,57,0,6,3
186 DATA 22,32,32,0,0,1
187 C$(0),F$(0)="B":J$(1)="0":J$(3)="1"
188 C$(1),F$(1)="R"
189 C$(2),F$(2)="G"
190 C$(3),F$(3)="Y"
191 C$(4),F$(4)="b"
192 C$(5),F$(5)="M"
193 C$(6),F$(6)="C"
194 C$(7),F$(7)="W"
195 !**********************************
196 !*   CARACTERES GRAPHIQUES        *
197 !**********************************
198 RESTORE 68
199 FOR I=1 TO 105
200 READ Y,X,CA,C,F,J
201 LOCATE (Y,X):CALL COLOR(J$(J)&C$(C)&F$(F)):PRINT CHR$(CA)
202 NEXT I:GOTO 287
203 RESTORE 209
204 FOR I=1 TO 64
205 READ A,A$
206 CALL CHAR(A,A$)
207 NEXT I
208 GOSUB 248
209 DATA 19,000000000000031F1E11,21,FFFFFFFFFFFF7FDF7FAF
210 DATA 33,01073FFF7F7F7F3F0F0F,34,F0F0F0F8F8F8F8F0F0F0
211 DATA 35,C0F8FFFFFFFFFFFFF080,36,3F7F7FFFFFFFFFFFFFFF
212 DATA 37,00000000000000000F1F,38,0000000000000000E0F8
213 DATA 39,01FFFFFFFFFFFFFFFFFF,40,C7CFEFFF7F7F3F3F3F7F
214 DATA 41,00000000327F7FEEC6C7,42,DFDFDEBCBC78E0C0C0F0
215 DATA 43,010107070F0F1C18303C,44,FF1F0F07030100000000
216 DATA 45,80C0C0E060B0DD6F0000,46,C07F7FFEFCF8E0FEFF00
217 DATA 47,1E7FFFFFFFFF1F581AF8,48,1F1F3F2F7D7FFEFCF87F
218 DATA 49,BF070F1F3F7FFFFFFF7F,50,00C0F0F0F8F8F8F8F8F8
219 DATA 51,F8F8F0F0F0E0E0C08000,52,00000001010303070707
220 DATA 53,70FFFFFFFFFFFFFFFFFF,54,E0F8FCFCFEFEFEFEFEFE
221 DATA 55,9C9C9C9C4CDAFEFFFFFF,56,F87F03013FFFFF071F01
222 DATA 57,FFFFFFFFFFFFF7676624,58,0F7F3F1F1F0F0F070301
223 DATA 59,FF7F3F3F3F3F1F070303,60,E0F8FC76773B1D1D3E7F
224 DATA 61,00C0C0007F557F7F0000,62,1E7B7DFDBDBBC67C0000
225 DATA 63,FFE7D9A6A2BA566DB9C7,65,010A1C8E98E0C0C0C0C0
226 DATA 66,00C0C000000000000000,67,000000808281BFF1C2C0
227 DATA 68,000000004080FF402000,69,0000008080C0C0C0C0C0
228 DATA 70,000000000000000000AD,71,000000000000000001DD
229 DATA 72,92244890204080000000,73,4992244992244992254A
230 DATA 75,00000001020409122449,76,0F1F3F7F7F7F7F3F1F0F
231 DATA 77,003C7EFFFFFFFFFFFFFF,78,00000F3F7F7F7F7FFFFF
232 DATA 81,18181818181818181818,82,00000000FFFF00000000
233 DATA 83,02080B0408107CFEFE7C,84,C060B0182C060BABFFFF
234 DATA 89,FFFFFFFFFFFFFFFFFFFF,126,0A0A0A1E36FF1F3F4F07
235 DATA 101,80402300201088442200,102,033CC03C0300031C0300
236 DATA 103,C03C033CC000C038C000,104,0102C400040810004080
237 DATA 105,000000000080C0C0FFFF,106,030303070F1F3F79F1C0
238 DATA 107,4FDFDFFFF0F8FCDE8F03,108,FCF8F0E000010303FFFF
239 DATA 109,0C1E3F77C10000000000,110,071F3FFFFFFFF0E6EFEF
240 DATA 111,E0F8FCFFFFFF87337BFB,112,3078FCEE830000000000
241 RETURN
242 REM
243 CLS "CBB"
244 FOR I=1 TO 12:CALL COLOR("0CC"):LOCATE (I,2):PRINT RPT$(" ",38):NEXT I
245 FOR I=13 TO 16:CALL COLOR("0GG"):LOCATE (I,2):PRINT RPT$(" ",38):NEXT I
246 FOR I=17 TO 22:CALL COLOR("0YY"):LOCATE (I,2):PRINT RPT$(" ",38):NEXT I
247 RETURN
248 CALL CHAR(113,"77783F3F1F0F07020101"):CALL CHAR(114,"F68EFCFCF8F0E0408080")
249 CALL CHAR(115,"00000040C0C0E0703031"):CALL CHAR(116,"000000020303070E0C0C")
250 CALL CHAR(117,"381F0F0F070000000000"):CALL CHAR(118,"FCFFFFFFFF7F3F1F0F07")
251 CALL CHAR(119,"3FFFFFFFFFFEFCF8F1E7"):CALL CHAR(120,"1CF8F0F0E0011E7EFCFC")
252 RETURN
253 !**********************************
254 !*      Ss ROUTINE PERDU          *
255 !**********************************
256 SC=SC-150:VIE=VIE-1
257 CALL COLOR("0WB"):LOCATE (6,5):PRINT USING"######";SC
258 LOCATE (9,5):CALL COLOR("0BB"):PRINT "      "
259 LOCATE (9,5):CALL COLOR("1RB"):PRINT RPT$(CHR$(126),VIE)
260 IF ASC(SEG$(P$(HV),1,1))=84 THEN 269 ELSE 261
261 CALL SPEECH("L,"&SXB$):PAUSE .2
262 CALL COLOR("0BY")
263 LOCATE (19,RC):PRINT "    * *  *"
264 LOCATE (20,RC):PRINT "**  *  * *"
265 LOCATE (21,RC):PRINT "  **  **"
266 LOCATE (22,RC):PRINT "* *   *  *"
267 PAUSE .5
268 GOTO 279
269 CALL COLOR("0YY"):FOR I=18 TO 22:LOCATE (I,2):PRINT RPT$(" ",27):NEXT I
270 CALL COLOR("1BYF"):LOCATE (18,RC+3):PRINT T1$
271 CALL COLOR("1RY"):LOCATE (19,RC+3):PRINT T2$
272 LOCATE (20,RC+3):PRINT T3$;:CALL COLOR("1BY"):PRINT CHR$(84)
273 CALL COLOR("1RY"):LOCATE (21,RC+3):PRINT T4$
274 LOCATE (22,RC+3):PRINT T5$
275 DATA 159,.5,159,.5,159,.1,159,.5,133,.25,141,.1,141,.5,159,.4
276 DATA 159,.1,159,.75
277 RESTORE 275:FOR MU=1 TO 10:READ AZ,AQ:CALL POKE(258,AZ,135):PAUSE AQ
278 CALL POKE(259,45):NEXT MU:CALL COLOR("1YY"):LOCATE (18,RC+3):PRINT "    "
279 IF VIE=0 THEN CLS:GOTO 341
280 !**********************************
281 !*       SONS EXPLOSION           *
282 !**********************************
283 SXB1$="0BA02163031B18008D1E139840073A108100F0901E81080480478F084420020570"
284 SXB2$="CEBD02110840704E118840043CE0010F78C00316B080052C20010948800214A000"
285 SXB3$="05284081FF":SXB$=SXB1$&SXB2$&SXB3$
286 RETURN
287 !**********************************
288 !*      JEU 2eme TABLEAU          *
289 !**********************************
290 P$(1)=CHR$(83)
291 P$(2)=CHR$(62)
292 P$(3)=CHR$(62)
293 P$(4)=CHR$(84)
294 CALL COLOR("0BY"):LOCATE (5,5):PRINT "SCORE:"
295 CALL COLOR("0WB"):LOCATE (6,5):PRINT USING"######";SC
296 CALL COLOR("0BG"):LOCATE (8,5):PRINT " VIE:"
297 CALL COLOR("1RB"):LOCATE (9,5):PRINT RPT$(CHR$(126),VIE)
298 RL0=18:RL1=19:RL2=20:RL3=21:RL4=22
299 CALL COLOR("0WB"):LOCATE (22,2):PRINT "PRET ?  [ENVOI]":PAUSE:RC=10
300 CALL COLOR("0YY"):LOCATE (22,2):PRINT "               "
301 CALL COLOR("1RY")
302 LOCATE (RL0,RC):PRINT B$
303 IF D=0 THEN HV=INTRND(4):BC=INTRND(5):BC=BC+15:GOTO 304 ELSE 305
304 LOCATE (9,23):CALL COLOR("1BC"):PRINT CHR$(62):CALL POKE(258,140,130)
305 GOSUB 320:CALL COLOR("1RY")
306 CALL KEY1(A,B)
307 CALL POKE(259,45):CALL POKE(258,180,135)
308 IF B<>0 THEN LOCATE (RL4,RC):PRINT R$(5)
309 RC=RC+1*(A=131 AND RC>3):RC=RC-1*(A=129 AND RC<7)
310 LOCATE (RL4,RC):PRINT R$(5)
311 LOCATE (RL1,RC):PRINT R$(1)
312 LOCATE (RL2,RC):PRINT R$(2)
313 LOCATE (RL3,RC):PRINT R$(3)
314 LOCATE (RL4,RC):PRINT R$(4)
315 CALL POKE(259,45):GOTO 303
316 GOTO 303
317 !**********************************
318 !*    CADEAU DU CORBEAU           *
319 !**********************************
320 LOCATE (9,23):CALL COLOR("1CC"):PRINT " ":D=D+1
321 IF D=1 THEN LOCATE (10,BC):CALL COLOR("1BC"):PRINT CHR$(62):GOTO 330
322 IF D=2 THEN LOCATE (10,BC):CALL COLOR("1CC"):PRINT " "
323 IF D=2 THEN LOCATE (13,BC-2):CALL COLOR("1BG"):PRINT CHR$(62):GOTO 330
324 IF D=3 THEN LOCATE (13,BC-2):CALL COLOR("1GG"):PRINT " "
325 IF D=3 THEN LOCATE (18,BC-4):CALL COLOR("1BY"):PRINT P$(HV):GOTO 330
326 IF D=4 THEN LOCATE (18,BC-4):CALL COLOR("1YY"):PRINT " "
327 IF D=4 AND RC=BC-13 AND ASC(SEG$(P$(HV),1,1))>82 THEN GOSUB 256
328 IF D=4 AND RC=BC-13 AND ASC(SEG$(P$(HV),1,1))<80 THEN GOSUB 334
329 IF D=4 THEN D=0
330 RETURN
331 !**********************************
332 !*    SCORE AFFICHAGE             *
333 !**********************************
334 SC=SC+500
335 CALL POKE(258,121,128):PAUSE .5:CALL POKE(259,45)
336 CALL COLOR("0WB"):LOCATE (6,5):PRINT USING"######";SC
337 !CALL COLOR("1RB"):LOCATE (9,5):PRINT "      "
338 !CALL COLOR("1RB"):LOCATE (9,5):PRINT RPT$(CHR$(126),VIE)
339 LOCATE (20,RC+9):CALL COLOR("1BY"):PRINT CHR$(61):PAUSE 2
340 RETURN
341 !**********************************
342 !*           FIN DE PARTIE        *
343 !**********************************
344 CLS "RBY":CALL COLOR("1RBHL"):LOCATE (12,12):PRINT "SSCCOORREE  ::"
345 LOCATE (13,12):PRINT "SSCCOORREE  ::"
346 CALL COLOR("1RBH"):LOCATE (12,28):PRINT SC
347 LOCATE (13,28):PRINT SC
348 CALL COLOR("1WbL"):LOCATE (22,5)
349 PRINT "PPRREESSSSEEZZ    [[EENNVVOOII]]":PAUSE:RUN 11
350 !**********************************
351 !*         DEBUR DE PARTIE        *
352 !**********************************
353 CLS "WbY":CALL COLOR("0WbHL"):LOCATE (7,10):PRINT "LLEE  CCOORRBBEEAAUU"
354 LOCATE (8,10):PRINT "LLEE  CCOORRBBEEAAUU"
355 LOCATE (10,18):PRINT "EETT"
356 LOCATE (11,18):PRINT "EETT"
357 LOCATE (13,11):PRINT "LLEE  RREENNAARRDD"
358 LOCATE (14,11):PRINT "LLEE  RREENNAARRDD"
359 CALL COLOR("0Mb"):LOCATE (16,4):PRINT "1er  TABLEAU  sauter avec espace"
360 LOCATE (17,4):PRINT "2eme TABLEAU  deplacer avec fleches"
361 LOCATE (18,4):PRINT "6 vies pour les 2 tableaux"
362 LOCATE (19,4):PRINT "Acces au 2em tableau avec 2000 pts."
363 LOCATE (20,4):PRINT "Acces plus simple modifier line 33"
364 CALL COLOR("0WbL"):LOCATE (22,5)
365 PRINT "PPRREESSSSEEZZ    [[EENNVVOOII]]":PAUSE:RETURN
366 SUB INIT
367 CALL POKE(50850,162,5,45,162,136,45,10):CALL EXEC(50850)
368 CALL POKE(50688,165,8,6,10):CALL POKE(49156,198,0):SUBEND
