1 GOSUB 32000
2 CALL POKE(50176,114,11,32,241,10)
3 CALL EXEC(50176)
4 PRINT "FICHIER 1 CHARGE"
6 CALL POKE(50176,114,15,32,241,10)
7 CALL EXEC(50176)
8 PRINT "FICHIER 2 CHARGE"
9 RANDOMIZE:CALL EXEC(50320)
10 DIM CJ(7),HJ(7),CB(4),HB(4),JC(19),P(20,2),JA(19),F1$(15)
20 DIM AP(5),KK(5),F(5),XB(5),XA(5),XP(5),TI$(8)
21 K=0
22 GOSUB 30000:GOSUB 10000
25 GOSUB 7200:CLS:LOCATE (1,1)
27 GOSUB 7100
29 GOSUB 7050
31 GOSUB 7000
32 T$="AAABBBCCCDDDDEEEEEFFFFFFGGGGGGHHHHHHIIIIIIJJJJJJJJJJJJJJKKKKLLLLLLLLLLLL"
33 T$=T$&"MMMMMMMMMMNNNNNNNNNNOOOOOOOOOOPQRS"
2000 FOR II=1 TO 6:GOSUB 2900:GOSUB 4350:GOSUB 2900:GOSUB 3350:NEXT
2005 IF TU<>0 THEN 2020
2010 GOSUB 4400:IF CC=0 THEN 2050
2012 IF CK=700 THEN 2050
2015 GOTO 2005
2020 GOSUB 3400:IF HK=700 THEN 2050
2022 IF CC>0 THEN 2005
2025 IF CC=0 THEN 2040
2030 GOTO 6300
2040 A$="*****  TALON EPUISE  *****":GOTO 2055
2050 A$="*****  FIN DE MANCHE  *****"
2055 GOSUB 6280:FOR I=1 TO 5000:NEXT:GOSUB 2500
2057 IF CT>=5000 OR HT>=5000 THEN 6300
2060 GOTO 31
2400 CLS "BCC":CALL COLOR("0BCH")
2412 LOCATE (1,5):PRINT "RESULTATS":LOCATE (2,5):PRINT "RESULTATS"
2414 CALL COLOR("0RC")
2415 LOCATE (1,19):PRINT A9$;RPT$(A4$,9);AB$;RPT$(A4$,9);A6$
2417 LOCATE (2,19):PRINT A3$;TAB(29);
2420 LOCATE (2,29):PRINT A3$;TAB(39);A3$
2425 LOCATE (3,2):PRINT A9$;RPT$(A4$,16);A5$;RPT$(A4$,9);A5$;RPT$(A4$,9);AC$
2430 FOR I=1 TO 8
2435 LOCATE (2+2*I,2):PRINT A3$;TAB(19);A3$;TAB(29);
2440 PRINT A3$;TAB(39);A3$
2445 LOCATE (3+2*I,2):PRINT AE$;RPT$(A4$,16);A5$;RPT$(A4$,9);A5$;RPT$(A4$,9);AC$
2450 NEXT
2455 LOCATE (20,2):PRINT A3$;TAB(19);A3$;TAB(29);A3$;TAB(39);A3$;
2465 LOCATE (21,2):PRINT A8$;RPT$(A4$,16);AD$;RPT$(A4$,9);AD$;RPT$(A4$,9);A7$;
2470 CALL COLOR("0RCL")
2475 LOCATE (20,5):PRINT "TTOOTTAALL";
2480 CALL COLOR("0BC")
2485 RETURN
2500 GOSUB 2400
2505 LOCATE (2,21):PRINT JR$:LOCATE (2,31):PRINT EX$
2510 FOR I=1 TO 8:LOCATE (2+2*I,4):PRINT TI$(I):NEXT
2520 I=4:J=23:M1=0:M2=0
2525 M=HK:GOSUB 2700:M=CK:GOSUB 2700
2530 M=HO*100-300*(HO=4):GOSUB 2700:M=CO*100-300*(CO=4):GOSUB 2700
2535 M=HF*300:GOSUB 2700:M=CF*300:GOSUB 2700
2540 M=-400*(HK=700):GOSUB 2700:M=-400*(CK=700):GOSUB 2700
2550 M=-300*(HK=700 AND HE=0):GOSUB 2700
2555 M=-300*(CK=700 AND CE=0):GOSUB 2700
2560 M=-500*(CK=0):GOSUB 2700:M=-500*(HK=0):GOSUB 2700
2565 M=M1:M1=0:GOSUB 2700:M=M2:M2=0:GOSUB 2700
2570 M=HT:GOSUB 2700:M=CT:GOSUB 2700
2572 CALL COLOR("0BCL")
2575 HT=M1:WN=M1:WP=4:WL=20:WC=21:GOSUB 5802
2580 CT=M2:WN=M2:WP=4:WL=20:WC=31:GOSUB 5802
2590 CALL COLOR("0BC"):LOCATE (22,1)
2595 PRINT "TAPER UNE TOUCHE POUR CONTINUER : ";
2600 WA$=KEY$
2610 RETURN
2700 LOCATE (I,J):PRINT USING"####";M;
2705 IF J=23 THEN M1=M1+M:J=33:RETURN
2710 M2=M2+M:J=23:I=I+2:RETURN
2900 C=0:IF CC=0 THEN RETURN
2905 M=INTRND(CC)
2910 C=ASC(SEG$(T$,M,1))-64
2912 IF CC=1 THEN 2920
2915 IF M=1 THEN T$=SEG$(T$,CC,1)&SEG$(T$,2,CC-2):GOTO 2920
2916 IF M=CC THEN T$=SEG$(T$,1,CC-1):GOTO 2920
2917 T$=SEG$(T$,1,M-1)&SEG$(T$,CC,1)&SEG$(T$,M+1,CC-M-1)
2920 CC=CC-1:GOSUB 6200:RETURN
3000 M=0:IF J<0 OR J>15 THEN RETURN
3005 IF J<>4 THEN 3025
3010 IF CL<>4 AND CP=0 THEN RETURN
3015 IF CP<>0 THEN M=2:RETURN
3020 M=1:RETURN
3025 IF J>5 THEN 3050
3030 M1=J:IF J=5 THEN M1=4
3035 IF (CA=10 OR ((CA=0 OR CA>5)AND CP<>0))AND CB(M1)=0 THEN RETURN
3040 IF CB(M1)<>0 THEN M=2:RETURN
3045 M=3:RETURN
3050 IF J<>9 THEN 3065
3055 IF HL<>4 THEN M=4
3060 RETURN
3065 IF J>10 THEN 3085
3070 IF HA=J-5 THEN RETURN
3075 IF J<>10 THEN 3080
3077 IF HA=0 OR (HA>5 AND HA<9 AND HP=0)THEN RETURN
3080 M=5:RETURN
3085 IF (HA>0 AND HA<6)OR (HA<>10 AND HP=0)THEN M=6:RETURN
3090 IF J<14 AND HL=4 THEN M=9:RETURN
3095 IF HK+KK(J-10)>700 THEN M=8:RETURN
3100 IF J=11 AND HE>1 THEN M=7
3105 RETURN
3300 M=10:IF CD<1 OR CD>5 THEN RETURN
3305 IF J<16 THEN RETURN
3310 IF J=19 AND CD>=4 THEN M=0:RETURN
3315 IF J=CD+15 THEN M=0
3320 RETURN
3350 HJ(II)=C
3355 M1=C:M2=II:GOSUB 6000
3360 RETURN
3400 IF HD<16 THEN M1=1:M2=3:GOSUB 3600:GOTO 3403
3402 CH=1
3403 IF CH=1 THEN 3425
3404 IF CH<>3 THEN 3409
3405 CALL COLOR("0BW"):LOCATE (1,1):PRINT RPT$(" ",40);:LOCATE (1,1)
3406 PRINT "Vous abandonnez (O/N) ? ";:A$=KEY$:IF A$="O"THEN CC=-1:RETURN
3407 LOCATE (1,1):GOTO 3400
3409 I2=6:GOSUB 3700:GOSUB 3300:IF M<>0 THEN GOSUB 3465:GOTO 3400
3410 HF=HF+1:I2=6:FF=1:GOSUB 3500
3415 GOSUB 2900:IF C=0 THEN RETURN
3420 II=6:GOSUB 3350
3425 GOSUB 2900:IF C=0 THEN RETURN
3430 II=7:GOSUB 3350
3435 M1=4:M2=5:GOSUB 3600
3440 I2=7:GOSUB 3700:IF CH=2 THEN J=-J
3445 GOSUB 3000:IF M<>0 THEN GOSUB 3465:GOTO 3435
3450 I2=7:GOSUB 3500
3455 RETURN
3465 CALL COLOR("0RW"):LOCATE (1,1):PRINT RPT$(" ",40);:LOCATE (1,11)
3470 PRINT "action illegale":GOSUB 20900:FOR IK=1 TO 2000:NEXT:RETURN
3500 NC=NC+1:IF I=I2 THEN 3502
3501 M1=HJ(I2):M2=I:GOSUB 6000:M1=0:M2=I2:GOSUB 6000:HJ(I)=HJ(I2)
3502 IF I=I2 THEN M1=0:M2=I2:GOSUB 6000
3505 M1=ABS(J):IF J<0 THEN M2=18:GOSUB 6000:GOTO 3560
3510 IF J=4 THEN M2=20:GOSUB 6000:C2=CL:CL=4:GOTO 3560
3515 IF J<6 THEN C1=CA:CA=J:M2=19:GOSUB 6000:GOTO 3560
3520 IF J=9 THEN HL=9:M2=16:GOSUB 6000:GOTO 3560
3525 IF J<11 THEN HA=J:M2=17:GOSUB 6000:GOTO 3560
3530 IF J=11 THEN HE=HE+1
3535 IF J<16 THEN HK=HK+KK(J-10):GOSUB 6150:GOTO 3560
3540 HO=HO+1:M2=7+HO:GOSUB 6000:HB(J-15)=1
3542 IF FF=1 THEN GOSUB 6250:FF=0
3545 IF J=19 THEN 3550
3547 IF I2=6 THEN HA=H1:M1=H1:M2=17:GOSUB 6000
3549 GOTO 3560
3550 HP=1:IF HA=5 THEN HA=H1:M1=C1:M2=17:GOSUB 6000
3555 IF HL=4 THEN HL=H2:M1=C2:M2=16:GOSUB 6000
3560 HD=J:IF J<16 THEN TU=0
3565 J=ABS(J):JC(J)=JC(J)+1:RETURN
3600 CALL COLOR("0BW"):LOCATE (1,1):PRINT RPT$(" ",40);
3605 FOR I=M1 TO M2:LOCATE (1,PC(I)):PRINT TC$(I);:NEXT
3610 CH=1
3615 LOCATE (1,PC(M1+CH-1)):CALL COLOR("0BR"):PRINT TC$(M1+CH-1)
3620 A$=KEY$:IF A$=""THEN 3620
3625 LOCATE (1,PC(M1+CH-1)):CALL COLOR("0BW"):PRINT TC$(M1+CH-1)
3630 IF A$=" "THEN RETURN
3635 IF A$=CHR$(131)THEN CH=CH-1:IF CH=0 THEN CH=M2-M1+1
3640 IF A$=CHR$(129)THEN CH=CH+1:IF CH=M2-M1+2 THEN CH=1
3645 GOTO 3615
3700 I=1
3705 LOCATE (7,P(I,2)+1):CALL COLOR("0RG"):PRINT "^^^^";
3710 A$=KEY$:IF A$=""THEN 3710
3715 LOCATE (7,P(I,2)+1):CALL COLOR("0BG"):PRINT "    ";
3720 IF A$=" "THEN J=HJ(I):RETURN
3725 IF A$=CHR$(131)THEN I=I-1:IF I=0 THEN I=I2
3730 IF A$=CHR$(129)THEN I=I+1:IF I>I2 THEN I=1
3735 GOTO 3705
4000 K=JA(16)+JA(17)+JA(18)+JA(19)
4001 IF K<>0 AND CC-KA<2 THEN GOSUB 5000:IF K<>0 THEN J=K:RETURN
4003 GOSUB 5050:IF J=0 THEN 4015
4005 GOSUB 5000:IF K=0 THEN RETURN
4010 J=K:RETURN
4015 GOSUB 5100:IF J=0 THEN 4030
4020 GOSUB 5000:IF K=0 THEN 4060
4025 J=K:RETURN
4030 GOSUB 5400:IF J<>0 THEN RETURN
4035 IF CA<>0 OR (CA=0 AND CP<0)THEN 4055
4037 IF JA(10)<>0 THEN J=10:RETURN
4040 IF NC>10 AND JA(19)<>0 THEN J=19:RETURN
4045 IF NC<20 THEN 4055
4050 GOSUB 5000:IF K<>0 THEN J=K:RETURN
4055 I2=53:GOSUB 5150:IF J<>0 THEN RETURN
4060 GOSUB 5300:IF J<>0 THEN RETURN
4065 I2=80:GOSUB 5150:IF J<>0 THEN RETURN
4070 IF NC>53 AND CK<200 AND JA(19)<>0 THEN J=19:RETURN
4075 GOSUB 5350:IF J<>0 THEN RETURN
4080 GOSUB 5450:RETURN
4300 J=0:IF HD<=0 OR HD>5 THEN RETURN
4305 M=HD:IF HD=5 THEN M=4
4310 IF JA(15+M)<>0 THEN J=15+M:CF=CF+1
4315 RETURN
4350 CJ(II)=C:JA(C)=JA(C)+1:RETURN
4400 GOSUB 4300:IF J=0 THEN 4420
4405 I2=6:FF=1:GOSUB 4500
4410 GOSUB 2900:IF C=0 THEN RETURN
4415 II=6:GOSUB 4350
4420 GOSUB 2900:IF C=0 THEN RETURN
4425 II=7:GOSUB 4350
4430 GOSUB 4000:I2=7:GOSUB 4500
4435 RETURN
4500 NC=NC+1:M1=ABS(J):I=0:FOR K=1 TO I2
4505 IF CJ(K)=ABS(J)THEN I=K
4510 NEXT:IF I<>I2 THEN CJ(I)=CJ(I2)
4515 IF J<0 THEN M2=18:GOSUB 6000:GOTO 4575
4520 IF J>5 THEN 4535
4525 IF J=4 THEN M2=16:GOSUB 6000:H2=HL:HL=4:GOTO 4575
4530 DA=J:DC=NC:H1=HA:HA=J:M2=17:GOSUB 6000:GOTO 4575
4535 IF J=9 THEN CL=9:M2=20:GOSUB 6000:GOTO 4575
4540 IF J<11 THEN CA=J:M2=19:GOSUB 6000:GOTO 4575
4545 IF J=11 THEN CE=CE+1
4550 IF J<16 THEN CK=CK+KK(J-10):GOSUB 6100:GOTO 4575
4555 CO=CO+1:M2=11+CO:GOSUB 6000:CB(J-15)=1
4557 IF FF=1 THEN GOSUB 6250:FF=0
4560 IF J=19 THEN 4565
4562 IF I2=6 THEN CA=C1:M1=C1:M2=19:GOSUB 6000
4564 GOTO 4575
4565 CP=1:IF CA=5 THEN CA=C1:M1=C1:M2=19:GOSUB 6000
4570 IF CL=4 THEN CL=C2:M1=C2:M2=20:GOSUB 6000
4575 CD=J:IF J<16 THEN TU=1
4580 J=ABS(J):JC(J)=JC(J)+1:JA(J)=JA(J)-1
4585 RETURN
5000 K=0:FOR I=16 TO 19
5005 IF JA(I)<>0 THEN K=I
5010 NEXT:RETURN
5050 J=0:IF CA<5 OR (CA=5 AND JA(19)=0)THEN RETURN
5052 IF CA>5 AND CA<10 AND CP=0 THEN RETURN
5055 IF CL=4 AND JA(19)=0 THEN M=4:GOTO 5065
5060 M=2:IF CK=F(1)AND JA(11)<>0 AND CE<2 THEN J=11:RETURN
5065 FOR I=M TO 5
5070 IF CK=F(I)AND JA(10+I)<>0 THEN J=10+I
5075 NEXT:RETURN
5100 J=0:IF HA<5 THEN RETURN
5101 IF HA=5 AND (CP<>0 OR JA(19)<>0)THEN RETURN
5102 IF HA>5 AND HA<10 AND HP=0 THEN RETURN
5105 IF CL=4 AND (CP<>0 OR JA(19)<>0)THEN M=4:GOTO 5115
5110 M=2:IF HK=F(1)AND JC(11)+JA(11)<XB(1)AND HE<2 THEN J=1:RETURN
5115 FOR I=M TO 5
5120 IF HK=F(I)AND JC(10+I)+JA(10+I)<XB(I)THEN J=1
5125 NEXT:RETURN
5150 J=0:FOR I=1 TO 5:AP(I)=0:NEXT
5155 M1=1:M2=5:IF HA<>10 AND ((HA>0 AND H<6)OR HP=0)THEN M1=4:M2=4
5160 FOR I=M1 TO M2
5165 M=I:IF I=5 THEN M=4
5170 IF (I=4 AND HL=4)OR JA(I)=0 OR HB(M)<>0 THEN 5205
5175 IF CB(M)<>0 THEN AP(I)=18:GOTO 5205
5180 IF JA(15+M)<>0 THEN AP(I)=17:GOTO 5205
5185 IF NC>I2 AND MF=0 THEN 5205
5190 IF JC(I+5)+JA(I+5)=XP(I)THEN AP(I)=16:GOTO 5205
5195 IF I=DA AND NC-DC<10 THEN AP(I)=15:GOTO 5205
5200 AP(I)=14-XP(I)+JC(I+5)+JA(I+5)
5205 NEXT
5210 FOR I=1 TO 5:IF I=4 THEN 5230
5215 IF AP(I)=0 THEN 5230
5220 IF J=0 THEN J=I:GOTO 5230
5225 IF AP(I)>AP(J)THEN J=I
5230 NEXT:IF J<>0 THEN RETURN
5235 IF AP(4)<>0 THEN J=4
5240 RETURN
5300 J=0:IF CA<>10 AND ((CA>0 AND CA<6)OR CP=0)THEN RETURN
5305 M=1:IF CL=4 THEN M=4
5310 FOR I=5 TO M STEP -1
5315 IF JA(10+I)<>0 AND (I<>1 OR CE<2)AND (CK+KK(I)<=700)THEN J=10+I
5320 NEXT:RETURN
5350 J=0:IF CA=10 OR ((CA=0 OR CA>5)AND CP<>0)THEN 5365
5355 IF CA>5 AND JA(10)<>0 THEN J=10:RETURN
5360 IF CA<>0 AND CA<6 AND JA(CA+5)<>0 THEN J=CA+5:RETURN
5365 IF CL=4 AND JA(9)<>0 THEN J=9
5370 RETURN
5400 J=0:IF CA<6 OR (CA<10 AND CP=0)THEN RETURN
5405 FOR I=5 TO 1 STEP -1
5410 IF I<4 AND CL=4 THEN 5425
5415 IF JA(10+I)=0 OR (I=1 AND CE>1)THEN 5425
5420 IF CK+KK(I)<=700 AND (CK+KK(I)>=600 OR CK+KK(I)=500)THEN J=10+I
5425 NEXT:IF J=0 THEN RETURN
5430 IF CK+KK(J-10)<>500 THEN 5440
5435 IF CE=2 OR (CE=1 AND J=11)THEN J=0:RETURN
5440 MF=1:RETURN
5450 J=0:FOR I=1 TO 5
5455 M=I:IF I=5 THEN M=4
5460 IF HB(M)<>0 AND JA(I)<>0 THEN J=-I
5465 NEXT:IF J<0 THEN RETURN
5470 FOR I=6 TO 10
5475 M=I-5:IF I=10 THEN M=4
5480 IF JA(I)=0 THEN 5485
5481 IF CB(M)<>0 THEN J=-I:GOTO 5485
5482 IF JA(I)>XA(I-5)-JC(I-5)-JA(I-5)THEN J=-I
5485 NEXT:IF J<0 THEN RETURN
5490 IF JA(11)<>0 AND CE>1 THEN J=-11:RETURN
5495 FOR I=5 TO 1 STEP -1
5500 IF CK+KK(I)>700 AND JA(10+I)<>0 THEN J=-10-I
5505 NEXT:IF J<0 THEN RETURN
5510 IF JA(10)>2 THEN J=-10:RETURN
5512 IF JA(11)+JA(12)+JA(13)<2 AND JA(14)+JA(15)<2 THEN 5535
5515 FOR I=1 TO 5
5517 IF I>3 AND JA(14)+JA(15)<2 THEN 5530
5520 IF JA(10+I)=0 THEN 5530
5525 IF CK+KK(I)<>700 OR JA(10+I)>1 THEN J=-10-I
5530 NEXT:IF J<0 THEN RETURN
5535 FOR I=6 TO 10
5540 M=10+I:IF I=10 THEN M=19
5545 IF JA(M)<>0 AND JA(I)<>0 THEN J=-I
5550 NEXT:IF J<0 THEN RETURN
5555 FOR I=6 TO 10
5560 IF JA(I)=0 THEN 5580
5565 IF J<>0 THEN 5570
5567 M1=XP(I-5)-JA(I)-JC(I)-XA(I-5)+JA(I-5)+JC(I-5):J=-I:GOTO 5580
5570 M2=XP(I-5)-JA(I)-JC(I)-XA(I-5)+JA(I-5)+JC(I-5)
5575 IF M2>M1 THEN M1=M2:J=-I
5580 NEXT:IF J<0 AND M1>0 THEN RETURN
5581 IY=0:FOR IX=1 TO 5:IY=IY+JA(IX):NEXT:IF IY>2 THEN 5585
5582 J=0:FOR I=11 TO 15
5583 IF JA(I)<>0 THEN J=-I
5584 NEXT:IF J<0 THEN RETURN
5585 J=0:FOR I=1 TO 5
5590 IF JA(I)=0 THEN 5605
5595 IF J=0 THEN J=-I:GOTO 5605
5600 IF JA(I)>JA(-J)THEN J=-I
5605 NEXT:IF J<0 THEN RETURN
5610 FOR I=1 TO 7
5615 IF CJ(I)<16 THEN J=-I
5620 NEXT:RETURN
5800 WD=1:GOTO 5804
5802 WD=0
5804 W$="    "&STR$(WN):W$=SEG$(W$,LEN(W$)-WP+1,WP)
5805 WW$="":FOR WI=1 TO LEN(W$):WW$=WW$&RPT$(SEG$(W$,WI,1),2):NEXT
5810 LOCATE (WL,WC):PRINT WW$:IF WD=1 THEN LOCATE (WL+1,WC):PRINT WW$
5815 RETURN
6000 IF M1<>0 THEN 6010
6002 CALL COLOR("0B"&SEG$(EC$,M2,1))
6004 FOR I9=0 TO 3:LOCATE (P(M2,1)+I9,P(M2,2)+1):PRINT "    ":NEXT:RETURN
6010 CALL POKE(50481,P(M2,2)*2,M1)
6020 CALL POKE(50485,P(M2,1))
6030 CALL EXEC(50480)
6040 RETURN
6100 WL=19:WC=26:WN=CK:WP=3:CALL COLOR("0BHL"):GOSUB 5800:CALL COLOR("0BY")
6105 RETURN
6150 WL=19:WC=11:WN=HK:WP=3:CALL COLOR("0BHL"):GOSUB 5800:CALL COLOR("0BM")
6155 RETURN
6200 CALL COLOR("0BG"):LOCATE (21,22):PRINT USING"###";CC;:RETURN
6250 A$="*****   COUP-FOURRE   *****":GOSUB 6280:CALL COLOR("0b"&SEG$(EC$,M2,1))
6260 LOCATE (P(M2,1)+4,P(M2,2)+2):PRINT "cf":RETURN
6280 LOCATE (1,1):CALL COLOR("0BW"):PRINT RPT$(" ",40);
6290 LOCATE (1,20-LEN(A$)/2):FOR I=1 TO LEN(A$):PRINT SEG$(A$,I,1);
6295 GOSUB 20900:NEXT:RETURN
6300 CLS "BCC":CALL COLOR("0BCHL"):LOCATE (3,2)
6305 A$="FFIINN  DDEE  LLAA  PPAARRTTIIEE":PRINT A$:LOCATE (4,2):PRINT A$
6310 IF HT=CT AND CC<>-1 THEN A$="MMAATTCCHH  NNUULL  !!!!!!":GOTO 6340
6320 IF CT>HT OR CC=-1 THEN A$="EEXXLL  110000  GGAAGGNNEE  !!!!!!":GOTO 6340
6330 A$=J2$&"  GGAAGGNNEE  !!!!!!"
6340 LOCATE (13,20-LEN(A$)/2):CALL COLOR("0RCHL"):PRINT A$
6345 LOCATE (14,20-LEN(A$)/2):PRINT A$
6350 I=ABS(CT-HT):IF I=0 AND CC<>-1 THEN 6410
6360 IF CC=-1 THEN A$="PPAARR  AABBAANNDDOONN......":GOTO 6400
6370 IF I<1000 THEN A$="DDEE  PPEEUU......":GOTO 6400
6380 IF I<2000 THEN A$="SSAANNSS  PPRROOBBLLEEMMEE":GOTO 6400
6390 A$="BBRRIILLLLAAMMMMEENNTT  !!!!!!"
6400 LOCATE (16,20-LEN(A$)/2):CALL COLOR("0BCHL"):PRINT A$
6405 LOCATE (17,20-LEN(A$)/2):PRINT A$
6410 CALL COLOR("0RC"):LOCATE (21,1):PRINT "Une autre partie (O/N) ? ";
6420 A$=KEY$:IF A$<>"N"THEN 29
6430 CLS "BCC":CALL COLOR("0BC"):STOP
7000 CA=0:HA=0:CL=0:HL=0:CP=0:HP=0:CK=0:HK=0:CO=0:HO=0
7005 CF=0:HF=0:CE=0:HE=0:CD=0:HD=0:C1=0:H1=0:C2=0:H2=0:NC=0:DA=0:DC=0:MF=0
7010 FOR I=1 TO 19:JC(I)=0:JA(I)=0:NEXT
7015 FOR I=1 TO 4:CB(I)=0:HB(I)=0:NEXT
7020 PR=ABS(PR=0):TU=PR:CC=106
7025 CLS "BGG":CALL COLOR("0BG")
7030 CALL COLOR("0BM"):FOR I=8 TO 14:LOCATE (I,1):PRINT RPT$(" ",20);:NEXT
7031 FOR I=14 TO 21:LOCATE (I,1):PRINT RPT$(" ",16);:NEXT
7032 CALL COLOR("0BY"):FOR I=8 TO 14:LOCATE (I,21):PRINT RPT$(" ",20);:NEXT
7033 FOR I=14 TO 21:LOCATE (I,25):PRINT RPT$(" ",16);:NEXT
7035 CALL COLOR("0HL"):LOCATE (14,2):PRINT J2$:LOCATE (15,2):PRINT J2$
7036 CALL COLOR("0BM"):LOCATE (18,12):PRINT "kms:"
7037 CALL COLOR("0HL"):LOCATE (14,26):PRINT E2$:LOCATE (15,26):PRINT E2$
7038 CALL COLOR("0BY"):LOCATE (18,26):PRINT "kms:"
7042 CALL COLOR("0BG"):LOCATE (15,17):PRINT "defausse"
7044 LOCATE (21,17):PRINT "reste":LOCATE (22,18):PRINT "cartes"
7045 RETURN
7050 CT=0:HT=0:RETURN
7100 KK(1)=200:KK(2)=100:KK(3)=75:KK(4)=50:KK(5)=25
7105 FOR I=1 TO 5:F(I)=700-KK(I):NEXT
7110 XB(1)=4:XB(2)=12:XB(3)=10:XB(4)=10:XB(5)=10
7115 XA(1)=3:XA(2)=3:XA(3)=3:XA(4)=4:XA(5)=5
7120 XP(1)=6:XP(2)=6:XP(3)=6:XP(4)=6:XP(5)=14
7125 PR=INTRND(2)-1:RETURN
7200 LOCATE (7,1):PRINT RPT$(" ",240)
7201 LOCATE (12,1):PRINT "VOTRE NOM : ";:JR$="":J2$=""
7203 EX$="EXL 100":E2$="EEXXLL  110000"
7204 PRINT CHR$(140);
7205 U=INTRND(1):CALL KEY1(I,J):IF J<>1 THEN 7205
7206 CALL SPEECH("L,0D7C91B2BAB602FC")
7210 A$=CHR$(I):IF I<>131 THEN 7225
7215 IF JR$=""THEN GOSUB 20900:GOTO 7205
7217 LOCATE (12,13+LEN(JR$)):PRINT " ";:LOCATE (12,12+LEN(JR$))
7220 JR$=SEG$(JR$,1,LEN(JR$)-1):J2$=SEG$(J2$,1,LEN(J2$)-2):GOTO 7204
7225 IF A$<>CHR$(13)THEN 7240
7230 IF JR$=""THEN GOSUB 20900:GOTO 7205
7235 GOTO 7260
7240 IF A$<"!"OR A$>"~"THEN GOSUB 20900:GOTO 7205
7242 LOCATE (12,13+LEN(JR$))
7245 JR$=JR$&A$:J2$=J2$&A$&A$:PRINT A$;:IF LEN(JR$)=7 THEN 7260
7250 GOTO 7204
7260 CALL HROFF:CALL EXEC(50320):RETURN
10000 CLS "BGG":CALL HRON("B",20,1):CALL POKE(50337,1,1):CALL POKE(50341,1,1)
10005 CALL COLOR("0WB"):LOCATE (19,1):PRINT RPT$(" ",160)
10007 CALL COLOR("1BG"):LOCATE (18,1):PRINT RPT$(CHR$(125),40);
10010 CALL EXEC(50336)
10012 CALL COLOR("1RG")
10015 LOCATE (16,18):PRINT F1$(1)
10020 LOCATE (17,18):PRINT F1$(2)
10022 CALL COLOR("1BG")
10025 LOCATE (18,18):PRINT F1$(3)
10030 CALL COLOR("0RGHL"):A$="1000":FOR I=1 TO 4:LOCATE (1,3*I)
10032 B$=SEG$(A$,I,1):PRINT B$;B$:LOCATE (2,3*I):PRINT B$;B$:NEXT
10035 CALL COLOR("0BGHL"):A$="BORNES":FOR I=1 TO 6:LOCATE (1,23+2*I)
10037 B$=SEG$(A$,I,1):PRINT B$;B$:LOCATE (2,23+2*I):PRINT B$;B$:NEXT
10040 CALL COLOR("0BG"):LOCATE (4,1)
10042 PRINT "(Copyright 1985          FREE GAME BLOT)"
10045 LOCATE (8,32):PRINT "Auteur":LOCATE (9,30):PRINT "J.Y BOUCROT";
10047 CALL COLOR("0RG"):LOCATE (7,1):PRINT "(appuyez sur":LOCATE (8,2)
10048 PRINT " Ctl  C   ":LOCATE (9,2):PRINT "pour jouer)"
10049 ON ERROR 10310:ON WARNING ERROR:ON BREAK ERROR
10050 J=0:RESTORE 19950
10060 READ M,M1,M2,I9,II,B$
10065 IF M=0 THEN 10300
10067 IF J=1 THEN 10300
10070 FOR I=2 TO 7:CALL COLOR("0BG"):LOCATE (I-1,18):PRINT "    ";
10075 CALL POKE(50481,34,M):CALL POKE(50485,I):CALL EXEC(50480):GOSUB 20900:NEXT
10080 LOCATE (12,20-LEN(B$)/2):CALL COLOR("0BR"):PRINT B$
10090 IF M1=0 THEN FOR I=1 TO 3000:NEXT:GOTO 10200
10100 IF M1<>2 THEN 10150
10102 ON M-15 GOTO 10105,10115,10125,10135
10105 CALL COLOR("1bG")
10106 LOCATE (16,18):PRINT F1$(4)
10107 CALL COLOR("1CG")
10108 LOCATE (16,20):PRINT F1$(5)
10109 CALL COLOR("1bG")
10110 LOCATE (17,18):PRINT F1$(6)
10111 CALL COLOR("1CG")
10112 LOCATE (17,20):PRINT F1$(7)
10113 CALL COLOR("1BG")
10114 LOCATE (18,18):PRINT F1$(8):GOTO 10150
10115 CALL COLOR("1RG")
10116 LOCATE (16,18):PRINT F1$(9)
10117 LOCATE (17,18):PRINT F1$(10)
10118 CALL COLOR("1BG")
10119 LOCATE (18,18):PRINT F1$(11)
10120 GOTO 10150
10125 CALL COLOR("1MG")
10126 LOCATE (16,18):PRINT F1$(1)
10127 LOCATE (17,18):PRINT F1$(2)
10128 CALL COLOR("1BG")
10129 LOCATE (18,18):PRINT F1$(12)
10130 GOTO 10150
10135 CALL COLOR("1RG")
10136 LOCATE (16,18):PRINT F1$(13)
10137 LOCATE (17,18):PRINT F1$(14)
10138 CALL COLOR("1BG")
10139 LOCATE (18,18):PRINT F1$(15)
10150 GOSUB 10800
10200 LOCATE (12,1):CALL COLOR("0BG"):PRINT RPT$(" ",40)
10205 FOR I=7 TO 10:LOCATE (I,18):PRINT "    ";:NEXT
10210 GOTO 10060
10300 ON BREAK STOP:ON ERROR STOP
10301 RETURN
10310 J=1
10315 ON BREAK NEXT
10320 RETURN
10800 CALL POKE(50337,M2+1,1):CALL POKE(50341,I9+1,II):CALL EXEC(50336)
10810 RETURN
19950 DATA 15,1,1,8,0,ETAPE 25 kms
19951 DATA 14,1,2,4,0,ETAPE 50 kms
19952 DATA 13,1,3,2,0,ETAPE 75 kms
19953 DATA 12,1,4,1,0,ETAPE 100 kms
19954 DATA 11,1,5,0,1,ETAPE 200 kms
19955 DATA 5,0,0,0,0,FEU ROUGE
19956 DATA 10,1,4,1,0,FEU VERT
19957 DATA 1,0,0,0,0,PANNE D'ESSENCE
19958 DATA 6,0,0,0,0,ESSENCE
19959 DATA 10,1,4,1,0,FEU VERT
19960 DATA 2,0,0,0,0,ACCIDENT
19961 DATA 7,0,0,0,0,REPARATIONS
19962 DATA 10,1,4,1,0,FEU VERT
19963 DATA 3,0,0,0,0,CREVAISON
19964 DATA 8,0,0,0,0,ROUE DE SECOURS
19965 DATA 10,1,4,1,0,FEU VERT
19966 DATA 4,1,2,4,0,VITESSE LIMITEE
19968 DATA 9,1,4,1,0,"FIN DE LIMITE"
19969 DATA 16,2,3,2,0,"CITERNE D'ESSENCE"
19970 DATA 17,2,5,0,1,AS DU VOLANT
19971 DATA 18,2,4,1,0,INCREVABLE
19972 DATA 19,2,4,1,0,VEHICULE PRIORITAIRE
19973 DATA 0,0,0,0,0,A
20510 DATA 3,2,3,7,3,12,3,17,3,22,3,27,3,32
20515 DATA 9,0,9,5,9,10,9,15,9,21,9,26,9,31,9,36
20520 DATA 17,0,17,5,17,18,17,31,17,36
20525 DATA GGGGGGGMMMMYYYYMMGYY
20530 DATA 2,19,32,3,13
20535 DATA "TIRER UNE CARTE","COUP-FOURRE","ABANDON","JOUER","DEFAUSSER"
20540 DATA "Bornes","Bottes","Coups-fourres","Manche gagnee","Pas d'etape 200"
20545 DATA "Capot","Total manche...",".........Report"
20900 CALL POKE(258,111,132)
20905 FOR II=1 TO 100:NEXT
20910 CALL POKE(259,45)
20920 RETURN
30000 RESTORE 20510
30010 A3$=CHR$(3):A4$=CHR$(4):A5$=CHR$(5):A6$=CHR$(6):A7$=CHR$(7):A8$=CHR$(8)
30020 A9$=CHR$(9):AB$=CHR$(22):AC$=CHR$(23):AD$=CHR$(24):AE$=CHR$(25)
30040 FOR I=1 TO 20:READ P(I,1):READ P(I,2):NEXT
30045 READ EC$
30050 FOR I=1 TO 5:READ PC(I):NEXT:FOR I=1 TO 5:READ TC$(I):NEXT
30055 FOR I=1 TO 8:READ TI$(I):NEXT
30060 CALL CHAR(125,"0000000000000000FFFF")
30065 CALL CHAR(126,"00000000000000000000")
30070 RESTORE 31000
30080 I=1
30085 F1$(I)=""
30090 READ J:IF J<0 THEN 30100
30095 F1$(I)=F1$(I)&CHR$(J):GOTO 30090
30100 IF J=-2 THEN 30110
30105 I=I+1:GOTO 30085
30110 CALL POKE(49156,196,128)
30120 RETURN
31000 DATA 126,0,1,126,-1,2,3,4,5,-1,112,113,113,114,-1
31010 DATA 0,1,-1,85,86,-1,3,4,-1,87,88,-1,115,113,116,113,-1
31020 DATA 126,91,92,93,-1,2,94,95,96,-1,117,118,118,119,-1
31030 DATA 120,121,122,123,-1
31040 DATA 104,105,106,107,-1,3,4,108,109,-1,115,113,113,124,-2
32000 CLS "BCC":LOCATE (12,10):CALL COLOR("0RC")
32005 PRINT "ATTENTION CHARGEMENT"
32010 LOCATE (15,10):PRINT "DE FICHIERS BINAIRES"
32015 PRINT:PRINT:CALL COLOR("0BC"):RETURN
