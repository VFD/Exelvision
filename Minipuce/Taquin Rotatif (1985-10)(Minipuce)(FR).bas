10 ! -------------------------------
20 !            TAQUIN ROTATIF
30 ! -------------------------------
40 CLS "RGb": CALL COLOR("0BG")
50 DIM L1$(25)
60 DIM L2$(16)
70 PRINT "Voulez vous lire les regles du jeu (0/N) "
80 P$=KEY$:RANDOMIZE:IF P$=""THEN RANDOMIZE:GOTO 80
90 IF P$="O"THEN GOSUB 1170
100 CLS:CALL COLOR("0BB")
110 FOR X=18 TO 34:LOCATE (2,X):PRINT " ";:NEXT X
120 FOR X=18 TO 34:LOCATE (18,X):PRINT " ";:NEXT X
130 FOR Y=2 TO 18:LOCATE (Y,18):PRINT " ";:NEXT Y
140 FOR Y=2 TO 18:LOCATE (Y,34):PRINT " ";:NEXT Y
150 CALL COLOR("0Rb")
160 P1$=""
170 P2$=""
180 FOR I=1 TO 25
190 READ A$
200 L1$(I)=A$
210 NEXT I
220 GOTO 240
230 DATA A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,1,2,3,4, 5,6,7,8,9
240 L3=1
250 CALL COLOR("0bBHL")
260 LOCATE (9,3)
270 PRINT "TTAAQQUUIINN"
280 LOCATE (10,3)
290 PRINT "TTAAQQUUIINN"
300 FOR I=1 TO 16
310 J=INTRND(16)
320 FOR W=1 TO J:RANDOMIZE:NEXT W
330 L4$=L1$(J)
340 IF L4$="*"THEN GOTO 310
350 L1$(J)="*"
360 L2$(I)=L4$
370 NEXT I
380 L1=0
390 K=l:A$=""
400 FOR I=1 TO 4
410 FOR J=1 TO 4
420 A$=AS&L2$(K)
430 IF J<4 THEN A$=A$&" ":GOTO 500
440 L=(I*4)
450 FOR Z=1 TO 16 STEP 4
460 LOCATE (L,20+(Z-1)):CALL COLOR("0BR"):PRINT SEG$(A$,Z,1);
470 NEXT Z
480 AS=""
490 IF I<4 THEN GOSUB 1110
500 K=K+1
510 NEXT J
520 NEXT I
530 IF L1=0 THEN L1=1:GOTO 550
540 CALL COLOR("0WM"):LOCATE (22,1):PRINT "Nombre de coups joues";L10
550 CALL COLOR("0MW"):LOCATE (20,1):PRINT "Entrez un numero de case"
560 LOCATE (21,1):PRINT "      ou F pour arreter."
570 REP$=KEY$
580 IF REP$=""THEN GOTO 570
590 IF SEG$(REP$,1,1)<>"E"THEN GOTO 630
600 IF P1$<>"E"THEN GOTO 700
610 MES$="Un echange par partie."
620 GOSUB 1000:GOTO 550
630 IF REP$="F"THEN CLS "BCC":END
640 CODE=ASC(REP$)
650 IF CODE<49 OR CODE>57 THEN MES$="Reponse erronnee":GOSUB 1000:GOTO 390
660 L3=VAL(REP$)
670 IF L3>3 AND L3<7 THEN L3=L3+1 : GOTO 880
680 IF L3>6 AND L3<10 THEN L3=L3+2
690 GOTO 880
700 P1$="E"
710 L10=L10+1
720 L4=1
730 IF LEN(REP$)=3 THEN GOTO 760
740 QUE$="Indiquez les lettres svp"
750 GOSUB 1000:REP$="E"&REP$:GOTO 730
760 L5$=SEG$(REP$,2,1)
770 L6$=SEG$(REP$,3,1)
780 FOR L4=1 TO 16
790 IF L2$(L4)=L5$THEN L7=L4
800 IF L2$(L4)=L6STHEN L8=L4
810 NEXT L4
820 IF ABS(L8-L7)<>1 OR L7=4 OR L7=8 OR L7=12 THEN MES$="" ELSE GOTO 850
830 MES$="Echange interdit"
840 P1$="":GOTO 390
850 L2$(L8)=L5$
860 L2$(L7)=L6S
870 GOTO 940
880 L10=L10+1
890 L5$=L2$(L3)
900 L2$(L3)=L2$(L3+4)
910 L2$(L3+4)=L2$(L3+5)
920 L2$(L3+5)=L2$(L3+1)
930 L2$(L3+1)=L5$
940 FOR L4=1 TO 15
950 IF L2$(L4)>L2$(L4+1)THEN GOTO 390
960 NEXT L4
970 LOCATE (1,1)8
980 PRINT "BRAVO,Vous avez gagne en ";L10;"coups"
990 CLS "BCC": END
1000 CO$="0bW": CALL BOX(1,24,20,21,CO$): LOCATE (20,1 )
1010 IF QUE$=""THEN GOTO 1070 ELSE PRINT QUE$;
1020 REP$=KEY$:IF REP$=""THEN GOTO 1020
1030 IF ASC(REP$)=13 THEN GOTO 1050
1040 ZX$=ZX$&REP$:PRINT " ";REP$;:GOTO 1020
1050 REP$=ZX$:ZX$="":QUE$=""
1060 LOCATE (20,25):PAUSE 1:CALL COLOR("0GG"):PRINT "    ":GOTO 1080
1070 PRINT MES$:GOSUB 1090:MES$=""
1080 RETURN
1090 PAUSE 1
1100 RETURN
1110 TT=17+((I-l)*3)
1120 FOR CC=22 TO 30 STEP 4
1130 CALL COLOR("0bY"):LOCATE ((I#4)+2,CC):PRINT LI$(TT):TT=TT+1
1140 NEXT CC
1150 CALL COLOR("0bW")
1160 RETURN
1170 CLS:LOCATE (4,1):PRINT "Le but de ce jeu est de remettre les"
1180 PRINT "lettres dans l'ordre alphabetique a "
1190 PRINT "l'aide de pivotements successifs."
1200 PRINT:PRINT "Lorsque vous demandez le pivotement "
1210 PRINT "d'une case, les quatre lettres la"
1220 PRINT "composant tournent d'une position dans"
1230 PRINT "le sens des aiguilles d'une montre."
1240 PRINT:PRINT "Vous avez la possibilite une fois au"
1250 PRINT "cours de la partie de permuter deux"
1260 PRINT "lettres contigues sur la meme ligne"
1270 PRINT "en entrant la lettre E puis les deux"
1280 PRINT "lettres a echanger."
1290 LOCATE (22,1):PRINT "Appuyez sur une touche pour commencer"
1300 P$=KEY$:IF P$=""THEN RANDOMIZE:P=RND:GOTO 1300
1310 RETURN
1320 SUB BOX(CD,CA,LD,LA,CO$)
1330 CALL COLOR(CO$)
1340 FOR Y=LD TO LA
1350 FOR X=CD TO CA
1360 LOCATE (Y,X):PRINT " "
1370 NEXT X
1380 NEXT Y
1390 SUBEND
