100 !------------------------------------
110 !           COEUR SECRET
120 !------------------------------------
130 CLS "RWb"
140 CALL COLOR("1RW")
150 CALL CHAR(1,"0066FFFFFF7E3C3C1800")
160 CALL CHAR(2,"003C7EFFFFFFFF7E3C00")
170 CALL CHAR(3,"00FEFEFEFEFEFEFEFE00")
180 DIM TAS(7),D(10),A(10)
190 DATA 1RW,1GW,1MW,1CW,1YW,lbW,1BW
200 FOR X=1 TO 7
210 READ TA$(X)
220 NEXT X
230 GOSUB 770
240 GOSUB 1030
250 GOSUB 1180
260 GOSUB 1410:L=7
270 B$=KEY$
280 IF B$="Z"OR B$="z"THEN GOTO 320
290 IF B$="S"OR B$="s"THEN GOTO 1460
300 IF ASC(BS)>48 AND ASC(BS)<57 THEN GOTO 360
310 GOTO 270
320 IF A(0)=0 THEN GOTO 270
330 A(0)=A(0)-1:ID=ID-1
340 CALL COLOR("1WW"):LOCATE (L,9+A(0)):PRINT " ";
350 GOTO 270
360 A(0)=A(0)+1:ID=ID+1
370 RESTORE 1450
380 FOR X=1 TO 7
390 READ CD,IC
400 IF CD=ASC(B$)THEN D(ID)=IC
410 NEXT X
420 FOR X=19 TO 38
430 CALL COLOR("1WW"):LOCATE (L,X):PRINT " ";
440 NEXT X
450 CO$=TA$(D(ID)):CALL COLOR(CO$)
460 LOCATE (L,8+A(0)):PRINT CHRS(1);
470 IF A(0)<N THEN GOTO 270
480 BP=0:BC=0:CA=21
490 FOR X=1 TO N
500 IF A(X)<>D(X)THEN GOTO 530
510 A(X)=A(X)+20:D(X)=10:BP=BP+1
520 CALL COLOR("1BW"):LOCATE (L,CA+BP):PRINT CHR$(3);
530 NEXT X
540 CA=30
550 FOR X=1 TO N
560 X1=1
570 IF D(X)=10 THEN GOTO 610
580 IF D(X)=A(X1)THEN GOTO 630
590 X1=X1+1
600 IF X1<(N+1)THEN GOTO 580
610 NEXT X
620 GOTO 670
630 BC=BC+1
640 A(X1)=A(X1)+20
650 CALL COLOR("1BW"):LOCATE (L,CA+BC):PRINT CHR$(2);
660 GOTO 610
670 FOR X=1 TO N
680 IF A(X)>19 THEN A(X)=A(X)-20
690 NEXT X
700 IF BP=N THEN GOTO 1660
710 IF B$="s"OR B$="S"THEN GOTO 1460
720 ES=ES+1:L=L+1
730 IF L<21 THEN GOTO 750
740 L=7
750 A(0)=0:ID=0
760 GOTO 270
770 REM regle du jeu
780 LOCATE (2,2):PRINT "Voulez vous lire la regle du jeu"
790 LOCATE (3,8):INPUT "Entrez oui ou non ? ";R1$
800 IF R1$="non"OR R1$="NDN"THEN RETURN
810 IF R1$="oui"OR R1$="OUI"THEN GOTO 830
820 GOTO 790
830 CLS
840 PRINT TAB(13)"Regie du jeu "
850 PRINT TAB(13)"************ "
860 PRINT "Vous me donnez le nombre de caracteres";
870 PRINT TAB(5)"de la combinaison cachee "
880 PRINT ""
890 PRINT "Je choisis la couleur des caracteres"
900 PRINT "de la combinaison.A vous de decouvrir";
910 PRINT "la bonne place de chaque couleur."
920 PRINT "":PRINT "A chaque proposition:"
930 PRINT TAB(8)"- un rond indique que la"
940 PRINT TAB(10)"couleur se trouve dans la"
950 PRINT TAB(10)"combinaison secrete."
960 PRINT TAB(8)"- Un carre indique une couleur"
970 PRINT TAB(10)"situee a la bonne place dans"
980 PRINT TAB(10)"la combinaison secrete."
990 PRINT "":PRINT "BONNE CHANCE...":PRINT ""
1000 PRINT "Appuyez sur une touche pour demarrer"
1010 R2$=KEY$:RANDOMIZE
1020 CLS:RETURN
1030 REM nombre de chiffres et combinaisons
1040 CLS:LOCATE (3,2)
1050 PRINT "combien de positions pour la"
1060 LOCATE (4,6):PRINT "combinaison a deviner."
1070 LOCATE (6,2)
1080 INPUT "Entrez un chiffre de 2 a 9 ? ";N$
1090 IF NOT NUMERIC(N$)THEN GOTO 1060
1100 N=VAL(N$)
1110 IF N<2 OR N>9 THEN GOTO 1060
1120 BP=0
1130 FOR X=1 TO N
1140 RANDOMIZE
1150 A(X)=INTRND(7)
1160 NEXT X
1170 RETURN
1180 REM prepa ecran
1190 CLS
1200 LOCATE (2,2)
1210 DP=0
1220 FOR C=1 TO 7
1230 CO$=TA$(C)
1240 CALL COLOR("1BW")
1250 LOCATE (2,3+DP):PRINT C;
1260 LOCATE (2,2+DP)
1270 CALL COLOR(CO$)
1280 PRINT CHR$(1);
1290 CALL COLOR("1BW")
1300 PRINT "=";
1310 DP=DP+5
1320 NEXT C
1330 LOCATE (4,8)
1340 PRINT "S=SOLUTION     Z=GOMME"
1350 LOCATE (6,2)
1360 PRINT "Votre proposition  ";
1370 PRINT "places   ";
1380 PRINT "presents"
1390 ES=1
1400 RETURN
1410 REM init reponse
1420 A(0)=0:L=7
1430 ID=0
1440 RETURN
1450 DATA 49,1,50,2,51,3,52,4,53,5,54,6,55,7
1460 REM abandon
1470 FOR I=1 TO 4
1480 FOR J=1 TO 39
1490 LOCATE (I,J):PRINT " ";
1500 NEXT J
1510 NEXT I
1520 CALL COLOR("1BW")
1530 LI=0:LOCATE (2,10):PRINT "SOLUTION : "
1540 CL=24
1550 FOR Z=1 TO N
1560 CO$=TA$(A(Z))
1570 CALL COLOR(CO$):LOCATE (2+LI,CL)
1580 PRINT CHR$(1);:CL=CL+1
1590 NEXT Z
1600 CALL COLOR("1BW")
1610 LOCATE (4+LI,3)
1620 INPUT "AUTRE PARTIE (O/N) ? ";R1$
1630 IF R1$="n"OR R1$="N"THEN GOTO 1740
1640 IF R1$="o"OR R1$="O"THEN GOTO 240
1650 GOTO 1620
1660 PAUSE 1:CLS
1670 LOCATE (2,2)
1680 PRINT "Bravo en";
1690 PRINT ES;
1700 PRINT "coups c'est bien."
1710 LOCATE (4,2)
1720 PRINT "Combinaison secrete :"
1730 LI=2:GOTO 1540
1740 PAUSE 2:CLS "BCC"
1750 END
