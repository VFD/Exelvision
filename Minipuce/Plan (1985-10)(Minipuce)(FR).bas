10 ! ---------------------------------
20 !          PLAN
30 ! ---------------------------------
40 CALL COLOR("0RY")
50 CLS "RYM"
60 LOCATE (2,2)
70 PRINT "VOULEZ VOUS LE MODE D'EMPLOI (O/N) "
80 A$=KEY$
90 IF A$=""THEN GOTO 80
100 IF A$="O"THEN GOSUB 840
110 CLS
120 CALL HRON("W",2,18)
130 CALL COLOR("0RY")
140 LOCATE (1,5)
150 PRINT "CALCUL SURFACE D'UN TERRAIN"
160 CD=0:LD=179:CA=0:LA=179:VH=0
170 DIM PIEC1(50,6)
180 FOR I=1 TO 50
190 IF I=1 THEN GOTO 390
200 CALL PLOT("b",CA,LA)
210 CLS
220 LOCATE (21,2)
230 INPUT "LONGUEUR ";LG
240 IF LG=0 THEN GOTO 680
250 ANO=0
260 IF VH<>0 THEN GOTO 300
270 INPUT "HAUT OU BAS (H/B) ";HB$:VH=1:CA=CD
280 IF HB$="B"THEN GOSUB 490 ELSE GOSUB 540
290 GOTO 320
300 INPUT "DROITE OU GAUCHE (D/G) ";DG*:VH=0:LA=LD
310 IF DG$="D"THEN GOSUB 590 ELSE GOSUB 640
320 IF ANO=0 THEN GOTO 380
330 IF VH-0 THEN VH=1 ELSE VH=0
340 CLS
350 LOCATE (21,2)
360 PRINT "ERREUR, REDONNEZ"
370 GOTO 230
380 CALL LINE("b",CD,LD,CA,LA)
390 PIEC1(I,1)=CD
400 PIEC1(I,2)=LD
410 PIEC1(I,3)=CA
420 PIEC1(I,4)=LA
430 PIEC1(I,5)=X
440 PIEC1(I,6)=Y
450 CD=CA:LD=LA
460 NEXT I
470 GOTO 700
480 ! DEPLACEMENT BAS
490 IF Y-LG<0 THEN ANO=1:GOTO 520
500 Y=Y-LG
510 LA=LA+LG
520 RETURN
530 ! DEPLACEMENT HAUT
540 IF Y+LG>179 THEN ANO=1:GOTO 620
550 Y=Y+LG
560 LA=LA-LG
570 RETURN
580 ! DEPLACEMENT DROITE
590 IF X+LG>319 THEN ANO=1:GOTO 620
600 X=X+LG
610 CA-CA+LG
620 RETURN
630 ! DEPLACEMENT GAUCHE
640 IF Xâ€”LG<0 THEN ANO=1:GOTO 670
650 X=X-LG
660 CA=CA-LG
670 RETURN
680 IF PIEC1(I-1,5)=0 AND PIEC1(I-1,6)=0 THEN GOTO 700
690 CALL LINE("b",CD,LD,0,179)
700 S=0
710 FOR K=1 TO 1-1
720 IF K-1=0 THEN L2=I-1 ELSE L2=K-1
730 IF K+1>I-1 THEN Ll=1 ELSE L1=K+1
740 S=S+(PIEC1(L1,6)-PIEC1(L2,6))*PIEC1(K,5)
750 NEXT K
760 S=S/2
770 CALL COLOR("0RY")
780 LOCATE (21,2)
790 PRINT "   SURFACE   =  ":ABS(S)
800 PAUSE
810 CALL HRDFF
820 CLS "BCC"
830 STOP
840 CLS "RYM"
850 PRINT "CALCUL DE LA SURFACE"
860 PRINT "D'UNE PIECE OU D'UN TERRAIN"
870 PRINT "CE PROGRAMME ACCEPTE LE CALCUL POUR LES"
880 PRINT "ESPACES DONT LES ANGLES SONT EGAUX A"
890 PRINT "90 DEGRES."
900 PRINT "VOUS DEVREZ INDIQUER ALTERNATIVEMENT"
910 PRINT "LA TAILLE DES BORDURES VERTICALES ET"
920 PRINT "HORIZONTALES; LA 1ERE COTE EST VERTICALE"
930 PRINT "ET COMMENCE DANS LE COIN GAUCHE EN BAS"
940 PRINT "DE L'ECRAN"
950 PRINT "POUR TERMINER LE TRACE ENTREZ 0"
960 PRINT "A LA DEMANDE DE LONGUEUR ET ALORS s"
970 PRINT " - OU VOUS AVEZ REJOINT LE POINT DE"
980 PRINT "   DEPART ET LA SURFACE EST CALCULEE"
990 PRINT " - DANS LE CAS CONTRAIRE LA DERNIERE"
1000 PRINT "   DROITE TRACEE REJOINT LE BAS GAUCHE"
1010 PRINT "   DE L'ECRAN AVANT LE CALCUL"
1020 PRINT "NOTA : LA RENCONTRE DES DROITES"
1030 PRINT "DONNE UN RESULTAT ALEATOIRE ...."
1040 PRINT " ":PRINT "APPUYER SUR UNE TOUCHE POUR COMMENCER"
1050 NC$=KEY$
1060 IF NC$=""THEN GOTO 1050
1070 RETURN
