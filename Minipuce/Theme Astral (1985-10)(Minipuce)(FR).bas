100 !-----------------------------------
110 !          THEME ASTRAL
120 !-----------------------------------
130 ON ERROR 2040
140 CLS "YMb"
150 DIM PSI$(13),SIG$(13),DEP$(95),HET1$(24),HET2$(12),HSI$(31),AS$(2,14)
160 GOSUB 940
170 GOSUB 1040
180 CALL COLOR("0bM")
190 GOSUB 990
200 CLS
210 LOCATE (10,1):PRINT "LA DATE DE NAISSANCE DOIT"
220 PRINT:PRINT "ETRE ENTRE 1912 ET 1976"
230 PRINT:PRINT:PRINT "IL FAUT ETRE NE(E) EN FRANCE"
240 PRINT:PRINT "METROPOLITAINE"
250 GOSUB 990
260 CLS
270 LOCATE (4,10):PRINT "ENTREZ :"
280 LOCATE (8,1):PRINT "VOTRE DATE DE NAISSANCE ET L'HEURE"
290 LOCATE (9,13):PRINT "JJMMAA  HHMM"
300 LOCATE (14,1):PRINT "LE CODE DU DEPARTEMENT DE NAISSANCE"
310 LOCATE (15,13):PRINT "NN"
320 LOCATE (10,13):ACCEPT VALIDATE(DIGIT)SIZE(6),DNAI$
330 LOCATE (10,21):ACCEPT VALIDATE(DIGIT)SIZE(4),HNAI$
340 LOCATE (16,13):ACCEPT VALIDATE(DIGIT)SIZE(2),DP
350 JNAIS=VAL(SEG$(DNAI$,3,2)&SEG$(DNAI$,1,2))
360 FOR I=1 TO 13
370 PS1=VAL(SEG$(PSI$(I),1,4))
380 PS2=VAL(SEG$(PSI$(I),5,4))
390 IF PS1<=JNAIS AND PS2>=JNAIS THEN S=I:I=13
400 NEXT I
410 CLS:LOCATE (14,1):PRINT "SIGNE = ";SIG$(S)
420 ANAIS=VAL(SEG$(DNAI$,5,2))
430 IF ANAIS>76 THEN 1900
440 IF ANAIS<12 THEN 1960
450 HEU=VAL(SEG$(HNAI$,1,2))
460 MINU=VAL(SEG$(HNAI$,3,2))+VAL(SEG$(DEP$(DP),1,2))-VAL(SEG$(DEP$(DP),3,2))
470 IF MINU>=60 THEN HEU=HEU+1:MINU=MINU-60:GOTO 470
480 AAN=VAL(SEG$(DNAI$,5,2))
490 IF AAN<16 OR AAN>45 THEN 700
500 MJHNAIS=VAL(SEG$(DNAI$,3,2)&SEG$(DNAI$,1,2)&SEG$(HNAI$,1,2))
510 AMJHNAIS=VAL(SEG$(DNAI$,5,2)&STR$(MJHNAIS))
520 IF AAN>39 THEN 590
530 AAN=AAN-15
540 HET1=VAL(SEG$(HET1$(AAN),1,4))
550 IF HET1>MJHNAIS OR VAL(SEG$(HET1$(AAN),7,6))<MJHNAIS THEN 700
560 HEU=HEU-1
570 IF HEU<0 THEN HEU=HEU+24
580 GOTO 700
590 HET2=VAL(SEG$(HET2$(1),1,8))
600 HET2B=VAL(SEG$(HET2$(12),1,8))
610 IF AMJHNAIS<HET2 OR AMJHNAIS>HET2B THEN 700
620 FOR I=1 TO 11
630 HET3=VAL(SEG$(HET2$(I),1,8))
640 HET3B=VAL(SEG$(HET2$(I+1),1,8))
650 IF AMJHNAIS<HET3 OR AMJHNAIS>HET3B THEN 690
660 HEU=HEU-VAL(SEG$(HET2$(I),9,1))
670 IF HEU<0 THEN HEU=HEU+24
680 I=11
690 NEXT I
700 !
710 JJN=VAL(SEG$(DNAI$,1,2))
720 MMN=VAL(SEG$(DNAI$,3,2))
730 HMSI$=SEG$(HSI$(JJN),((MMN-1)*4)+1,4)
740 MINU=MINU+VAL(SEG$(HMSI$,3,1))
750 IF MINU>60 THEN THEN HEU=HEU+1:MINU=MINU-60
760 HEU=HEU+VAL(SEG$(HMSI$,1,2))
770 IF HEU>24 THEN HEU=HEU-24
780 INS=VAL(SEG$(DEP$(DP),5,1))
790 FOR I=1 TO 14
800 AS1=VAL(SEG$(AS$(INS,I),1,2))
810 AS2=VAL(SEG$(AS$(INS,I),5,2))
820 AS3=VAL(SEG$(AS$(INS,I),3,2))
830 AS4=VAL(SEG$(AS$(INS,I),7,2))
840 IF HEU<AS1 OR HEU>AS2 THEN 880
850 IF HEU=AS1 AND MINU<AS3 THEN 880
860 IF HEU=AS2 AND MINU>AS4 THEN 880
870 SA=I:I=14
880 NEXT I
890 IF SA>=5 THEN SA=SA-1
900 LOCATE (18,1):PRINT "ASCENDANT : ";SIG$(SA)
910 GOSUB 990
920 IF RC$="S" THEN 260
930 END
940 ! AFFICHAGE ****************
950 CALL COLOR("0YLHF")
960 LOCATE (12,9):PRINT "TTHHEEMMEE  AASSTTRRAALL"
970 LOCATE (13,9):PRINT "TTHHEEMMEE  AASSTTRRAALL"
980 RETURN
990 ! ATTENTE INTERVENTION ******
1000 LOCATE (21,4)
1010 PRINT "Frappez la touche 'S' pour continuer"
1020 RC$=KEY$
1030 RETURN
1040 ! CHARGEMENT DES TABLES *****
1050 ! TABLE DES SIGNES **********
1060 DATA 03210420,04210520,05210621,06220722,023822,08230922
1070 DATA 09231022,10231121,11221220,12211231,01010119,01200218,02190320
1080 DATA BELIER,TAUREAU,GEMAUX,CANCER,LION,VIERGE
1090 DATA BALANCE,SCORPION,SAGITAIRE,CAPRICORNE,CAPRICORNE,VERSEAU,POISSONS
1100 FOR I=1 TO 13
1110 READ PSI$(I)
1120 NEXT I
1130 FOR I=1 TO 13
1140 READ SIG$(I)
1150 NEXT I
1160 !
1170 DATA 20002,14001,13002,24002,24002,29002,18002,19001,00002,00001,16002
1180 DATA 10002,21002,00001,09002,00002,00042,09001,07002,33002,20001,00111
1190 DATA 07002,00002,24001,19002,00001,00001,00161,17002,00002,00002,00002
1200 DATA 15002,00071,00002,00001,22002,22002,00002,00001,17002,15002,00061
1210 DATA 07001,07002,00002,14002,00001,00001,17001,20001,00001,25001,20001
1220 DATA 00111,25001,12001,13001,08001,00001,17001,12002,00002,00002,10002
1230 DATA 30001,29001,19002,24001,18002,00001,23002,24002,09001,00001,10001
1240 DATA 08001,00002,10001,08002,00002,26002,19002,00052,00002,00002,25001
1250 DATA 14001,27001,09001,09001,09001,09001,08001
1260 FOR I=1 TO 95
1270 READ DEP$(I)
1280 NEXT I
1290 !
1300 DATA 061423100124,032423100724,030923100624,030123100524,021423102524
1310 DATA 031423102524,032523100724,052623100624,032923100424,040423100324
1320 DATA 041723100224,040923100124,041423100624,042023100524,041223100424
1330 DATA 041823100324,040223100124,032523100724,040724100724,033023100524
1340 DATA 041823100324,040323100224,032623100124,041523111824
1350 FOR I=1 TO 24
1360 READ HET1$(I)
1370 NEXT I
1380 !
1390 DATA 400224231,400615112,411006241,420309242,421102031,430329072,431004031
1400 DATA 440403022,441008011,450402022,450916031,451231240
1410 FOR I=1 TO 12
1420 READ HET2$(I)
1430 NEXT I
1440 !
1450 DATA 063408381033123614331636183420372239003702390438
1460 DATA 064008421037124014371643183820412243004102430442
1470 DATA 064408461040124414411643184220452247004502470446
1480 DATA 064808501044124814451647184620492251004902510450
1490 DATA 065208541048125214491651185020532255005302550454
1500 DATA 065608581052125514531655185420572259005702590457
1510 DATA 070009021056125814571659185821002303010103030501
1520 DATA 070409061100130215011703190221042307010504070505
1530 DATA 070809101104130615051707190621082311010903110509
1540 DATA 071209141108131015091711191021122314011303150513
1550 DATA 071509181112131415131715191421162318011703190517
1560 DATA 071909221116131815171719191821202322012103230521
1570 DATA 072309261120132215211723192221242326012503270525
1580 DATA 072709301124132615241727192621282330012903310529
1590 DATA 073109331128133015281731193021322334013203350533
1600 DATA 073509371132133415321734193421362338013603390537
1610 DATA 073909411136133815361738193821402342014003430541
1620 DATA 074309451140134215401742194221442346014403470545
1630 DATA 074709491144134615441746194621482350014803500549
1640 DATA 075109531148135015481750194921522354015203540553
1650 DATA 075509571152135415521754195321562358015603580557
1660 DATA 075910011155135815561758195722000002020004020601
1670 DATA 080310051158140216001802200222040006020404060605
1680 DATA 080710091202140616041806200622080010020604100609
1690 DATA 081110131206141016081810201022120014021204140613
1700 DATA 081510171210141416121814201422160018021604180617
1710 DATA 081910211214141816161818201822200023022004220621
1720 DATA 082310251218142216201822202222240026022404260624
1730 DATA 082610291222142616241826202622270030022804300628
1740 DATA 0830    1226142916281830203022310034023204340632
1750 DATA 0834    1230    1632    20332235    0236    0636
1760 FOR I=1 TO 31
1770 READ HSI$(I)
1780 NEXT I
1790 !
1800 DATA 18001858,15582012,20122204,22042400,00000030,00300316,03160600
1810 DATA 06000845,08451130,11301359,13591549,13591549,15491702,17021800
1820 DATA 18001905,19052027,20272218,22182400,00000044,00440322,03220600
1830 DATA 06000839,08391116,11161342,13421534,13421534,15341656,16561800
1840 FOR I=1 TO 2
1850 FOR J=1 TO 14
1860 READ AS$(I,J)
1870 NEXT J
1880 NEXT I
1890 RETURN
1900 CLS:LOCATE (12,7)
1910 PRINT "Desole  vous etes trop jeune"
1920 LOCATE (13,7):PRINT "Nous n'avons pas d'ascendant"
1930 LOCATE (14,14):PRINT "a votre taille"
1940 GOSUB 990
1950 GOTO 260
1960 CLS:LOCATE (10,1)
1970 PRINT "Desole mais le programme est trop recent"
1980 LOCATE (12,5):PRINT "Toutes les informations qui vous"
1990 LOCATE (13,5):PRINT "concernent  ne sont pas encore"
2000 LOCATE (14,15):PRINT "enregistrees"
2010 LOCATE (17,9):PRINT "IL N'Y A PAS L'ASCENDANT"
2020 GOSUB 990
2030 GOTO 260
2040 CLS:LOCATE (10,6)
2050 PRINT "Il s'est produit une erreur"
2060 GOSUB 990
2070 ON ERROR 2040
2080 GOTO 260
