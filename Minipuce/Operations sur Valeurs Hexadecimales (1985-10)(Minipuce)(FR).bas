10 ! ---------------------------------------
20 ! OPERATIONS SUR VALEURS HEXADECIMALES
30 ! ---------------------------------------
40 CALL COLOR("0RY")
50 CLS "RYS"
60 LOCATE (2,3)
70 PRINT "OPERATIONS SUR VALEURS HEXADECIMALES"
80 LOCATE (10,1)
90 PRINT "-1- EXERCICES SUR VALEURS"
100 LOCATE (13,1)
110 PRINT "-2- CALCUL SUR VOS DONNEES"
120 LOCATE (20,1)
130 PRINT "ENTREZ VOTRE CHOIX AU CLAVIER"
140 R$=KEY$
150 IF (R$<>"1"AND R$<>"2")OR R$=""THEN GOTO 140
160 CLS "RWb"
170 A=VAL(R$)
180 DIM T$(32)
190 FOR 1 = 1 TO 16'
200 READ T*(I)
210 NEXT I
220 RESTORE 260
230 FOR 1=17 TO 32
240 READ T$(I)
250 NEXT I
260 DATA 0,1,2,3,4,5,6,7,8,9,A,B,C,D,E,F
270 IF A=1 THEN GOTO 1290
280 PAUSE 2:CLS
290 LOCATE (21,2):PRINT "1ER FACTEUR  "
300 FOR X=0 TO LEN(L2$):LOCATE (21,15+X): PRINT " ";:NEXT X:L2$="":C=0
310 A$=KEY$
320 IF A$=""THEN GOTO 310
330 IF ASC(A$)=13 OR ASC(A$)=32 THEN GOTO 370
340 LOCATE (21,14+C):PRINT A$:C=C+1
350 L2$=L2$8<A$
360 GOTO 310
370 F=LEN(L2$)
380 IF L2$=""THEN GOTO 290
390 FOR 1=1 TO F
400 A$=SEG$(L2$,I,1)
410 IF A$<"0"OR A$>"F"THEN GOTO 290
420 IF A$>"9"AND A$<"A"THEN GOTO 290
430 NEXT I
440 LOCATE (21,2):PRINT "  OPERATEUR  "
450 FDR X=0 TO LEN(L2$):LOCATE (21,15+X):PRINT " ";:NEXT X
460 L3$=KEY$
470 IF L3$=""THEN GOTO 460
480 IF L3$<>"+"AND L3$<>"-"THEN GOTO 440
490 LOCATE (21,16): PRINT L3$
500 PAUSE
510 LOCATE (21,16)sPRINT " "
520 LOCATE (21,2)sPRINT "2EME FACTEUR "
530 FOR X=0 TO LEN(L4$) : LOCATE (21,15+X):PRINT " ";:NEXT X:L4$="":C=0
540 A$=KEY$
550 IF A$=""THEN GOTO 540
560 IF ASC(A$)=13 OR ASC(A$)=32 THEN GOTO 600
570 LOCATE (21,15+C): PRINT A$:C=C+1
580 L4$=L4$&A$
590 GOTO 540
600 F=LEN(L4$)
610 IF L4$=""THEN GOTO 520
620 FOR I=1 TO F
630 A$=SEG$(L4$,I,1)
640 IF A$<"0"OR A$>"F"THEN GOTO 520
650 IF A$>"9"AND A$<"A"THEN GOTO 520
660 NEXT I
670 IF LEN(L2$)>=LEN(L4$)THEN GOTO 730
680 IF L3$<>"+"THEN GOTO 710
690 L7$=L2$:L2$=L4$:L4$=L7$
700 GOTO 730
710 LOCATE (18,2)sPRINT "LONGUEUR DU 1ER NBRE < CELLE DU SECOND"
720 PRINT "POUR SOUSTRACTION ... REDONNER": GOTO 280
730 GOSUB 770:GOSUB 870:GOTO 1030
740 !
750 !   PADDINGS AVEC ZEROS A GAUCHE
760 !
770 FOR I=LEN(L2$)TO 6
780 L2$="0"&L2$
790 NEXT I
800 FOR I=LEN(L4$)TO 6
810 L4$="0"&L4$
320 NEXT I
830 RETURN
840 !
850 !  CALCUL
860 !
870 TTOT$=""
880 RET=0
890 FOR CALC=7 TO 1 STEP -1
900 L7$=SEG$(L2$,CALC,1)
910 L8$=SEG$(L4$,CALC,1)
920 FOR I=1 TO 16
930 IF T$(I)=L7$THEN L9=I
940 NEXT I
950 L9=L9+RET
960 FOR I=1 TO 16
970 IF T$(I)=L8*THEN L10=I
980 NEXT I
990 IF L3$="+"THEN GOSUB 1190 ELSE GOSUB 1260
1000 TTOT$=RES$&TTOT$
1010 NEXT CALC
1020 RETURN
1030 CLS
1040 PRINT "           ";L2$
1050 PRINT "        ";L3$;"  ";L4$
1060 PRINT "           ";"-------"
1070 PRINT "           ";TTOT$
1080 X=0
1090 LOCATE (10,10)
1100 PRINT "ENCORE ? (O/N) "
1110 A$=KEY$
1120 IF A$=""THEN GOTO 1110
1130 IF A$<>"O"THEN CLS:STOP
1140 CLS
1150 IF X=0 THEN GOTO 280 ELSE GOTO 1310
1160 !
1170 !  ADDITION
1180 !
1190 RES$=T$(L10+L9-1)
1200 !  RETENUE  ????
1210 IF L10+L9-1>16 THEN RET=1 ELSE RET=0
1220 RETURN
1230 !
1240 !  SOUSTRACTION
1250 !
1260 IF L9-L10<0 THEN RET=-1:L9=L9+16 ELSE RET=0
1270 RES$=T$(L9-L10+1)
1280 RETURN
1290 !
1300 ! EXERCICES i
1310 !
1320 I=INT(4*RND+0)
1330 LIM=I
1340 ON I GOSUB 1360,1370,1380:GOTO 1400
1350 I=100:GOTO 1400
1360 I=1000:RETURN
1370 I=10000:RETURN
1380 I=1.E+05:RETURN
1390 I=100
1400 L3$="+"
1410 ESS=1
1420 GOSUB 1740:L2$=HX$
1430 GOSUB 1740:L4$=HX$
1440 GOSUB 770
1450 LOCATE (19,1)
1460 PRINT "           ";L2$
1470 PRINT "        ";L3$;"  ";L4$
1480 PRINT "          " ; "---------------"
1490 GOSUB 870
1500 LOCATE (22,1):PRINT "RESULTAT : " ;
1510 TST$="":C=0:PAUSE 2:FOR X=0 TO 6:LOCATE (22,12+X):PRINT " ";:NEXT X
1520 LOCATE (22,20)-.PRINT " " : A$=KEY$
1530 IF A$=""THEN GOTO 1520
1540 IF ASC(A$)=13 DR ASC(A$)=32 THEN GOTO 1580
1550 LOCATE (22,12+C):PRINT A$;:C=C+1
1560 TST$=TST$&A$:F=LEN(TST$)
1570 GOTO 1520
1580 FOR I=1 TO F
1590 A$=SEG$(TST$,1,1)
1600 IF A$<"0"OR A$>"F"THEN GOTO 1500
1610 IF A$>"9"AND A$<"A"THEN GOTO 1500
1620 NEXT I
1630 FOR I=LEN(TST$)TO 6
1640 TST$="0"8<TST$
1650 NEXT I
1660 IF TST$=TTOT$THEN LOCATE (22,20):PRINT "PARFAIT":GOTO 1710
1670 IF ESS<3 THEN LOCATE (22,20):PRINT "FAUX":ESS=ESS+1:GOTO 1500
1680 LOCATE (22,20)
1690 PRINT TTOT$
1700 GOTO 1710
1710 A=RND
1720 X=1
1730 GOTO 1090
1740 HX$=""
1750 FOR X=1 TO LIM
1760 RANDOMIZE
1770 RESTORE 260
1780 LEC=14*RND+0
1790 FOR Y=0 TO LEC
1800 READ HEX$
1810 NEXT V
1820 READ HEX$
1830 HX$=HX$&HEX$
1840 NEXT X
1850 RETURN
