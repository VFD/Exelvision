10 ! ----------------------------
20 !          Calculette
30 ! ----------------------------
40 DIM T(100),T$(100)
50 DIM LI$(13)
60 DATA +,-,*,/,@,A,B,C,D,E,F,G
70 FOR A=1 TO 13
80 READ LI$(A)
90 NEXT A
100 A$="######.##"
110 CT=0
120 I=1
130 CLS "RYM"
140 LOCATE (2,8)
150 PRINT "CALCULATRICE"
160 LOCATE (4,2):PRINT "OPERATEURS : +,-,/,*,@,^"
170 LOCATE (5,2):PRINT "ABREVIATIONS :"
180 LOCATE (6,5):PRINT "A : MEMORISATION"
190 LOCATE (7,5):PRINT "B : REMISE A ZERO GENERALE"
200 LOCATE (8,5):PRINT "C : REMISE A ZERO DU TOTAL EN COURS"
210 LOCATE (9,5):PRINT "D : REMISE A ZERO DU TOTAL MEMORISE"
220 LOCATE (10,5):PRINT "E : RAPPEL MEMOIRE EN 1ER FACTEUR"
230 LOCATE (11,5):PRINT "F : RAPPEL MEMOIRE EN 2EME FACTEUR"
240 LOCATE (12,5):PRINT "G : FIN"
250 LOCATE (13,5):PRINT "@ : MODULO ; ^ : PUISSANCE"
260 GOSUB 1320
270 ZZ(5)=13
280 !
290 !    SAISIE ABREVIATION
300 !
310 OP$=""
320 LOCATE (17,11)
330 OPER$=KEY$sIF OPER$=""THEN GOTO 330
340 IF OPER$<"A"OR OPER$>"G"THEN GOTO 450
350 PRINT OPER$
360 FOR IOP=7 TO 13
370 IF ASC(OPER$)<>ASC(LI$(IOP)) AND IOP<ZZ(5) THEN NEXT IOP
380 IF ASC(OPER$)<>ASC(LI*(IOP))THEN GOTO 320
390 GOSUB 850:IF OP$=""THEN GOTO 420
400 IF OP$="A"THEN GOTO 590
410 IF OP$="B"THEN GOTO 450
420 GOSUB 1320
430 GOTO 290
440 !
450 !    SAISIE 1ER NOMBRE
460 !
470 IF OP$="A"THEN GOTO 590
480 ZZ(1)=18
490 ZZ(2)=11
500 ZZ(3)=5
510 ZZ(4)=1
520 GOSUB 1470:IF NUMCHI=0 THEN GOTO 480
530 T(I)=NUMCHI
540 CT=CT+1
550 IF CT>90 THEN LOCATE (22,2):PRINT "ATTENTION, TABLE BIENTOT PLEINE ..."
560 I=I+1
570 A=NUMCHI
580 !
590 !    SAISIE OPERATEUR
600 !
610 LOCATE (19,11)
620 OPER$=KEY$
630 IF OPER$=""THEN GOTO 620
640 FOR IOP=1 TO 6
650 IF ASC(OPER$)<>ASC(LI$(IOP))THEN NEXT IOP
660 IF ASC(OPER$)<>ASC(LI$(IOP))THEN GOTO 610
670 LOCATE (19,11):PRINT OPER$
680 !
690 !    SAISIE 2EME NOMBRE
700 !
710 IF OP$="B"THEN OP$="":GOTO 830
720 ZZ(1)=20
730 ZZ(2)=11
740 ZZ(3)=5
750 ZZ(4)=1
760 GOSUB 1470
770 IF NUMCHI=0 THEN GOTO 720
780 T(I)=NUMCHI
790 CT=CT+1
800 IF CT>90 THEN LOCATE (22,2):PRINT "ATTENTION, TABLE BIENTOT PLEINE ..."
810 I=I+1
820 B=NUMCHI
830 GOSUB 850
840 GOSUB 1320:GOTO 290
850 ON IOP GOTO 860,890,920,950,980,1010,1150,107 0,1090,1120,1180,1250,1040
860 ! ADDITION
870 TT=TT+(A+B)
880 RETURN
890 ! SOUSTRACTION
900 TT=TT+(A-B)
910 RETURN
920 ! MULTIPLICATION
930 TT=TT+(A*B)
940 RETURN
950 ! DIVISION
960 TT=TT+(A/B)
970 RETURN
980 ! MODULO
990 TT=TT+(A-(INT(A/B)*B))
1000 RETURN
1010 ! PUISSANCE
1020 TT=TT+(A^B)
1030 RETURN
1040 ! FIN
1050 CLS "BCC"
1060 STOP
1070 ! REMISE A ZERO GENERALE
1080 TT2=0:TT=0:CT=0:1=1
1090 ! REMISE A ZERO TOTAL EN COURS
1100 TT=0
1110 RETURN
1120 ! REMISE A ZERO MEMOIRE
1130 TT2=0
1140 RETURN
1150 ! MEMORISATION TOTAL EN COURS
1160 TT2=TT2+TT
1170 RETURN
1180 ! RAPPEL MEMOIRE  * E *
1190 FOR X=ZZ(2)T0 ZZ(2)+7
1200 LOCATE (ZZ(1),X):PRINT " "
1210 NEXT X
1220 A=TT2:OP$="A"
1230 LOCATE ( 18,11):PRINT A
1240 RETURN
1250 ! RAPPEL MEMOIRE * F *
1260 FOR X=ZZ(2)TO ZZ(2)+7
1270 LOCATE (ZZ(1),X):PRINT " "
1280 NEXT X
1290 B=TT2:OP$="B"
1300 LOCATE (20,11)-.PRINT B
1310 RETURN
1320 C1=18:C2=40
1330 L1=16:L2=19:X$="0bW"
1340 CALL BOI(Cl,C2,L1,L2,X$)
1350 LOCATE (16,19): PRINT "S/TOTAL :"
1360 LOCATE (19,19): PRINT "MEMOIRE :"
1370 CALL COLOR("0RY")
1380 LOCATE (17,2):PRINT "ABREV.  :"
1390 LOCATE (18,2):PRINT "NOMBRE  :"
1400 LOCATE (19,2):PRINT "OPERAT. :"
1410 LOCATE (20,2):PRINT "NOMBRE  :"
1420 CALL COLOR("0BW")
1430 LOCATE (16,28): PRINT USING A$,TT
1440 LOCATE (19,28): PRINT USING A$,TT2
1450 CALL COLOR("0RY")
1460 RETURN
1470 FOR X=ZZ(2)TO ZZ(2)+6
1480 LOCATE (ZZ(1),X):PRINT " "
1490 NEXT X
1500 LOCATE (ZZ(1),ZZ(2))
1510 ZZC=ZZ(2)
1520 ZZS=ZZ(2)+ZZ(3)-1
1530 NUMCHI=0:CHIF$="0"
1540 OPER$=KEY$
1550 IF OPER$=""THEN GOTO 1540
1560 IF ASC(OPER$)=13 THEN RETURN
1570 IF ASC(OPER$)<48 OR ASC(OPER$)>57 THEN LOCATE (ZZ(1),ZZC):GOTO 1540
1580 CHIF$=CHIF$&OPER$:NUMCHI=VAL(CHIF$)
1590 LOCATE (ZZ(1),ZZC)
1600 PRINT OPER$
1610 ZZC=ZZC+1
1620 IF ZZC>ZZS THEN RETURN
1630 LOCATE (ZZ(1),ZZC)
1640 GOTO 1540
1650 SUB BOI(C1,C2,L1,L2,X$)
1660 CALL COLOR(X$)
1670 FOR X1=L1 TO L2:FOR Y1=C1 TO C2
1680 LOCATE (X1,Y1): PRINT " "
1690 NEXT Y1:NEXT X1
1700 SUBEND
