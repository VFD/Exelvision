
10 !----------------------------------
20 !             BOMBARDIER
30 !----------------------------------
40 CLS "Byb":CALL COLOR("1BY")
50 AV1$="181E9FFFFFFF9F1E1800"
60 AV2$="000000F0FEF000000000"
70 CALL CHAR(1,AV1$)
80 CALL CHAR(2,AV2$)
90 AV$=CHR$(1)&CHR$(2)
100 PO1$="000000003C3C3C343C3C"
110 CALL CHAR(3,PO1$)
120 ET1$="00006060000606606000"
130 ET2$="000C0C006060000C0C00"
140 CALL CHAR(4,ET1$)
150 CALL CHAR(5,ET2$)
160 SO1$="3C7EFFFFFFFFFFFFFFFF"
170 SO2$="18183C3C7E7EFFFFFFFF"
180 SO3$="181818181818183C7EFF"
190 CALL CHAR(6,SO1$)
200 CALL CHAR(7,SO2$)
210 CALL CHAR(8,SO3$)
220 BO1$="00242418183C3C180000"
230 CALL CHAR(9,BO1$)
240 EX1$="3C181881DBDB8118183C"
250 CALL CHAR(10,EX1$)
260 CH1$="007C3838FEFE7C7C3838"
270 CALL CHAR(11,CH1$)
280 CH2$="38383810100000000000"
290 CALL CHAR(12,CH2$)
300 CALL COLOR("0BY")
310 SIF1$="04D88BD408EBCF8AB8EDE4ECBF2B46338BBFFFAE3B2516F5F9BB6C5A45A4E7EFB"
320 SIF2$="26B1939CA4C3EB2A8BEC8F6DF35E5DA08587F5B017B752260FF2904ECDF8980FDA"
330 SIF3$="7010008B0171911D69F1571DBC9D97F5578C66167FFF5D774A2CEAF377D9B48A48C"
340 SIF4$="FDF65D732729499DC64517D91EDBF6BCAB511B0FEB602F6EA44C0FE5308D8BF130"
350 SIF5$="1FB4F0300FC"
360 SI1$=SIF1$&SIF2$
370 SI2$=SIF3$&SIF4$&SIF5$
380 LAS1$="0D9816C301EDE72CB8B4CBECBD7D88AA6F33A2DD41AAF6BDB46407AFDAE3CEAA1E"
390 LAS2$="AA6AB7BE4A7CB86ADC6D37C9E04BE87411B508C04302FE"
400 LA$=LAS1$&LAS2$
410 EXP1$="0BA02163031B18008D1E139840073A108100F0901E81080480478F084420020570"
420 EXP2$="CEBD02110840704E118840043CE0010F78C00316B080052C20010948800214A000"
430 EXP3$="05284081FF"
440 EXP$=EXP1$&EXP2$&EXP3$
450 CALL COLOR("0BY")
460 DIM BA(2,2),TA(40),DP(40),PO(40),BU(21,40)
470 A=60
480 B=200
490 C=10
500 D=100
510 E=40
520 F=200
530 SC=0:FU=650
540 BL$="     "
550 DATA 6,8,14,15,1,0,2,18,19,4,12,9,10,11,17,3,5,16,13,7
560 DATA 26,28,34,35,21,20,22,38,39,24,32,29,30,31,37,23,25,36,33,27
570 RESTORE 550
580 RANDOMIZE:ID=INTRND(8)
590 FOR X=1 TO 40
600 READ PO(X):NEXT X
770 GOSUB 1520
780 GOSUB 1770
790 FOR X=1 TO 21
800 FOR Y=1 TO 40
810 BU(X,Y)=0
820 NEXT Y
830 NEXT X
840 GOSUB 1860
850 GOSUB 2020
860 L=2:C=1:TIR=0
870 GOSUB 2230
880 C=C+1
890 CALL SPEECH("R,"&LA$)
900 IF C>40 THEN C=1:L=L+1:IF L>19 THEN GOTO 1220
910 IF BU(L,C)<>1 THEN GOTO 1120
920 ! **** SCRATCHS BUILDING ****
930 CALL COLOR("1Rb")
940 CALL SPEECH("L,"&EXP$)
950 LOCATE (L,C):PRINT CHR$(10)
960 CALL COLOR("1bb")
970 CALL SPEECH("A,"&LA$)
980 CALL SPEECH("A,"&EXP$)
990 IF C<3 THEN LOCATE (L-1,39):PRINT "  ":GOTO 1020
1000 LOCATE (L,C-1):PRINT " "
1010 CALL COLOR("1Wb")
1020 LOCATE (3,3):PRINT "Vous avez percute un batiment"
1030 GOSUB 1770:GOTO 1220
1040 ! **** EFFACER LES BALLES ***
1050 X=1
1060 IF TIR=0 THEN RETURN
1070 CALL COLOR("1bb")
1080 LOCATE (BA(X,1),BA(X,2)):PRINT " "
1090 X=X+1:TIR=TIR-1
1100 GOTO 1060
1110 ! **** ANIM. AVION ****
1120 CALL COLOR("1Yb")
1130 LOCATE (L,C):PRINT AV$
1140 IF C=1 THEN LOCATE (L-1,39):PRINT "  ":GOTO 1160
1150 LOCATE (L,C-1):PRINT " "
1160 FU=FU-1
1170 GOSUB 2340
1180 GOSUB 1770
1190 IF FU>0 THEN GOTO 870
1200 GOTO 1280
1210 ! *** PLUS D'AVIONS ***
1220 CALL COLOR("1Wb")
1230 LOCATE (5,3):PRINT "LA PARTIE EST TERMINEE,NOTEZ VOTRE"
1240 PRINT "SCORE ET A LA PROCHAINE FOIS."
1250 A$=KEY$
1260 PAUSE 3:CLS "BCC":END
1270 ! **** PLUS DE FUEL ****
1280 CALL COLOR("1Wb")
1290 LOCATE (2,4):PRINT "PLUS DE FUEL"
1300 GOSUB 1770
1310 CALL COLOR("1Yb")
1320 LOCATE (L,C):PRINT "  "
1330 IF L-1<3 THEN GOTO 1350
1340 LOCATE (L-1,C):PRINT " "
1350 GOSUB 2340:L=L+1
1360 CALL SPEECH("R,"&LA$)
1370 IF BU(L,C)<>1 AND L<19 THEN GOTO 1460
1380 CALL SPEECH("A,"&LA$)
1390 LOCATE (L-1,C):PRINT " "
1400 CALL SPEECH("L,"&EXP$)
1410 GOSUB 1040
1420 LOCATE (L,C):PRINT CHR$(10)
1430 PAUSE 1
1440 CALL SPEECH("A,"&EXP$)
1450 GOTO 1220
1460 CALL COLOR("1Yb")
1470 LOCATE (L-1,C):PRINT CHR$(11)
1480 LOCATE (L,C):PRINT CHR$(12)
1490 PAUSE .1
1500 GOTO 1340
1510 ! *** DESSIN ECRAN ***
1520 CLS "Bbb"
1530 CALL COLOR("1YR")
1540 LOCATE (1,1)
1550 FOR A=0 TO 39
1560 PRINT " ";
1570 NEXT A
1580 CALL COLOR("1YG")
1590 FOR B=21 TO 22
1600 LOCATE (B,1)
1610 FOR A=0 TO 39
1620 PRINT " ";
1630 NEXT A
1640 NEXT B
1650 CALL COLOR("1Yb")
1660 LOCATE (2,1)
1670 PRINT AV$
1680 CALL COLOR("0WR")
1690 LOCATE (1,2)
1700 PRINT "SCORE:"
1710 LOCATE (1,14)
1720 PRINT "FUEL:"
1730 LOCATE (1,25)
1740 PRINT "CIBLES:"
1750 RETURN
1760 ! *** ECRIT. SCORE ***
1770 CALL COLOR("0WR")
1780 LOCATE (1,8):PRINT BL$
1790 LOCATE (1,8):PRINT SC
1800 LOCATE (1,19):PRINT BL$
1810 LOCATE (1,19):PRINT FU
1820 LOCATE (1,32):PRINT BL$
1830 LOCATE (1,32):PRINT CIBLE
1840 RETURN
1850 ! *** NBRE ETAGE ET DE BUILDINGS *
1860 CIBLE=0
1870 HMAX=5+NBCOU
1880 IF HMAX>15 THEN HMAX=15
1890 NA=6+NBCOU
1900 IF NA>40 THEN NA=40
1910 IF NBCOU>20 THEN NBCOU=20
1920 FOR I=1 TO NA
1930 TA(I)=INT((HMAX-NBCOU)*RND+(4+NBCOU))
1940 N=ID+I
1950 IF N>40 THEN N=1
1960 DP(I)=PO(N)
1970 CIBLE=CIBLE+TA(I)
1980 NEXT I
1990 GOSUB 1770
2000 RETURN
2010 ! *** M.E.P DES BUILDINGS ***
2020 FOR B=1 TO NA
2030 CALL COLOR("1MB")
2040 LOCATE (19,1+DP(B))
2050 PRINT CHR$(3)
2060 BU(19,1+DP(B))=1
2070 L=18:C=DP(B)+1
2080 IF A=0 THEN A=1 ELSE A=0
2090 FOR X=2 TO TA(B)-1
2100 IF A=0 THEN CALL COLOR("1MB"):GOTO 2120
2110 CALL COLOR("1BM")
2120 AIG=INTRND(2)
2130 LOCATE (L,C)
2140 IF AIG=1 THEN PRINT CHR$(4) ELSE PRINT CHR$(5)
2150 BU(L,C)=1:L=L-1:NEXT X
2160 BU(L,C)=1
2170 CALL COLOR("1Bb")
2180 LOCATE (L,C):AIG=INTRND(3)
2190 IF AIG=3 THEN PRINT CHR$(6):GOTO 2210
2200 IF AIG=2 THEN PRINT CHR$(7) ELSE PRINT CHR$(8)
2210 NEXT B:RETURN
2220 ! *** TIR ? ***
2230 IF TIR=2 THEN RETURN
2240 CALL KEY1(TI,AS)
2250 IF TI=255 THEN RETURN
2260 X=1:IF TIR=1 THEN X=2
2270 CALL SPEECH("L,"&SI1$)
2280 CALL SPEECH("L,"&SI2$)
2290 BA(X,1)=L:BA(X,2)=C:TIR=TIR+1
2300 CALL SPEECH("A,"&SI1$)
2310 CALL SPEECH("A,"&SI2$)
2320 RETURN
2330 ! *** ANIM BALLES ***
2340 IF TIR=0 THEN GOTO 2730
2350 CALL COLOR("1Rb")
2360 X=1
2370 LOCATE (BA(X,1),BA(X,2)):PRINT " "
2380 BA(X,1)=BA(X,1)+1
2390 IF BA(X,1)>19 AND BU(BA(X,1),BA(X,2))<>1 THEN GOTO 2520
2400 IF BU(BA(X,1),BA(X,2))<>1 THEN GOTO 2560
2410 CALL SPEECH("L,"&EXP$)
2420 LOCATE (BA(X,1),BA(X,2)):PRINT CHR$(10)
2430 BU(BA(X,1),BA(X,2))=0
2440 CALL SPEECH("A,"&EXP$)
2450 IF BA(X,1)<>19 THEN GOTO 2470
2460 FU=FU+50
2470 CIBLE=CIBLE-1:SC=SC+1
2480 IF CIBLE>0 THEN GOTO 2510
2490 LOCATE (BA(2,1),BA(2,2)):CALL COLOR("1bb"):PRINT " "
2500 GOTO 2600
2510 LOCATE (BA(X,1),BA(X,2)):PRINT " "
2520 TIR=TIR-1
2530 IF TIR=0 OR X=2 THEN RETURN
2540 BA(1,1)=BA(2,1):BA(1,2)=BA(2,2)
2550 GOTO 2360
2560 LOCATE (BA(X,1),BA(X,2)):PRINT CHR$(9)
2570 IF TIR=1 THEN RETURN
2580 IF X=2 THEN RETURN
2590 X=2:GOTO 2370
2600 NBCOU=NBCOU+1
2610 FU=650
2620 CALL COLOR("1Yb")
2630 LOCATE (2,1):PRINT AV$
2640 CALL COLOR("1bb")
2650 LOCATE (L,C):PRINT "  "
2660 LOCATE (L-1,C):PRINT "  "
2670 LOCATE (BA(X,1),BA(X,2)):PRINT " "
2680 CALL COLOR("1YG")
2690 FOR A=0 TO 39
2700 PRINT " ";
2710 NEXT A
2720 GOTO 780
2730 RETURN
